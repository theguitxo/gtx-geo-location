import{r as t,h as i,g as n}from"./p-195d7dbb.js";var r=function(){function t(){this.disposed=!1}return t.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function s(t,i){return t>i?1:t<i?-1:0}function h(t,i,n){var r=t.length;if(t[0]<=i)return 0;if(i<=t[r-1])return r-1;var s=void 0;if(n>0){for(s=1;s<r;++s)if(t[s]<i)return s-1}else if(n<0){for(s=1;s<r;++s)if(t[s]<=i)return s}else for(s=1;s<r;++s){if(t[s]==i)return s;if(t[s]<i)return t[s-1]-i<i-t[s]?s-1:s}return r-1}function o(t,i,n){for(;i<n;){var r=t[i];t[i]=t[n],t[n]=r,++i,--n}}function u(t,i){for(var n=Array.isArray(i)?i:[i],r=n.length,s=0;s<r;s++)t[t.length]=n[s]}function e(t,i){var n=t.length;if(n!==i.length)return!1;for(var r=0;r<n;r++)if(t[r]!==i[r])return!1;return!0}function f(){return!0}function a(){return!1}function c(){}function v(){return function(){throw new Error("Unimplemented abstract method.")}()}var l=0;function d(t){return t.ol_uid||(t.ol_uid=String(++l))}var p,_=(p=function(t,i){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}p(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),m=function(t){function i(i){var n=this,r="Assertion failed. See https://openlayers.org/en/v"+"6.4.3".split("-")[0]+"/doc/errors/#"+i+" for details.";return(n=t.call(this,r)||this).code=i,n.name="AssertionError",n.message=r,n}return _(i,t),i}(Error);function w(t,i){if(!t)throw new m(i)}function M(t,i){var n=i[0],r=i[1];return i[0]=t[0]*n+t[2]*r+t[4],i[1]=t[1]*n+t[3]*r+t[5],i}function g(t,i,n,r,s,h,o,u){var e=Math.sin(h),f=Math.cos(h);return t[0]=r*f,t[1]=s*e,t[2]=-r*e,t[3]=s*f,t[4]=o*r*f-u*r*e+i,t[5]=o*s*e+u*s*f+n,t}function b(t,i){var n,r=(n=i)[0]*n[3]-n[1]*n[2];w(0!==r,32);var s=i[0],h=i[1],o=i[2],u=i[3],e=i[4],f=i[5];return t[0]=u/r,t[1]=-h/r,t[2]=-o/r,t[3]=s/r,t[4]=(o*f-u*e)/r,t[5]=-(s*f-h*e)/r,t}function y(t){return"matrix("+t.join(", ")+")"}new Array(6);function O(t){for(var i=[1/0,1/0,-1/0,-1/0],n=0,r=t.length;n<r;++n)F(i,t[n]);return i}function j(t,i,n){return n?(n[0]=t[0]-i,n[1]=t[1]-i,n[2]=t[2]+i,n[3]=t[3]+i,n):[t[0]-i,t[1]-i,t[2]+i,t[3]+i]}function x(t,i){return i?(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i):t.slice()}function A(t,i,n){var r,s;return(r=i<t[0]?t[0]-i:t[2]<i?i-t[2]:0)*r+(s=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*s}function k(t,i){return N(t,i[0],i[1])}function S(t,i){return t[0]<=i[0]&&i[2]<=t[2]&&t[1]<=i[1]&&i[3]<=t[3]}function N(t,i,n){return t[0]<=i&&i<=t[2]&&t[1]<=n&&n<=t[3]}function E(t,i){var n=i[0],r=i[1],s=0;return n<t[0]?s|=16:n>t[2]&&(s|=4),r<t[1]?s|=8:r>t[3]&&(s|=2),0===s&&(s=1),s}function P(t,i,n,r,s){return s?(s[0]=t,s[1]=i,s[2]=n,s[3]=r,s):[t,i,n,r]}function T(t){return P(1/0,1/0,-1/0,-1/0,t)}function I(t,i){return t[0]==i[0]&&t[2]==i[2]&&t[1]==i[1]&&t[3]==i[3]}function F(t,i){i[0]<t[0]&&(t[0]=i[0]),i[0]>t[2]&&(t[2]=i[0]),i[1]<t[1]&&(t[1]=i[1]),i[1]>t[3]&&(t[3]=i[1])}function C(t,i,n,r,s){for(;n<r;n+=s)z(t,i[n],i[n+1]);return t}function z(t,i,n){t[0]=Math.min(t[0],i),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],i),t[3]=Math.max(t[3],n)}function L(t,i){var n;return(n=i(D(t)))||(n=i(X(t)))||(n=i(V(t)))?n:(n=i(q(t)))||!1}function R(t){var i=0;return B(t)||(i=J(t)*Z(t)),i}function D(t){return[t[0],t[1]]}function X(t){return[t[2],t[1]]}function G(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Y(t,i){var n;return"bottom-left"===i?n=D(t):"bottom-right"===i?n=X(t):"top-left"===i?n=q(t):"top-right"===i?n=V(t):w(!1,13),n}function W(t,i,n,r,s){var h=i*r[0]/2,o=i*r[1]/2,u=Math.cos(n),e=Math.sin(n),f=h*u,a=h*e,c=o*u,v=o*e,l=t[0],d=t[1],p=l-f+v,_=l-f-v,m=l+f-v,w=l+f+v,M=d-a-c,g=d-a+c,b=d+a+c,y=d+a-c;return P(Math.min(p,_,m,w),Math.min(M,g,b,y),Math.max(p,_,m,w),Math.max(M,g,b,y),s)}function Z(t){return t[3]-t[1]}function U(t,i,n){var r=n||[1/0,1/0,-1/0,-1/0];return $(t,i)?(r[0]=t[0]>i[0]?t[0]:i[0],r[1]=t[1]>i[1]?t[1]:i[1],r[2]=t[2]<i[2]?t[2]:i[2],r[3]=t[3]<i[3]?t[3]:i[3]):T(r),r}function q(t){return[t[0],t[3]]}function V(t){return[t[2],t[3]]}function J(t){return t[2]-t[0]}function $(t,i){return t[0]<=i[2]&&t[2]>=i[0]&&t[1]<=i[3]&&t[3]>=i[1]}function B(t){return t[2]<t[0]||t[3]<t[1]}function H(t,i,n){return Math.min(Math.max(t,i),n)}var K="cosh"in Math?Math.cosh:function(t){var i=Math.exp(t);return(i+1/i)/2},Q="log2"in Math?Math.log2:function(t){return Math.log(t)*Math.LOG2E};function tt(t,i,n,r,s,h){var o=s-n,u=h-r;if(0!==o||0!==u){var e=((t-n)*o+(i-r)*u)/(o*o+u*u);e>1?(n=s,r=h):e>0&&(n+=o*e,r+=u*e)}return it(t,i,n,r)}function it(t,i,n,r){var s=n-t,h=r-i;return s*s+h*h}function nt(t){return t*Math.PI/180}function rt(t,i){var n=t%i;return n*i<0?n+i:n}function st(t,i,n){return t+n*(i-t)}var ht=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,ot=/^([a-z]*)$|^hsla?\(.*\)$/i,ut=function(){var t={},i=0;return function(n){var r;if(t.hasOwnProperty(n))r=t[n];else{if(i>=1024){var s=0;for(var h in t)0==(3&s++)&&(delete t[h],--i)}r=function(t){var i,n,r,s,h;if(ot.exec(t)&&(t=function(t){var i=document.createElement("div");if(i.style.color=t,""!==i.style.color){document.body.appendChild(i);var n=getComputedStyle(i).color;return document.body.removeChild(i),n}return""}(t)),ht.exec(t)){var o,u=t.length-1;o=u<=4?1:2;var e=4===u||8===u;i=parseInt(t.substr(1+0*o,o),16),n=parseInt(t.substr(1+1*o,o),16),r=parseInt(t.substr(1+2*o,o),16),s=e?parseInt(t.substr(1+3*o,o),16):255,1==o&&(i=(i<<4)+i,n=(n<<4)+n,r=(r<<4)+r,e&&(s=(s<<4)+s)),h=[i,n,r,s/255]}else 0==t.indexOf("rgba(")?ft(h=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((h=t.slice(4,-1).split(",").map(Number)).push(1),ft(h)):w(!1,14);return h}(n),t[n]=r,++i}return r}}();function et(t){return Array.isArray(t)?t:ut(t)}function ft(t){return t[0]=H(t[0]+.5|0,0,255),t[1]=H(t[1]+.5|0,0,255),t[2]=H(t[2]+.5|0,0,255),t[3]=H(t[3],0,1),t}function at(t){var i=t[0];i!=(0|i)&&(i=i+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+i+","+n+","+r+","+(void 0===t[3]?1:t[3])+")"}function ct(t,i,n){return i+":"+t+":"+(n?function(t){return"string"==typeof t?t:at(t)}(n):"null")}var vt=new(function(){function t(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var i in this.cache_)0!=(3&t++)||this.cache_[i].hasListener()||(delete this.cache_[i],--this.cacheSize_)}},t.prototype.get=function(t,i,n){var r=ct(t,i,n);return r in this.cache_?this.cache_[r]:null},t.prototype.set=function(t,i,n,r){var s=ct(t,i,n);this.cache_[s]=r,++this.cacheSize_},t.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},t}()),lt=function(){function t(t){this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}();var dt="function"==typeof Object.assign?Object.assign:function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1,r=arguments.length;n<r;++n){var s=arguments[n];if(null!=s)for(var h in s)s.hasOwnProperty(h)&&(i[h]=s[h])}return i};function pt(t){for(var i in t)delete t[i]}var _t="function"==typeof Object.values?Object.values:function(t){var i=[];for(var n in t)i.push(t[n]);return i};function mt(t){var i;for(i in t)return!1;return!i}var wt=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=function(t){function i(i){var n=t.call(this)||this;return n.eventTarget_=i,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return wt(i,t),i.prototype.addEventListener=function(t,i){if(t&&i){var n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);-1===r.indexOf(i)&&r.push(i)}},i.prototype.dispatchEvent=function(t){var i="string"==typeof t?new lt(t):t,n=i.type;i.target||(i.target=this.eventTarget_||this);var r,s=this.listeners_&&this.listeners_[n];if(s){var h=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});n in h||(h[n]=0,o[n]=0),++h[n];for(var u=0,e=s.length;u<e;++u)if(!1===(r="handleEvent"in s[u]?s[u].handleEvent(i):s[u].call(this,i))||i.propagationStopped){r=!1;break}if(--h[n],0===h[n]){var f=o[n];for(delete o[n];f--;)this.removeEventListener(n,c);delete h[n]}return r}},i.prototype.disposeInternal=function(){this.listeners_&&pt(this.listeners_)},i.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},i.prototype.hasListener=function(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)},i.prototype.removeEventListener=function(t,i){var n=this.listeners_&&this.listeners_[t];if(n){var r=n.indexOf(i);-1!==r&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=c,++this.pendingRemovals_[t]):(n.splice(r,1),0===n.length&&delete this.listeners_[t]))}},i}(r);function gt(t,i,n,r,s){if(r&&r!==t&&(n=n.bind(r)),s){var h=n;n=function(){t.removeEventListener(i,n),h.apply(this,arguments)}}var o={target:t,type:i,listener:n};return t.addEventListener(i,n),o}function bt(t,i,n,r){return gt(t,i,n,r,!0)}function yt(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),pt(t))}var Ot=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jt=function(t){function i(){var i=t.call(this)||this;return i.revision_=0,i}return Ot(i,t),i.prototype.changed=function(){++this.revision_,this.dispatchEvent("change")},i.prototype.getRevision=function(){return this.revision_},i.prototype.on=function(t,i){if(Array.isArray(t)){for(var n=t.length,r=new Array(n),s=0;s<n;++s)r[s]=gt(this,t[s],i);return r}return gt(this,t,i)},i.prototype.once=function(t,i){var n;if(Array.isArray(t)){var r=t.length;n=new Array(r);for(var s=0;s<r;++s)n[s]=bt(this,t[s],i)}else n=bt(this,t,i);return i.ol_key=n,n},i.prototype.un=function(t,i){var n=i.ol_key;if(n)!function(t){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)yt(t[i]);else yt(t)}(n);else if(Array.isArray(t))for(var r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],i);else this.removeEventListener(t,i)},i}(Mt),xt=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=function(t){function i(i,n,r){var s=t.call(this,i)||this;return s.key=n,s.oldValue=r,s}return xt(i,t),i}(lt),kt=function(t){function i(i){var n=t.call(this)||this;return d(n),n.values_=null,void 0!==i&&n.setProperties(i),n}return xt(i,t),i.prototype.get=function(t){var i;return this.values_&&this.values_.hasOwnProperty(t)&&(i=this.values_[t]),i},i.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},i.prototype.getProperties=function(){return this.values_&&dt({},this.values_)||{}},i.prototype.hasProperties=function(){return!!this.values_},i.prototype.notify=function(t,i){var n;n=Nt(t),this.dispatchEvent(new At(n,t,i)),this.dispatchEvent(new At(n="propertychange",t,i))},i.prototype.set=function(t,i,n){var r=this.values_||(this.values_={});if(n)r[t]=i;else{var s=r[t];r[t]=i,s!==i&&this.notify(t,s)}},i.prototype.setProperties=function(t,i){for(var n in t)this.set(n,t[n],i)},i.prototype.unset=function(t,i){if(this.values_&&t in this.values_){var n=this.values_[t];delete this.values_[t],mt(this.values_)&&(this.values_=null),i||this.notify(t,n)}},i}(jt),St={};function Nt(t){return St.hasOwnProperty(t)?St[t]:St[t]="change:"+t}var Et=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pt=function(t){function i(i){var n=t.call(this)||this,r=dt({},i);return r.opacity=void 0!==i.opacity?i.opacity:1,w("number"==typeof r.opacity,64),r.visible=void 0===i.visible||i.visible,r.zIndex=i.zIndex,r.maxResolution=void 0!==i.maxResolution?i.maxResolution:1/0,r.minResolution=void 0!==i.minResolution?i.minResolution:0,r.minZoom=void 0!==i.minZoom?i.minZoom:-1/0,r.maxZoom=void 0!==i.maxZoom?i.maxZoom:1/0,n.className_=void 0!==r.className?i.className:"ol-layer",delete r.className,n.setProperties(r),n.state_=null,n}return Et(i,t),i.prototype.getClassName=function(){return this.className_},i.prototype.getLayerState=function(t){var i=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return i.opacity=H(Math.round(100*this.getOpacity())/100,0,1),i.sourceState=this.getSourceState(),i.visible=this.getVisible(),i.extent=this.getExtent(),i.zIndex=void 0!==n?n:!1===i.managed?1/0:0,i.maxResolution=this.getMaxResolution(),i.minResolution=Math.max(this.getMinResolution(),0),i.minZoom=this.getMinZoom(),i.maxZoom=this.getMaxZoom(),this.state_=i,i},i.prototype.getLayersArray=function(){return v()},i.prototype.getLayerStatesArray=function(){return v()},i.prototype.getExtent=function(){return this.get("extent")},i.prototype.getMaxResolution=function(){return this.get("maxResolution")},i.prototype.getMinResolution=function(){return this.get("minResolution")},i.prototype.getMinZoom=function(){return this.get("minZoom")},i.prototype.getMaxZoom=function(){return this.get("maxZoom")},i.prototype.getOpacity=function(){return this.get("opacity")},i.prototype.getSourceState=function(){return v()},i.prototype.getVisible=function(){return this.get("visible")},i.prototype.getZIndex=function(){return this.get("zIndex")},i.prototype.setExtent=function(t){this.set("extent",t)},i.prototype.setMaxResolution=function(t){this.set("maxResolution",t)},i.prototype.setMinResolution=function(t){this.set("minResolution",t)},i.prototype.setMaxZoom=function(t){this.set("maxZoom",t)},i.prototype.setMinZoom=function(t){this.set("minZoom",t)},i.prototype.setOpacity=function(t){w("number"==typeof t,64),this.set("opacity",t)},i.prototype.setVisible=function(t){this.set("visible",t)},i.prototype.setZIndex=function(t){this.set("zIndex",t)},i.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},i}(kt);var Tt=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),It=function(t){function i(i){var n=this,r=dt({},i);return delete r.source,(n=t.call(this,r)||this).mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,i.render&&(n.render=i.render),i.map&&n.setMap(i.map),n.addEventListener(Nt("source"),n.handleSourcePropertyChange_),n.setSource(i.source?i.source:null),n}return Tt(i,t),i.prototype.getLayersArray=function(t){var i=t||[];return i.push(this),i},i.prototype.getLayerStatesArray=function(t){var i=t||[];return i.push(this.getLayerState()),i},i.prototype.getSource=function(){return this.get("source")||null},i.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():"undefined"},i.prototype.handleSourceChange_=function(){this.changed()},i.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(yt(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=gt(t,"change",this.handleSourceChange_,this)),this.changed()},i.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},i.prototype.render=function(t,i){var n=this.getRenderer();if(n.prepareFrame(t))return n.renderFrame(t,i)},i.prototype.setMap=function(t){this.mapPrecomposeKey_&&(yt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(yt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=gt(t,"precompose",(function(t){var i=t.frameState.layerStatesArray,n=this.getLayerState(!1);w(!i.some((function(t){return t.layer===n.layer})),67),i.push(n)}),this),this.mapRenderKey_=gt(this,"change",t.render,t),this.changed())},i.prototype.setSource=function(t){this.set("source",t)},i.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},i.prototype.hasRenderer=function(){return!!this.renderer_},i.prototype.createRenderer=function(){return null},i.prototype.disposeInternal=function(){this.setSource(null),t.prototype.disposeInternal.call(this)},i}(Pt);function Ft(t,i){if(!t.visible)return!1;var n=i.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;var r=i.zoom;return r>t.minZoom&&r<=t.maxZoom}var Ct=function(){function t(){}return t.prototype.drawCustom=function(){},t.prototype.drawGeometry=function(){},t.prototype.setStyle=function(){},t.prototype.drawCircle=function(){},t.prototype.drawFeature=function(){},t.prototype.drawGeometryCollection=function(){},t.prototype.drawLineString=function(){},t.prototype.drawMultiLineString=function(){},t.prototype.drawMultiPoint=function(){},t.prototype.drawMultiPolygon=function(){},t.prototype.drawPoint=function(){},t.prototype.drawPolygon=function(){},t.prototype.drawText=function(){},t.prototype.setFillStrokeStyle=function(){},t.prototype.setImageStyle=function(){},t.prototype.setTextStyle=function(){},t}();function zt(t){return Array.isArray(t)?at(t):t}var Lt="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Rt=-1!==Lt.indexOf("firefox"),Dt=(-1!==Lt.indexOf("safari")&&Lt.indexOf("chrom"),-1!==Lt.indexOf("webkit")&&-1==Lt.indexOf("edge")),Xt=-1!==Lt.indexOf("macintosh"),Gt="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Yt="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Wt="undefined"!=typeof Image&&Image.prototype.decode,Zt=function(){var t=!1;try{var i=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,i),window.removeEventListener("_",null,i)}catch(n){}return t}();function Ut(t,i,n){var r=n&&n.length?n.shift():Yt?new OffscreenCanvas(t||300,i||300):document.createElement("canvas");return t&&(r.width=t),i&&(r.height=i),r.getContext("2d")}function qt(t,i){var n=i.parentNode;n&&n.replaceChild(t,i)}function Vt(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var Jt=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),$t=["style","variant","weight","size","lineHeight","family"],Bt=function(t){var i=t.match(Jt);if(!i)return null;for(var n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},r=0,s=$t.length;r<s;++r){var h=i[r+1];void 0!==h&&(n[$t[r]]=h)}return n.families=n.family.split(/,\s?/),n},Ht=[],Kt=[0,0,0,0],Qt=new kt;(new Mt).setSize=function(){console.warn("labelCache is deprecated.")};var ti,ii,ni,ri=null,si={},hi=function(){var t,i,n="32px ",r=["monospace","serif"],s=r.length,h="wmytzilWMYTZIL@#/&?$%10";function o(t,o,u){for(var e=!0,f=0;f<s;++f){var a=r[f];if(i=ei(t+" "+o+" "+n+a,h),u!=a){var c=ei(t+" "+o+" "+n+u+","+a,h);e=e&&c!=i}}return!!e}function u(){for(var i=!0,n=Qt.getKeys(),r=0,s=n.length;r<s;++r){var h=n[r];Qt.get(h)<100&&(o.apply(this,h.split("\n"))?(pt(si),ri=null,ti=void 0,Qt.set(h,100)):(Qt.set(h,Qt.get(h)+1,!0),i=!1))}i&&(clearInterval(t),t=void 0)}return function(i){var n=Bt(i);if(n)for(var r=n.families,s=0,h=r.length;s<h;++s){var e=r[s],f=n.style+"\n"+n.weight+"\n"+e;void 0===Qt.get(f)&&(Qt.set(f,100,!0),o(n.style,n.weight,e)||(Qt.set(f,0,!0),void 0===t&&(t=setInterval(u,32))))}}}(),oi=(ni=si,function(t){var i=ni[t];if(null==i)if(Yt){var n=Bt(t),r=ui(t,"Žg"),s=isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight);si[t]=s*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else ii||((ii=document.createElement("div")).innerHTML="M",ii.style.margin="0 !important",ii.style.padding="0 !important",ii.style.position="absolute !important",ii.style.left="-99999px !important"),ii.style.font=t,document.body.appendChild(ii),ni[t]=i=ii.offsetHeight,document.body.removeChild(ii);return i});function ui(t,i){return ri||(ri=Ut(1,1)),t!=ti&&(ri.font=t,ti=ri.font),ri.measureText(i)}function ei(t,i){return ui(t,i).width}function fi(t,i,n){if(i in n)return n[i];var r=ei(t,i);return n[i]=r,r}function ai(t,i,n,r){0!==i&&(t.translate(n,r),t.rotate(i),t.translate(-n,-r))}function ci(t,i,n,r,s,h,o,u,e,f,a){t.save(),1!==n&&(t.globalAlpha*=n),i&&t.setTransform.apply(t,i),r.contextInstructions?(t.translate(e,f),t.scale(a[0],a[1]),function(t,i){for(var n=t.contextInstructions,r=0,s=n.length;r<s;r+=2)Array.isArray(n[r+1])?i[n[r]].apply(i,n[r+1]):i[n[r]]=n[r+1]}(r,t)):a[0]<0||a[1]<0?(t.translate(e,f),t.scale(a[0],a[1]),t.drawImage(r,s,h,o,u,0,0,o,u)):t.drawImage(r,s,h,o,u,e,f,o*a[0],u*a[1]),t.restore()}var vi=null;function li(t,i,n,r,s,h){for(var o=h||[],u=0,e=i;e<n;e+=r){var f=t[e],a=t[e+1];o[u++]=s[0]*f+s[2]*a+s[4],o[u++]=s[1]*f+s[3]*a+s[5]}return h&&o.length!=u&&(o.length=u),o}function di(t,i,n,r,s,h,o){for(var u=o||[],e=Math.cos(s),f=Math.sin(s),a=h[0],c=h[1],v=0,l=i;l<n;l+=r){var d=t[l]-a,p=t[l+1]-c;u[v++]=a+d*e-p*f,u[v++]=c+d*f+p*e;for(var _=l+2;_<l+r;++_)u[v++]=t[_]}return o&&u.length!=v&&(u.length=v),u}var pi={};pi.degrees=2*Math.PI*6370997/360,pi.ft=.3048,pi.m=1,pi["us-ft"]=1200/3937;var _i=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||pi[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}(),mi=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wi=6378137*Math.PI,Mi=[-wi,-wi,wi,wi],gi=[-180,-85,180,85],bi=function(t){function i(i){return t.call(this,{code:i,units:"m",extent:Mi,global:!0,worldExtent:gi,getPointResolution:function(t,i){return t/K(i[1]/6378137)}})||this}return mi(i,t),i}(_i),yi=[new bi("EPSG:3857"),new bi("EPSG:102100"),new bi("EPSG:102113"),new bi("EPSG:900913"),new bi("urn:ogc:def:crs:EPSG:6.18:3:3857"),new bi("urn:ogc:def:crs:EPSG::3857"),new bi("http://www.opengis.net/gml/srs/epsg.xml#3857")];var Oi,ji,xi,Ai=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ki=[-180,-90,180,90],Si=6378137*Math.PI/180,Ni=function(t){function i(i,n){return t.call(this,{code:i,units:"degrees",extent:ki,axisOrientation:n,global:!0,metersPerUnit:Si,worldExtent:ki})||this}return Ai(i,t),i}(_i),Ei=[new Ni("CRS:84"),new Ni("EPSG:4326","neu"),new Ni("urn:ogc:def:crs:EPSG::4326","neu"),new Ni("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Ni("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ni("urn:ogc:def:crs:OGC:2:84"),new Ni("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ni("urn:x-ogc:def:crs:EPSG:4326","neu")],Pi={},Ti={};function Ii(t,i,n){var r=t.getCode(),s=i.getCode();r in Ti||(Ti[r]={}),Ti[r][s]=n}function Fi(t,i,n){var r=n||6371008.8,s=nt(t[1]),h=nt(i[1]),o=(h-s)/2,u=nt(i[0]-t[0])/2,e=Math.sin(o)*Math.sin(o)+Math.sin(u)*Math.sin(u)*Math.cos(s)*Math.cos(h);return 2*r*Math.atan2(Math.sqrt(e),Math.sqrt(1-e))}function Ci(t,i){for(var n=!0,r=t.length-1;r>=0;--r)if(t[r]!=i[r]){n=!1;break}return n}function zi(t,i){var n=Math.cos(i),r=Math.sin(i),s=t[1]*n+t[0]*r;return t[0]=t[0]*n-t[1]*r,t[1]=s,t}function Li(t,i){if(i.canWrapX()){var n=J(i.getExtent()),r=function(t,i,n){var r=i.getExtent(),s=0;if(i.canWrapX()&&(t[0]<r[0]||t[0]>r[2])){var h=n||J(r);s=Math.floor((t[0]-r[0])/h)}return s}(t,i,n);r&&(t[0]-=r*n)}return t}function Ri(t,i){var n;if(void 0!==i){for(var r=0,s=t.length;r<s;++r)i[r]=t[r];n=i}else n=t.slice();return n}function Di(t,i){if(void 0!==i&&t!==i){for(var n=0,r=t.length;n<r;++n)i[n]=t[n];t=i}return t}function Xi(t){!function(t,i){Pi[t]=i}(t.getCode(),t),Ii(t,t,Ri)}function Gi(t){return"string"==typeof t?Pi[t]||null:t||null}function Yi(t,i,n,r){var s,h=(t=Gi(t)).getPointResolutionFunc();if(h)s=h(i,n),r&&r!==t.getUnits()&&(o=t.getMetersPerUnit())&&(s=s*o/pi[r]);else if("degrees"==t.getUnits()&&!r||"degrees"==r)s=i;else{var o,u=Vi(t,Gi("EPSG:4326")),e=[n[0]-i/2,n[1],n[0]+i/2,n[1],n[0],n[1]-i/2,n[0],n[1]+i/2];s=(Fi((e=u(e,e,2)).slice(0,2),e.slice(2,4))+Fi(e.slice(4,6),e.slice(6,8)))/2,void 0!==(o=r?pi[r]:t.getMetersPerUnit())&&(s/=o)}return s}function Wi(t){!function(t){t.forEach(Xi)}(t),t.forEach((function(i){t.forEach((function(t){i!==t&&Ii(i,t,Ri)}))}))}function Zi(t,i){return t?"string"==typeof t?Gi(t):t:Gi(i)}function Ui(t,i){return $i(t,"EPSG:4326",void 0!==i?i:"EPSG:3857")}function qi(t,i){if(t===i)return!0;var n=t.getUnits()===i.getUnits();return(t.getCode()===i.getCode()||Vi(t,i)===Ri)&&n}function Vi(t,i){var n=function(t,i){var n;return t in Ti&&i in Ti[t]&&(n=Ti[t][i]),n}(t.getCode(),i.getCode());return n||(n=Di),n}function Ji(t,i){return Vi(Gi(t),Gi(i))}function $i(t,i,n){return Ji(i,n)(t,void 0,t.length)}function Bi(t){return t}function Hi(t){return t}function Ki(t){return t}Wi(yi),Wi(Ei),Oi=yi,ji=function(t,i,n){var r=t.length,s=n>1?n:2,h=i;void 0===h&&(h=s>2?t.slice():new Array(r));for(var o=wi,u=0;u<r;u+=s){h[u]=o*t[u]/180;var e=6378137*Math.log(Math.tan(Math.PI*(+t[u+1]+90)/360));e>o?e=o:e<-o&&(e=-o),h[u+1]=e}return h},xi=function(t,i,n){var r=t.length,s=n>1?n:2,h=i;void 0===h&&(h=s>2?t.slice():new Array(r));for(var o=0;o<r;o+=s)h[o]=180*t[o]/wi,h[o+1]=360*Math.atan(Math.exp(t[o+1]/6378137))/Math.PI-90;return h},Ei.forEach((function(t){Oi.forEach((function(i){Ii(t,i,ji),Ii(i,t,xi)}))}));var Qi=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tn=[1,0,0,1,0,0],nn=function(t){function i(){var i,n,r,s,h,o=t.call(this)||this;return o.extent_=[1/0,1/0,-1/0,-1/0],o.extentRevision_=-1,o.simplifiedGeometryMaxMinSquaredTolerance=0,o.simplifiedGeometryRevision=0,o.simplifyTransformedInternal=(i=function(t,i,n){if(!n)return this.getSimplifiedGeometry(i);var r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(i)},h=!1,function(){var t=Array.prototype.slice.call(arguments);return h&&this===s&&e(t,r)||(h=!0,s=this,r=t,n=i.apply(this,arguments)),n}),o}return Qi(i,t),i.prototype.simplifyTransformed=function(t,i){return this.simplifyTransformedInternal(this.getRevision(),t,i)},i.prototype.clone=function(){return v()},i.prototype.closestPointXY=function(){return v()},i.prototype.containsXY=function(t,i){var n=this.getClosestPoint([t,i]);return n[0]===t&&n[1]===i},i.prototype.getClosestPoint=function(t,i){var n=i||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,1/0),n},i.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},i.prototype.computeExtent=function(){return v()},i.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var i=this.computeExtent(this.extent_);(isNaN(i[0])||isNaN(i[1]))&&T(i),this.extentRevision_=this.getRevision()}return function(t,i){return i?(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i):t}(this.extent_,t)},i.prototype.rotate=function(){v()},i.prototype.scale=function(){v()},i.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},i.prototype.getSimplifiedGeometry=function(){return v()},i.prototype.getType=function(){return v()},i.prototype.applyTransform=function(){v()},i.prototype.intersectsExtent=function(){return v()},i.prototype.translate=function(){v()},i.prototype.transform=function(t,i){var n=Gi(t),r="tile-pixels"==n.getUnits()?function(t,r,s){var h=n.getExtent(),o=n.getWorldExtent(),u=Z(o)/Z(h);return g(tn,o[0],o[3],u,-u,0,0,0),li(t,0,t.length,s,tn,r),Ji(n,i)(t,r,s)}:Ji(n,i);return this.applyTransform(r),this},i}(kt);var rn=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sn=function(t){function i(){var i=t.call(this)||this;return i.layout="XY",i.stride=2,i.flatCoordinates=null,i}return rn(i,t),i.prototype.computeExtent=function(t){return i=this.flatCoordinates,0,n=this.flatCoordinates.length,r=this.stride,C(T(t),i,0,n,r);var i,n,r},i.prototype.getCoordinates=function(){return v()},i.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},i.prototype.getFlatCoordinates=function(){return this.flatCoordinates},i.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},i.prototype.getLayout=function(){return this.layout},i.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?i:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},i.prototype.getSimplifiedGeometryInternal=function(){return this},i.prototype.getStride=function(){return this.stride},i.prototype.setFlatCoordinates=function(t,i){this.stride=hn(t),this.layout=t,this.flatCoordinates=i},i.prototype.setCoordinates=function(){v()},i.prototype.setLayout=function(t,i,n){var r;if(t)r=hn(t);else{for(var s=0;s<n;++s){if(0===i.length)return this.layout="XY",void(this.stride=2);i=i[0]}t=function(t){var i;return 2==t?i="XY":3==t?i="XYZ":4==t&&(i="XYZM"),i}(r=i.length)}this.layout=t,this.stride=r},i.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},i.prototype.rotate=function(t,i){var n=this.getFlatCoordinates();if(n){var r=this.getStride();di(n,0,n.length,r,t,i,n),this.changed()}},i.prototype.scale=function(t,i,n){var r=i;void 0===r&&(r=t);var s=n;s||(s=G(this.getExtent()));var h=this.getFlatCoordinates();if(h){var o=this.getStride();!function(t,i,n,r,s,h,o,u){for(var e=u||[],f=o[0],a=o[1],c=0,v=0;v<n;v+=r){var l=t[v+1]-a;e[c++]=f+s*(t[v]-f),e[c++]=a+h*l;for(var d=v+2;d<v+r;++d)e[c++]=t[d]}u&&e.length!=c&&(e.length=c)}(h,0,h.length,o,t,r,s,h),this.changed()}},i.prototype.translate=function(t,i){var n=this.getFlatCoordinates();if(n){var r=this.getStride();!function(t,i,n,r,s,h,o){for(var u=o||[],e=0,f=0;f<n;f+=r){u[e++]=t[f]+s,u[e++]=t[f+1]+h;for(var a=f+2;a<f+r;++a)u[e++]=t[a]}o&&u.length!=e&&(u.length=e)}(n,0,n.length,r,t,i,n),this.changed()}},i}(nn);function hn(t){var i;return"XY"==t?i=2:"XYZ"==t||"XYM"==t?i=3:"XYZM"==t&&(i=4),i}var on=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),un=function(t){function i(i,n,r,s,h,o,u){var e=t.call(this)||this;return e.context_=i,e.pixelRatio_=n,e.extent_=r,e.transform_=s,e.viewRotation_=h,e.squaredTolerance_=o,e.userTransform_=u,e.contextFillState_=null,e.contextStrokeState_=null,e.contextTextState_=null,e.fillState_=null,e.strokeState_=null,e.image_=null,e.imageAnchorX_=0,e.imageAnchorY_=0,e.imageHeight_=0,e.imageOpacity_=0,e.imageOriginX_=0,e.imageOriginY_=0,e.imageRotateWithView_=!1,e.imageRotation_=0,e.imageScale_=[0,0],e.imageWidth_=0,e.text_="",e.textOffsetX_=0,e.textOffsetY_=0,e.textRotateWithView_=!1,e.textRotation_=0,e.textScale_=[0,0],e.textFillState_=null,e.textStrokeState_=null,e.textState_=null,e.pixelCoordinates_=[],e.tmpLocalTransform_=[1,0,0,1,0,0],e}return on(i,t),i.prototype.drawImages_=function(t,i,n){if(this.image_){var r=li(t,i,n,2,this.transform_,this.pixelCoordinates_),s=this.context_,h=this.tmpLocalTransform_,o=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=o*this.imageOpacity_);var u=this.imageRotation_;this.imageRotateWithView_&&(u+=this.viewRotation_);for(var e=0,f=r.length;e<f;e+=2){var a=r[e]-this.imageAnchorX_,c=r[e+1]-this.imageAnchorY_;if(0!==u||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var v=a+this.imageAnchorX_,l=c+this.imageAnchorY_;g(h,v,l,1,1,u,-v,-l),s.setTransform.apply(s,h),s.translate(v,l),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.setTransform(1,0,0,1,0,0)}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,a,c,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=o)}},i.prototype.drawText_=function(t,i,n,r){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var s=li(t,i,n,r,this.transform_,this.pixelCoordinates_),h=this.context_,o=this.textRotation_;for(this.textRotateWithView_&&(o+=this.viewRotation_);i<n;i+=r){var u=s[i]+this.textOffsetX_,e=s[i+1]+this.textOffsetY_;if(0!==o||1!=this.textScale_[0]||1!=this.textScale_[1]){var f=g(this.tmpLocalTransform_,u,e,1,1,o,-u,-e);h.setTransform.apply(h,f),h.translate(u,e),h.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&h.strokeText(this.text_,0,0),this.textFillState_&&h.fillText(this.text_,0,0),h.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&h.strokeText(this.text_,u,e),this.textFillState_&&h.fillText(this.text_,u,e)}}},i.prototype.moveToLineTo_=function(t,i,n,r,s){var h=this.context_,o=li(t,i,n,r,this.transform_,this.pixelCoordinates_);h.moveTo(o[0],o[1]);var u=o.length;s&&(u-=2);for(var e=2;e<u;e+=2)h.lineTo(o[e],o[e+1]);return s&&h.closePath(),n},i.prototype.drawRings_=function(t,i,n,r){for(var s=0,h=n.length;s<h;++s)i=this.moveToLineTo_(t,i,n[s],r,!0);return i},i.prototype.drawCircle=function(t){if($(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=function(t,i,n){var r=t.getFlatCoordinates();if(r){var s=t.getStride();return li(r,0,r.length,s,i,n)}return null}(t,this.transform_,this.pixelCoordinates_),n=i[2]-i[0],r=i[3]-i[1],s=Math.sqrt(n*n+r*r),h=this.context_;h.beginPath(),h.arc(i[0],i[1],s,0,2*Math.PI),this.fillState_&&h.fill(),this.strokeState_&&h.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},i.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},i.prototype.setTransform=function(t){this.transform_=t},i.prototype.drawGeometry=function(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}},i.prototype.drawFeature=function(t,i){var n=i.getGeometryFunction()(t);n&&$(this.extent_,n.getExtent())&&(this.setStyle(i),this.drawGeometry(n))},i.prototype.drawGeometryCollection=function(t){for(var i=t.getGeometriesArray(),n=0,r=i.length;n<r;++n)this.drawGeometry(i[n])},i.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(i,0,i.length,n),""!==this.text_&&this.drawText_(i,0,i.length,n)},i.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(i,0,i.length,n),""!==this.text_&&this.drawText_(i,0,i.length,n)},i.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),$(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates();i.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),i.stroke()}if(""!==this.text_){var r=t.getFlatMidpoint();this.drawText_(r,0,2,2)}}},i.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getExtent();if($(this.extent_,i)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,r=t.getFlatCoordinates(),s=0,h=t.getEnds(),o=t.getStride();n.beginPath();for(var u=0,e=h.length;u<e;++u)s=this.moveToLineTo_(r,s,h[u],o,!1);n.stroke()}if(""!==this.text_){var f=t.getFlatMidpoints();this.drawText_(f,0,f.length,2)}}},i.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),$(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_;i.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(""!==this.text_){var n=t.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}},i.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),$(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getOrientedFlatCoordinates(),r=0,s=t.getEndss(),h=t.getStride();i.beginPath();for(var o=0,u=s.length;o<u;++o)r=this.drawRings_(n,r,s[o],h);this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(""!==this.text_){var e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}},i.prototype.setContextFillState_=function(t){var i=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,i.fillStyle=t.fillStyle):(i.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},i.prototype.setContextStrokeState_=function(t){var i=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,i.lineCap=t.lineCap),i.setLineDash&&(e(n.lineDash,t.lineDash)||i.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,i.lineDashOffset=t.lineDashOffset)),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,i.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,i.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,i.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,i.strokeStyle=t.strokeStyle)):(i.lineCap=t.lineCap,i.setLineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.lineWidth=t.lineWidth,i.miterLimit=t.miterLimit,i.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},i.prototype.setContextTextState_=function(t){var i=this.context_,n=this.contextTextState_,r=t.textAlign?t.textAlign:"center";n?(n.font!=t.font&&(n.font=t.font,i.font=t.font),n.textAlign!=r&&(n.textAlign=r,i.textAlign=r),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,i.textBaseline=t.textBaseline)):(i.font=t.font,i.textAlign=r,i.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})},i.prototype.setFillStrokeStyle=function(t,i){if(t){var n=t.getColor();this.fillState_={fillStyle:zt(n||"#000")}}else this.fillState_=null;if(i){var r=i.getColor(),s=i.getLineCap(),h=i.getLineDash(),o=i.getLineDashOffset(),u=i.getLineJoin(),e=i.getWidth(),f=i.getMiterLimit();this.strokeState_={lineCap:void 0!==s?s:"round",lineDash:h||Ht,lineDashOffset:o||0,lineJoin:void 0!==u?u:"round",lineWidth:this.pixelRatio_*(void 0!==e?e:1),miterLimit:void 0!==f?f:10,strokeStyle:zt(r||"#000")}}else this.strokeState_=null},i.prototype.setImageStyle=function(t){if(t){var i=t.getSize();if(i){var n=t.getAnchor(),r=t.getImage(1),s=t.getOrigin(),h=t.getScaleArray();this.imageAnchorX_=n[0],this.imageAnchorY_=n[1],this.imageHeight_=i[1],this.image_=r,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]],this.imageWidth_=i[0]}else this.image_=null}else this.image_=null},i.prototype.setTextStyle=function(t){if(t){var i=t.getFill();if(i){var n=i.getColor();this.textFillState_={fillStyle:zt(n||"#000")}}else this.textFillState_=null;var r=t.getStroke();if(r){var s=r.getColor(),h=r.getLineCap(),o=r.getLineDash(),u=r.getLineDashOffset(),e=r.getLineJoin(),f=r.getWidth(),a=r.getMiterLimit();this.textStrokeState_={lineCap:void 0!==h?h:"round",lineDash:o||Ht,lineDashOffset:u||0,lineJoin:void 0!==e?e:"round",lineWidth:void 0!==f?f:1,miterLimit:void 0!==a?a:10,strokeStyle:zt(s||"#000")}}else this.textStrokeState_=null;var c=t.getFont(),v=t.getOffsetX(),l=t.getOffsetY(),d=t.getRotateWithView(),p=t.getRotation(),_=t.getScaleArray(),m=t.getText(),w=t.getTextAlign(),M=t.getTextBaseline();this.textState_={font:void 0!==c?c:"10px sans-serif",textAlign:void 0!==w?w:"center",textBaseline:void 0!==M?M:"middle"},this.text_=void 0!==m?m:"",this.textOffsetX_=void 0!==v?this.pixelRatio_*v:0,this.textOffsetY_=void 0!==l?this.pixelRatio_*l:0,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0!==p?p:0,this.textScale_=[this.pixelRatio_*_[0],this.pixelRatio_*_[1]]}else this.text_=""},i}(Ct);var en={Point:function(t,i,n,r){var s=n.getImage();if(s){if(2!=s.getImageState())return;var h=t.getBuilder(n.getZIndex(),"Image");h.setImageStyle(s,t.addDeclutter(!1)),h.drawPoint(i,r)}var o=n.getText();if(o){var u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(o,t.addDeclutter(!!s)),u.drawText(i,r)}},LineString:function(t,i,n,r){var s=n.getStroke();if(s){var h=t.getBuilder(n.getZIndex(),"LineString");h.setFillStrokeStyle(null,s),h.drawLineString(i,r)}var o=n.getText();if(o){var u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(o,t.addDeclutter(!1)),u.drawText(i,r)}},Polygon:function(t,i,n,r){var s=n.getFill(),h=n.getStroke();if(s||h){var o=t.getBuilder(n.getZIndex(),"Polygon");o.setFillStrokeStyle(s,h),o.drawPolygon(i,r)}var u=n.getText();if(u){var e=t.getBuilder(n.getZIndex(),"Text");e.setTextStyle(u,t.addDeclutter(!1)),e.drawText(i,r)}},MultiPoint:function(t,i,n,r){var s=n.getImage();if(s){if(2!=s.getImageState())return;var h=t.getBuilder(n.getZIndex(),"Image");h.setImageStyle(s,t.addDeclutter(!1)),h.drawMultiPoint(i,r)}var o=n.getText();if(o){var u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(o,t.addDeclutter(!!s)),u.drawText(i,r)}},MultiLineString:function(t,i,n,r){var s=n.getStroke();if(s){var h=t.getBuilder(n.getZIndex(),"LineString");h.setFillStrokeStyle(null,s),h.drawMultiLineString(i,r)}var o=n.getText();if(o){var u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(o,t.addDeclutter(!1)),u.drawText(i,r)}},MultiPolygon:function(t,i,n,r){var s=n.getFill(),h=n.getStroke();if(h||s){var o=t.getBuilder(n.getZIndex(),"Polygon");o.setFillStrokeStyle(s,h),o.drawMultiPolygon(i,r)}var u=n.getText();if(u){var e=t.getBuilder(n.getZIndex(),"Text");e.setTextStyle(u,t.addDeclutter(!1)),e.drawText(i,r)}},GeometryCollection:function(t,i,n,r){var s,h,o=i.getGeometriesArray();for(s=0,h=o.length;s<h;++s)(0,en[o[s].getType()])(t,o[s],n,r)},Circle:function(t,i,n,r){var s=n.getFill(),h=n.getStroke();if(s||h){var o=t.getBuilder(n.getZIndex(),"Circle");o.setFillStrokeStyle(s,h),o.drawCircle(i,r)}var u=n.getText();if(u){var e=t.getBuilder(n.getZIndex(),"Text");e.setTextStyle(u,t.addDeclutter(!1)),e.drawText(i,r)}}};function fn(t,i){return parseInt(d(t),10)-parseInt(d(i),10)}function an(t,i){return.5*t/i}function cn(t,i,n,r,s,h){var o=!1,u=n.getImage();if(u){var e=u.getImageState();2==e||3==e?u.unlistenImageChange(s):(0==e&&u.load(),e=u.getImageState(),u.listenImageChange(s),o=!0)}return function(t,i,n,r,s){var h=n.getGeometryFunction()(i);if(h){var o=h.simplifyTransformed(r,s);n.getRenderer()?vn(t,o,n,i):(0,en[o.getType()])(t,o,n,i)}}(t,i,n,r,h),o}function vn(t,i,n,r){if("GeometryCollection"!=i.getType())t.getBuilder(n.getZIndex(),"Default").drawCustom(i,r,n.getRenderer());else for(var s=i.getGeometries(),h=0,o=s.length;h<o;++h)vn(t,s[h],n,r)}var ln=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dn=function(t){function i(i){var n=t.call(this)||this;return n.map_=i,n.declutterTree_=null,n}return ln(i,t),i.prototype.dispatchRenderEvent=function(){v()},i.prototype.calculateMatrices2D=function(t){var i=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;g(n,t.size[0]/2,t.size[1]/2,1/i.resolution,-1/i.resolution,-i.rotation,-i.center[0],-i.center[1]),b(r,n)},i.prototype.forEachFeatureAtCoordinate=function(t,i,n,r,s,h,o,u){var e,f=i.viewState;function a(t,i,n){return s.call(h,i,t?n:null)}var c=f.projection,v=Li(t.slice(),c),l=[[0,0]];if(c.canWrapX()&&r){var d=J(c.getExtent());l.push([-d,0],[d,0])}var p,_=i.layerStatesArray,m=_.length;this.declutterTree_&&(p=this.declutterTree_.all().map((function(t){return t.value})));for(var w=[],M=0;M<l.length;M++)for(var g=m-1;g>=0;--g){var b=_[g],y=b.layer;if(y.hasRenderer()&&Ft(b,f)&&o.call(u,y)){var O=y.getRenderer(),j=y.getSource();if(O&&j){var x=j.getWrapX()?v:t,A=a.bind(null,b.managed);w[0]=x[0]+l[M][0],w[1]=x[1]+l[M][1],e=O.forEachFeatureAtCoordinate(w,i,n,A,p)}if(e)return e}}},i.prototype.forEachLayerAtPixel=function(){return v()},i.prototype.hasFeatureAtCoordinate=function(t,i,n,r,s,h){return void 0!==this.forEachFeatureAtCoordinate(t,i,n,r,f,this,s,h)},i.prototype.getMap=function(){return this.map_},i.prototype.renderFrame=function(t){this.declutterTree_=function(t,i){i&&i.clear();for(var n=t.declutterItems,r=n.length-1;r>=0;--r)for(var s=n[r],h=s.items,o=0,u=h.length;o<u;o+=3)i=h[o].renderDeclutter(h[o+1],h[o+2],s.opacity,i);return n.length=0,i}(t,this.declutterTree_)},i.prototype.scheduleExpireIconCache=function(t){vt.canExpireCache()&&t.postRenderFunctions.push(pn)},i}(r);function pn(){vt.expire()}var _n=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mn=function(t){function i(i,n,r,s){var h=t.call(this,i)||this;return h.inversePixelTransform=n,h.frameState=r,h.context=s,h}return _n(i,t),i}(lt),wn=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mn=function(t){function i(i){var n=t.call(this,i)||this;n.fontChangeListenerKey_=gt(Qt,"propertychange",i.redrawText.bind(i)),n.element_=document.createElement("div");var r=n.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",n.element_.className="ol-unselectable ol-layers";var s=i.getViewport();return s.insertBefore(n.element_,s.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return wn(i,t),i.prototype.dispatchRenderEvent=function(t,i){var n=this.getMap();if(n.hasListener(t)){var r=new mn(t,void 0,i);n.dispatchEvent(r)}},i.prototype.disposeInternal=function(){yt(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),t.prototype.disposeInternal.call(this)},i.prototype.renderFrame=function(i){if(i){this.calculateMatrices2D(i),this.dispatchRenderEvent("precompose",i);var n=i.layerStatesArray.sort((function(t,i){return t.zIndex-i.zIndex})),r=i.viewState;this.children_.length=0;for(var s=null,h=0,o=n.length;h<o;++h){var u=n[h];if(i.layerIndex=h,Ft(u,r)&&("ready"==u.sourceState||"undefined"==u.sourceState)){var e=u.layer.render(i,s);e&&e!==s&&(this.children_.push(e),s=e)}}t.prototype.renderFrame.call(this,i),function(t,i){for(var n=t.childNodes,r=0;;++r){var s=n[r],h=i[r];if(!s&&!h)break;s!==h&&(s?h?t.insertBefore(h,s):(t.removeChild(s),--r):t.appendChild(h))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",i),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(i)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},i.prototype.forEachLayerAtPixel=function(t,i,n,r,s){for(var h=i.viewState,o=i.layerStatesArray,u=o.length-1;u>=0;--u){var e=o[u],f=e.layer;if(f.hasRenderer()&&Ft(e,h)&&s(f)){var a=f.getRenderer().getDataAtPixel(t,i,n);if(a){var c=r(f,a);if(c)return c}}}},i}(dn);var gn=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bn=function(t){function i(i,n,r){var s=t.call(this,i)||this;return s.element=n,s.index=r,s}return gn(i,t),i}(lt),yn=function(t){function i(i,n){var r=t.call(this)||this;if(r.unique_=!!(n||{}).unique,r.array_=i||[],r.unique_)for(var s=0,h=r.array_.length;s<h;++s)r.assertUnique_(r.array_[s],s);return r.updateLength_(),r}return gn(i,t),i.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},i.prototype.extend=function(t){for(var i=0,n=t.length;i<n;++i)this.push(t[i]);return this},i.prototype.forEach=function(t){for(var i=this.array_,n=0,r=i.length;n<r;++n)t(i[n],n,i)},i.prototype.getArray=function(){return this.array_},i.prototype.item=function(t){return this.array_[t]},i.prototype.getLength=function(){return this.get("length")},i.prototype.insertAt=function(t,i){this.unique_&&this.assertUnique_(i),this.array_.splice(t,0,i),this.updateLength_(),this.dispatchEvent(new bn("add",i,t))},i.prototype.pop=function(){return this.removeAt(this.getLength()-1)},i.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var i=this.getLength();return this.insertAt(i,t),this.getLength()},i.prototype.remove=function(t){for(var i=this.array_,n=0,r=i.length;n<r;++n)if(i[n]===t)return this.removeAt(n)},i.prototype.removeAt=function(t){var i=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new bn("remove",i,t)),i},i.prototype.setAt=function(t,i){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(i,t);var r=this.array_[t];this.array_[t]=i,this.dispatchEvent(new bn("remove",r,t)),this.dispatchEvent(new bn("add",i,t))}else{for(var s=n;s<t;++s)this.insertAt(s,void 0);this.insertAt(t,i)}},i.prototype.updateLength_=function(){this.set("length",this.array_.length)},i.prototype.assertUnique_=function(t,i){for(var n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==i)throw new m(58)},i}(kt),On=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jn=function(t){function i(i){var n=this,r=i||{},s=dt({},r);delete s.layers;var h=r.layers;return(n=t.call(this,s)||this).layersListenerKeys_=[],n.listenerKeys_={},n.addEventListener(Nt("layers"),n.handleLayersChanged_),h?Array.isArray(h)?h=new yn(h.slice(),{unique:!0}):w("function"==typeof h.getArray,43):h=new yn(void 0,{unique:!0}),n.setLayers(h),n}return On(i,t),i.prototype.handleLayerChange_=function(){this.changed()},i.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(yt),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var i in this.layersListenerKeys_.push(gt(t,"add",this.handleLayersAdd_,this),gt(t,"remove",this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[i].forEach(yt);pt(this.listenerKeys_);for(var n=t.getArray(),r=0,s=n.length;r<s;r++){var h=n[r];this.listenerKeys_[d(h)]=[gt(h,"propertychange",this.handleLayerChange_,this),gt(h,"change",this.handleLayerChange_,this)]}this.changed()},i.prototype.handleLayersAdd_=function(t){var i=t.element;this.listenerKeys_[d(i)]=[gt(i,"propertychange",this.handleLayerChange_,this),gt(i,"change",this.handleLayerChange_,this)],this.changed()},i.prototype.handleLayersRemove_=function(t){var i=d(t.element);this.listenerKeys_[i].forEach(yt),delete this.listenerKeys_[i],this.changed()},i.prototype.getLayers=function(){return this.get("layers")},i.prototype.setLayers=function(t){this.set("layers",t)},i.prototype.getLayersArray=function(t){var i=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(i)})),i},i.prototype.getLayerStatesArray=function(t){var i=void 0!==t?t:[],n=i.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(i)}));for(var r=this.getLayerState(),s=n,h=i.length;s<h;s++){var o=i[s];o.opacity*=r.opacity,o.visible=o.visible&&r.visible,o.maxResolution=Math.min(o.maxResolution,r.maxResolution),o.minResolution=Math.max(o.minResolution,r.minResolution),o.minZoom=Math.max(o.minZoom,r.minZoom),o.maxZoom=Math.min(o.maxZoom,r.maxZoom),void 0!==r.extent&&(o.extent=void 0!==o.extent?U(o.extent,r.extent):r.extent)}return i},i.prototype.getSourceState=function(){return"ready"},i}(Pt),xn=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),An=function(t){function i(i,n,r){var s=t.call(this,i)||this;return s.map=n,s.frameState=void 0!==r?r:null,s}return xn(i,t),i}(lt),kn=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sn=function(t){function i(i,n,r,s,h){var o=t.call(this,i,n,h)||this;return o.originalEvent=r,o.pixel_=null,o.coordinate_=null,o.dragging=void 0!==s&&s,o}return kn(i,t),Object.defineProperty(i.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),i.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},i.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},i}(An);const Nn={SINGLECLICK:"singleclick",CLICK:"click",DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var En=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pn=function(t){function i(i,n){var r=t.call(this,i)||this;r.map_=i,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=n?n*Gt:Gt,r.down_=null;var s=r.map_.getViewport();return r.activePointers_=0,r.trackedTouches_={},r.element_=s,r.pointerdownListenerKey_=gt(s,"pointerdown",r.handlePointerDown_,r),r.relayedListenerKey_=gt(s,"pointermove",r.relayEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener("touchmove",r.boundHandleTouchMove_,!!Zt&&{passive:!1}),r}return En(i,t),i.prototype.emulateClick_=function(t){var i=new Sn(Nn.CLICK,this.map_,t);this.dispatchEvent(i),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,i=new Sn(Nn.DBLCLICK,this.map_,t),this.dispatchEvent(i)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var i=new Sn(Nn.SINGLECLICK,this.map_,t);this.dispatchEvent(i)}.bind(this),250)},i.prototype.updateActivePointers_=function(t){var i=t;i.type==Nn.POINTERUP||i.type==Nn.POINTERCANCEL?delete this.trackedTouches_[i.pointerId]:i.type==Nn.POINTERDOWN&&(this.trackedTouches_[i.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},i.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var i=new Sn(Nn.POINTERUP,this.map_,t);this.dispatchEvent(i),i.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(yt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},i.prototype.isMouseActionButton_=function(t){return 0===t.button},i.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var i=new Sn(Nn.POINTERDOWN,this.map_,t);this.dispatchEvent(i),this.down_=t,0===this.dragListenerKeys_.length&&(this.dragListenerKeys_.push(gt(document,Nn.POINTERMOVE,this.handlePointerMove_,this),gt(document,Nn.POINTERUP,this.handlePointerUp_,this),gt(this.element_,Nn.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==document&&this.dragListenerKeys_.push(gt(this.element_.getRootNode(),Nn.POINTERUP,this.handlePointerUp_,this)))},i.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var i=new Sn(Nn.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(i)}},i.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var i=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Sn(t.type,this.map_,t,i))},i.prototype.handleTouchMove_=function(t){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||t.preventDefault()},i.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},i.prototype.disposeInternal=function(){this.relayedListenerKey_&&(yt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener("touchmove",this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(yt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(yt),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},i}(Mt);var Tn=1/0,In=function(){function t(t,i){this.priorityFunction_=t,this.keyFunction_=i,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,pt(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,i=this.priorities_,n=t[0];1==t.length?(t.length=0,i.length=0):(t[0]=t.pop(),i[0]=i.pop(),this.siftUp_(0));var r=this.keyFunction_(n);return delete this.queuedElements_[r],n},t.prototype.enqueue=function(t){w(!(this.keyFunction_(t)in this.queuedElements_),31);var i=this.priorityFunction_(t);return i!=Tn&&(this.elements_.push(t),this.priorities_.push(i),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var i=this.elements_,n=this.priorities_,r=i.length,s=i[t],h=n[t],o=t;t<r>>1;){var u=this.getLeftChildIndex_(t),e=this.getRightChildIndex_(t),f=e<r&&n[e]<n[u]?e:u;i[t]=i[f],n[t]=n[f],t=f}i[t]=s,n[t]=h,this.siftDown_(o,t)},t.prototype.siftDown_=function(t,i){for(var n=this.elements_,r=this.priorities_,s=n[i],h=r[i];i>t;){var o=this.getParentIndex_(i);if(!(r[o]>h))break;n[i]=n[o],r[i]=r[o],i=o}n[i]=s,r[i]=h},t.prototype.reprioritize=function(){var t,i,n,r=this.priorityFunction_,s=this.elements_,h=this.priorities_,o=0,u=s.length;for(i=0;i<u;++i)(n=r(t=s[i]))==Tn?delete this.queuedElements_[this.keyFunction_(t)]:(h[o]=n,s[o++]=t);s.length=o,h.length=o,this.heapify_()},t}();var Fn=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Cn=function(t){function i(i,n){var r=t.call(this,(function(t){return i.apply(null,t)}),(function(t){return t[0].getKey()}))||this;return r.boundHandleTileChange_=r.handleTileChange.bind(r),r.tileChangeCallback_=n,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return Fn(i,t),i.prototype.enqueue=function(i){var n=t.prototype.enqueue.call(this,i);return n&&i[0].addEventListener("change",this.boundHandleTileChange_),n},i.prototype.getTilesLoading=function(){return this.tilesLoading_},i.prototype.handleTileChange=function(t){var i=t.target,n=i.getState();if(i.hifi&&2===n||3===n||4===n){i.removeEventListener("change",this.boundHandleTileChange_);var r=i.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}},i.prototype.loadMoreTiles=function(t,i){for(var n,r,s=0;this.tilesLoading_<t&&s<i&&this.getCount()>0;)r=(n=this.dequeue()[0]).getKey(),0!==n.getState()||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++s,n.load())},i}(In);function zn(t,i,n){return function(r,s,h,o){if(r){var u=i?0:h[0]*s,e=i?0:h[1]*s,f=t[0]+u/2,a=t[2]-u/2,c=t[1]+e/2,v=t[3]-e/2;f>a&&(a=f=(a+f)/2),c>v&&(v=c=(v+c)/2);var l=H(r[0],f,a),d=H(r[1],c,v),p=30*s;return o&&n&&(l+=-p*Math.log(1+Math.max(0,f-r[0])/p)+p*Math.log(1+Math.max(0,r[0]-a)/p),d+=-p*Math.log(1+Math.max(0,c-r[1])/p)+p*Math.log(1+Math.max(0,r[1]-v)/p)),[l,d]}}}function Ln(t){return t}function Rn(t,i,n,r){var s=J(i)/n[0],h=Z(i)/n[1];return r?Math.min(t,Math.max(s,h)):Math.min(t,Math.min(s,h))}function Dn(t,i,n){var r=Math.min(t,i);return r*=Math.log(1+50*Math.max(0,t/i-1))/50+1,n&&(r=Math.max(r,n),r/=Math.log(1+50*Math.max(0,n/t-1))/50+1),H(r,n/2,2*i)}function Xn(t,i,n,r,s){return function(h,o,u,e){if(void 0!==h){var f=r?Rn(t,r,u,s):t;return(void 0===n||n)&&e?Dn(h,f,i):H(h,i,f)}}}function Gn(t){return void 0!==t?0:void 0}function Yn(t){return void 0!==t?t:void 0}function Wn(t){return Math.pow(t,3)}function Zn(t){return 1-Wn(1-t)}function Un(t){return 3*t*t-2*t*t*t}function qn(t){return t}function Vn(t,i,n,r,s,h,o){var u,e=t[i],f=t[i+1],a=t[n]-e,c=t[n+1]-f;if(0===a&&0===c)u=i;else{var v=((s-e)*a+(h-f)*c)/(a*a+c*c);if(v>1)u=n;else{if(v>0){for(var l=0;l<r;++l)o[l]=st(t[i+l],t[n+l],v);return void(o.length=r)}u=i}}for(l=0;l<r;++l)o[l]=t[u+l];o.length=r}function Jn(t,i,n,r,s){var h=t[i],o=t[i+1];for(i+=r;i<n;i+=r){var u=t[i],e=t[i+1],f=it(h,o,u,e);f>s&&(s=f),h=u,o=e}return s}function $n(t,i,n,r,s,h,o,u,e,f,a){if(i==n)return f;var c,v;if(0===s){if((v=it(o,u,t[i],t[i+1]))<f){for(c=0;c<r;++c)e[c]=t[i+c];return e.length=r,v}return f}for(var l=a||[NaN,NaN],d=i+r;d<n;)if(Vn(t,d-r,d,r,o,u,l),(v=it(o,u,l[0],l[1]))<f){for(f=v,c=0;c<r;++c)e[c]=l[c];e.length=r,d+=r}else d+=r*Math.max((Math.sqrt(v)-Math.sqrt(f))/s|0,1);if(h&&(Vn(t,n-r,i,r,o,u,l),(v=it(o,u,l[0],l[1]))<f)){for(f=v,c=0;c<r;++c)e[c]=l[c];e.length=r}return f}function Bn(t,i,n,r){for(var s=0,h=n.length;s<h;++s)for(var o=n[s],u=0;u<r;++u)t[i++]=o[u];return i}function Hn(t,i){return i*Math.round(t/i)}function Kn(t,i,n,r,s,h,o){if(i==n)return o;var u,e,f=Hn(t[i],s),a=Hn(t[i+1],s);i+=r,h[o++]=f,h[o++]=a;do{if(u=Hn(t[i],s),e=Hn(t[i+1],s),(i+=r)==n)return h[o++]=u,h[o++]=e,o}while(u==f&&e==a);for(;i<n;){var c=Hn(t[i],s),v=Hn(t[i+1],s);if(i+=r,c!=u||v!=e){var l=u-f,d=e-a,p=c-f,_=v-a;l*_==d*p&&(l<0&&p<l||l==p||l>0&&p>l)&&(d<0&&_<d||d==_||d>0&&_>d)?(u=c,e=v):(h[o++]=u,h[o++]=e,f=u,a=e,u=c,e=v)}}return h[o++]=u,h[o++]=e,o}function Qn(t,i,n,r,s){for(var h=void 0!==s?s:[],o=0,u=i;u<n;u+=r)h[o++]=t.slice(u,u+r);return h.length=o,h}function tr(t,i,n,r,s){for(var h=void 0!==s?s:[],o=0,u=0,e=n.length;u<e;++u){var f=n[u];h[o++]=Qn(t,i,f,r,h[o]),i=f}return h.length=o,h}function ir(t,i,n,r,s){for(var h=void 0!==s?s:[],o=0,u=0,e=n.length;u<e;++u){var f=n[u];h[o++]=tr(t,i,f,r,h[o]),i=f[f.length-1]}return h.length=o,h}function nr(t,i,n,r){for(var s=0,h=t[n-r],o=t[n-r+1];i<n;i+=r){var u=t[i],e=t[i+1];s+=o*u-h*e,h=u,o=e}return s/2}var rr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sr=function(t){function i(i,n){var r=t.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===n||Array.isArray(i[0])?r.setCoordinates(i,n):r.setFlatCoordinates(n,i),r}return rr(i,t),i.prototype.clone=function(){return new i(this.flatCoordinates.slice(),this.layout)},i.prototype.closestPointXY=function(t,i,n,r){return r<A(this.getExtent(),t,i)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$n(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,i,n,r))},i.prototype.getArea=function(){return nr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},i.prototype.getCoordinates=function(){return Qn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},i.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=function(t,i,n,r,s,h,o){var u=(n-i)/r;if(u<3){for(;i<n;i+=r)h[o++]=t[i],h[o++]=t[i+1];return o}var e=new Array(u);e[0]=1,e[u-1]=1;for(var f=[i,n-r],a=0;f.length>0;){for(var c=f.pop(),v=f.pop(),l=0,d=t[v],p=t[v+1],_=t[c],m=t[c+1],w=v+r;w<c;w+=r){var M=tt(t[w],t[w+1],d,p,_,m);M>l&&(a=w,l=M)}l>s&&(e[(a-i)/r]=1,v+r<a&&f.push(v,a),a+r<c&&f.push(a,c))}for(w=0;w<u;++w)e[w]&&(h[o++]=t[i+w*r],h[o++]=t[i+w*r+1]);return o}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new i(n,"XY")},i.prototype.getType=function(){return"LinearRing"},i.prototype.intersectsExtent=function(){return!1},i.prototype.setCoordinates=function(t,i){this.setLayout(i,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Bn(this.flatCoordinates,0,t,this.stride),this.changed()},i}(sn),hr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),or=function(t){function i(i,n){var r=t.call(this)||this;return r.setCoordinates(i,n),r}return hr(i,t),i.prototype.clone=function(){return new i(this.flatCoordinates.slice(),this.layout)},i.prototype.closestPointXY=function(t,i,n,r){var s=this.flatCoordinates,h=it(t,i,s[0],s[1]);if(h<r){for(var o=this.stride,u=0;u<o;++u)n[u]=s[u];return n.length=o,h}return r},i.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},i.prototype.computeExtent=function(t){return P(n=(i=this.flatCoordinates)[0],r=i[1],n,r,t);var i,n,r},i.prototype.getType=function(){return"Point"},i.prototype.intersectsExtent=function(t){return N(t,this.flatCoordinates[0],this.flatCoordinates[1])},i.prototype.setCoordinates=function(t,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,i,n){for(var r=0,s=n.length;r<s;++r)t[i++]=n[r];return i}(this.flatCoordinates,0,t),this.changed()},i}(sn);function ur(t,i,n,r,s){return!L(s,(function(s){return!er(t,i,n,r,s[0],s[1])}))}function er(t,i,n,r,s,h){for(var o=0,u=t[n-r],e=t[n-r+1];i<n;i+=r){var f=t[i],a=t[i+1];e<=h?a>h&&(f-u)*(h-e)-(s-u)*(a-e)>0&&o++:a<=h&&(f-u)*(h-e)-(s-u)*(a-e)<0&&o--,u=f,e=a}return 0!==o}function fr(t,i,n,r,s,h){if(0===n.length)return!1;if(!er(t,i,n[0],r,s,h))return!1;for(var o=1,u=n.length;o<u;++o)if(er(t,n[o-1],n[o],r,s,h))return!1;return!0}function ar(t,i,n,r,s){var h=C([1/0,1/0,-1/0,-1/0],t,i,n,r);return!!$(s,h)&&(!!S(s,h)||h[0]>=s[0]&&h[2]<=s[2]||h[1]>=s[1]&&h[3]<=s[3]||function(t,i,n,r,s){for(var h,o=[t[i],t[i+1]],u=[];i+r<n;i+=r){if(u[0]=t[i+r],u[1]=t[i+r+1],h=s(o,u))return h;o[0]=u[0],o[1]=u[1]}return!1}(t,i,n,r,(function(t,i){return function(t,i,n){var r=!1,s=E(t,i),h=E(t,n);if(1===s||1===h)r=!0;else{var o=t[0],u=t[1],e=t[2],f=t[3],a=n[0],c=n[1],v=(c-i[1])/(a-i[0]),l=void 0,d=void 0;2&h&&!(2&s)&&(r=(l=a-(c-f)/v)>=o&&l<=e),r||!(4&h)||4&s||(r=(d=c-(a-e)*v)>=u&&d<=f),r||!(8&h)||8&s||(r=(l=a-(c-u)/v)>=o&&l<=e),r||!(16&h)||16&s||(r=(d=c-(a-o)*v)>=u&&d<=f)}return r}(s,t,i)})))}function cr(t,i,n,r){for(;i<n-r;){for(var s=0;s<r;++s){var h=t[i+s];t[i+s]=t[n-r+s],t[n-r+s]=h}i+=r,n-=r}}function vr(t,i,n,r){for(var s=!0,h=0;h<r;++h)if(t[i+h]!==t[n-r+h]){s=!1;break}s&&(n-=r);var o=function(t,i,n,r){for(var s=-1,h=1/0,o=1/0,u=i;u<n;u+=r){var e=t[u],f=t[u+1];f>h||f==h&&e>=o||(s=u,h=f,o=e)}return s}(t,i,n,r),u=o-r;u<i&&(u=n-r);var e=o+r;e>=n&&(e=i);var f=t[u],a=t[u+1],c=t[o],v=t[o+1],l=t[e],d=t[e+1];return c*d+f*v+a*l-(a*c+v*l+f*d)<0}function lr(t,i,n,r,s){for(var h=void 0!==s&&s,o=0,u=n.length;o<u;++o){var e=n[o],f=vr(t,i,e,r);(0===o?h&&f||!h&&!f:h&&!f||!h&&f)&&cr(t,i,e,r),i=e}return i}var dr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pr=function(t){function i(i,n,r){var s=t.call(this)||this;return s.ends_=[],s.flatInteriorPointRevision_=-1,s.flatInteriorPoint_=null,s.maxDelta_=-1,s.maxDeltaRevision_=-1,s.orientedRevision_=-1,s.orientedFlatCoordinates_=null,void 0!==n&&r?(s.setFlatCoordinates(n,i),s.ends_=r):s.setCoordinates(i,n),s}return dr(i,t),i.prototype.appendLinearRing=function(t){this.flatCoordinates?u(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},i.prototype.clone=function(){return new i(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},i.prototype.closestPointXY=function(t,i,n,r){return r<A(this.getExtent(),t,i)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,i,n,r,s){for(var h=0,o=n.length;h<o;++h){var u=n[h];s=Jn(t,i,u,r,s),i=u}return s}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,i,n,r,s,h,o,u,e,f){for(var a=[NaN,NaN],c=0,v=n.length;c<v;++c){var l=n[c];f=$n(t,i,l,r,s,true,o,u,e,f,a),i=l}return f}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,0,t,i,n,r))},i.prototype.containsXY=function(t,i){return fr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,i)},i.prototype.getArea=function(){return function(t,i,n,r){for(var s=0,h=0,o=n.length;h<o;++h){var u=n[h];s+=nr(t,i,u,r),i=u}return s}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},i.prototype.getCoordinates=function(t){var i;return void 0!==t?lr(i=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):i=this.flatCoordinates,tr(i,0,this.ends_,this.stride)},i.prototype.getEnds=function(){return this.ends_},i.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=G(this.getExtent());this.flatInteriorPoint_=function(t,i,n,r,h){for(var o,u,e,f,a,c,v,l=h[1],d=[],p=0,_=n.length;p<_;++p){var m=n[p];for(f=t[m-r],c=t[m-r+1],o=0;o<m;o+=r)a=t[o],v=t[o+1],(l<=c&&v<=l||c<=l&&l<=v)&&d.push(e=(l-c)/(v-c)*(a-f)+f),f=a,c=v}var w=NaN,M=-1/0;for(d.sort(s),f=d[0],o=1,u=d.length;o<u;++o){a=d[o];var g=Math.abs(a-f);g>M&&fr(t,0,n,r,e=(f+a)/2,l)&&(w=e,M=g),f=a}return isNaN(w)&&(w=h[0]),[w,l,M]}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},i.prototype.getInteriorPoint=function(){return new or(this.getFlatInteriorPoint(),"XYM")},i.prototype.getLinearRingCount=function(){return this.ends_.length},i.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new sr(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},i.prototype.getLinearRings=function(){for(var t=this.layout,i=this.flatCoordinates,n=this.ends_,r=[],s=0,h=0,o=n.length;h<o;++h){var u=n[h],e=new sr(i.slice(s,u),t);r.push(e),s=u}return r},i.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,i,n,r){for(var s=0,h=n.length;s<h;++s){var o=n[s],u=vr(t,i,o,r);if(0===s){if(!u)return!1}else if(u)return!1;i=o}return!0}(t,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=lr(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},i.prototype.getSimplifiedGeometryInternal=function(t){var n=[],r=[];return n.length=function(t,i,n,r,s,h,o,u){for(var e=0,f=n.length;e<f;++e){var a=n[e];o=Kn(t,i,a,r,s,h,o),u.push(o),i=a}return o}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,r),new i(n,"XY",r)},i.prototype.getType=function(){return"Polygon"},i.prototype.intersectsExtent=function(t){return function(t,i,n,r,s){if(!function(t,i,n,r,s){return!!(ar(t,i,n,r,s)||er(t,i,n,r,s[0],s[1])||er(t,i,n,r,s[0],s[3])||er(t,i,n,r,s[2],s[1])||er(t,i,n,r,s[2],s[3]))}(t,i,n[0],r,s))return!1;if(1===n.length)return!0;for(var h=1,o=n.length;h<o;++h)if(ur(t,n[h-1],n[h],r,s)&&!ar(t,n[h-1],n[h],r,s))return!1;return!0}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},i.prototype.setCoordinates=function(t,i){this.setLayout(i,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=function(t,i,n,r,s){for(var h=s||[],o=0,u=0,e=n.length;u<e;++u){var f=Bn(t,i,n[u],r);h[o++]=f,i=f}return h.length=o,h}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()},i}(sn);function _r(t){var i=t[0],n=t[1],r=t[2],s=t[3],h=[i,n,i,s,r,s,r,n,i,n];return new pr(h,"XY",[h.length])}var mr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wr=function(t){function i(i){var n=t.call(this)||this,r=dt({},i);return n.hints_=[0,0],n.animations_=[],n.projection_=Zi(r.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.cancelAnchor_=void 0,r.center&&(r.center=r.center),r.extent&&(r.extent=r.extent),n.applyOptions_(r),n}return mr(i,t),i.prototype.applyOptions_=function(t){var i=function(t){var i,n,r,s=void 0!==t.minZoom?t.minZoom:0,o=void 0!==t.maxZoom?t.maxZoom:28,u=void 0!==t.zoomFactor?t.zoomFactor:2,e=void 0!==t.multiWorld&&t.multiWorld,f=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,a=void 0!==t.showFullExtent&&t.showFullExtent,c=Zi(t.projection,"EPSG:3857"),v=c.getExtent(),l=t.constrainOnlyCenter,d=t.extent;if(e||d||!c.isGlobal()||(l=!1,d=v),void 0!==t.resolutions){var p=t.resolutions;n=p[s],r=void 0!==p[o]?p[o]:p[p.length-1],i=t.constrainResolution?function(t,i,n,r){return function(s,o,u,e){if(void 0!==s){var f=t[0],a=t[t.length-1],c=n?Rn(f,n,u,r):f;if(e)return void 0===i||i?Dn(s,c,a):H(s,a,c);var v=Math.min(c,s),l=Math.floor(h(t,v,o));return t[l]>c&&l<t.length-1?t[l+1]:t[l]}}}(p,f,!l&&d,a):Xn(n,r,f,!l&&d,a)}else{var _=(v?Math.max(J(v),Z(v)):360*pi.degrees/c.getMetersPerUnit())/256/Math.pow(2,0),m=_/Math.pow(2,28);void 0!==(n=t.maxResolution)?s=0:n=_/Math.pow(u,s),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(u,o):_/Math.pow(u,o):m),o=s+Math.floor(Math.log(n/r)/Math.log(u)),r=n/Math.pow(u,o-s),i=t.constrainResolution?function(t,i,n,r,s,h){return function(o,u,e,f){if(void 0!==o){var a=s?Rn(i,s,e,h):i,c=void 0!==n?n:0;if(f)return void 0===r||r?Dn(o,a,c):H(o,c,a);var v=Math.ceil(Math.log(i/a)/Math.log(t)-1e-9),l=-u*(.5-1e-9)+.5,d=Math.min(a,o),p=Math.floor(Math.log(i/d)/Math.log(t)+l),_=Math.max(v,p);return H(i/Math.pow(t,_),c,a)}}}(u,n,r,f,!l&&d,a):Xn(n,r,f,!l&&d,a)}return{constraint:i,maxResolution:n,minResolution:r,minZoom:s,zoomFactor:u}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=i.minZoom;var n=function(t){if(void 0!==t.extent)return zn(t.extent,t.constrainOnlyCenter,void 0===t.smoothExtentConstraint||t.smoothExtentConstraint);var i=Zi(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&i.isGlobal()){var n=i.getExtent().slice();return n[0]=-1/0,n[2]=1/0,zn(n,!1,!1)}return Ln}(t),r=i.constraint,s=function(t){if(void 0===t.enableRotation||t.enableRotation){var i=t.constrainRotation;return void 0===i||!0===i?(r=nt(5),function(t,i){return i?t:void 0!==t?Math.abs(t)<=r?0:t:void 0}):!1===i?Yn:"number"==typeof i?(n=2*Math.PI/i,function(t,i){return i?t:void 0!==t?t=Math.floor(t/n+.5)*n:void 0}):Yn}return Gn;var n,r}(t);this.constraints_={center:n,resolution:r,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t},i.prototype.getUpdatedOptions_=function(t){var i=dt({},this.options_);return void 0!==i.resolution?i.resolution=this.getResolution():i.zoom=this.getZoom(),i.center=this.getCenterInternal(),i.rotation=this.getRotation(),dt({},i,t)},i.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var i=new Array(arguments.length),n=0;n<i.length;++n){var r=arguments[n];r.center&&((r=dt({},r)).center=Hi(r.center,this.getProjection())),r.anchor&&((r=dt({},r)).anchor=Hi(r.anchor,this.getProjection())),i[n]=r}this.animateInternal.apply(this,i)},i.prototype.animateInternal=function(t){var i,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(i=arguments[n-1],--n),!this.isDef()){var r=arguments[n-1];return r.center&&this.setCenterInternal(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(i&&Mr(i,!0))}for(var s=Date.now(),h=this.targetCenter_.slice(),o=this.targetResolution_,u=this.targetRotation_,e=[],f=0;f<n;++f){var a=arguments[f],c={start:s,complete:!1,anchor:a.anchor,duration:void 0!==a.duration?a.duration:1e3,easing:a.easing||Un,callback:i};if(a.center&&(c.sourceCenter=h,c.targetCenter=a.center.slice(),h=c.targetCenter),void 0!==a.zoom?(c.sourceResolution=o,c.targetResolution=this.getResolutionForZoom(a.zoom),o=c.targetResolution):a.resolution&&(c.sourceResolution=o,c.targetResolution=a.resolution,o=c.targetResolution),void 0!==a.rotation){c.sourceRotation=u;var v=rt(a.rotation-u+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=u+v,u=c.targetRotation}gr(c)?c.complete=!0:s+=c.duration,e.push(c)}this.animations_.push(e),this.setHint(0,1),this.updateAnimations_()},i.prototype.getAnimating=function(){return this.hints_[0]>0},i.prototype.getInteracting=function(){return this.hints_[1]>0},i.prototype.cancelAnimations=function(){var t;this.setHint(0,-this.hints_[0]);for(var i=0,n=this.animations_.length;i<n;++i){var r=this.animations_[i];if(r[0].callback&&Mr(r[0].callback,!1),!t)for(var s=0,h=r.length;s<h;++s){var o=r[s];if(!o.complete){t=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t},i.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),i=!1,n=this.animations_.length-1;n>=0;--n){for(var r=this.animations_[n],s=!0,h=0,o=r.length;h<o;++h){var u=r[h];if(!u.complete){var e=u.duration>0?(t-u.start)/u.duration:1;e>=1?(u.complete=!0,e=1):s=!1;var f=u.easing(e);if(u.sourceCenter){var a=u.sourceCenter[0],c=u.sourceCenter[1];this.targetCenter_=[a+f*(u.targetCenter[0]-a),c+f*(u.targetCenter[1]-c)]}if(u.sourceResolution&&u.targetResolution){var v=1===f?u.targetResolution:u.sourceResolution+f*(u.targetResolution-u.sourceResolution);if(u.anchor){var l=this.getViewportSize_(this.getRotation()),d=this.constraints_.resolution(v,0,l,!0);this.targetCenter_=this.calculateCenterZoom(d,u.anchor)}this.targetResolution_=v,this.applyTargetState_(!0)}if(void 0!==u.sourceRotation&&void 0!==u.targetRotation){var p=1===f?rt(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+f*(u.targetRotation-u.sourceRotation);if(u.anchor){var _=this.constraints_.rotation(p,!0);this.targetCenter_=this.calculateCenterRotate(_,u.anchor)}this.targetRotation_=p}if(this.applyTargetState_(!0),i=!0,!u.complete)break}}if(s){this.animations_[n]=null,this.setHint(0,-1);var m=r[0].callback;m&&Mr(m,!0)}}this.animations_=this.animations_.filter(Boolean),i&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},i.prototype.calculateCenterRotate=function(t,i){var n,r,s,h=this.getCenterInternal();return void 0!==h&&(zi(n=[h[0]-i[0],h[1]-i[1]],t-this.getRotation()),(r=n)[0]+=+(s=i)[0],r[1]+=+s[1]),n},i.prototype.calculateCenterZoom=function(t,i){var n,r=this.getCenterInternal(),s=this.getResolution();return void 0!==r&&void 0!==s&&(n=[i[0]-t*(i[0]-r[0])/s,i[1]-t*(i[1]-r[1])/s]),n},i.prototype.getViewportSize_=function(t){var i=this.viewportSize_;if(t){var n=i[0],r=i[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return i},i.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},i.prototype.getCenter=function(){var t=this.getCenterInternal();return t?Bi(t,this.getProjection()):t},i.prototype.getCenterInternal=function(){return this.get("center")},i.prototype.getConstraints=function(){return this.constraints_},i.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},i.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},i.prototype.calculateExtent=function(t){return i=this.calculateExtentInternal(t),this.getProjection(),i;var i},i.prototype.calculateExtentInternal=function(t){var i=t||this.getViewportSize_(),n=this.getCenterInternal();w(n,1);var r=this.getResolution();w(void 0!==r,2);var s=this.getRotation();return w(void 0!==s,3),W(n,r,s,i)},i.prototype.getMaxResolution=function(){return this.maxResolution_},i.prototype.getMinResolution=function(){return this.minResolution_},i.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},i.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},i.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},i.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},i.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},i.prototype.getProjection=function(){return this.projection_},i.prototype.getResolution=function(){return this.get("resolution")},i.prototype.getResolutions=function(){return this.resolutions_},i.prototype.getResolutionForExtent=function(t,i){return this.getResolutionForExtentInternal(Ki(t,this.getProjection()),i)},i.prototype.getResolutionForExtentInternal=function(t,i){var n=i||this.getViewportSize_(),r=J(t)/n[0],s=Z(t)/n[1];return Math.max(r,s)},i.prototype.getResolutionForValueFunction=function(t){var i=t||2,n=this.getConstrainedResolution(this.maxResolution_),r=Math.log(n/this.minResolution_)/Math.log(i);return function(t){return n/Math.pow(i,t*r)}},i.prototype.getRotation=function(){return this.get("rotation")},i.prototype.getValueForResolutionFunction=function(t){var i=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=Math.log(n/this.minResolution_)/i;return function(t){return Math.log(n/t)/i/r}},i.prototype.getState=function(){var t=this.getCenterInternal(),i=this.getProjection(),n=this.getResolution(),r=this.getRotation();return{center:t.slice(0),projection:void 0!==i?i:null,resolution:n,rotation:r,zoom:this.getZoom()}},i.prototype.getZoom=function(){var t,i=this.getResolution();return void 0!==i&&(t=this.getZoomForResolution(i)),t},i.prototype.getZoomForResolution=function(t){var i,n,r=this.minZoom_||0;if(this.resolutions_){var s=h(this.resolutions_,t,1);r=s,i=this.resolutions_[s],n=s==this.resolutions_.length-1?2:i/this.resolutions_[s+1]}else i=this.maxResolution_,n=this.zoomFactor_;return r+Math.log(i/t)/Math.log(n)},i.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var i=H(Math.floor(t),0,this.resolutions_.length-2);return this.resolutions_[i]/Math.pow(this.resolutions_[i]/this.resolutions_[i+1],H(t-i,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},i.prototype.fit=function(t,i){var n,r=dt({size:this.getViewportSize_()},i||{});if(w(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))w(!B(t),25),n=_r(s=Ki(t,this.getProjection()));else if("Circle"===t.getType()){var s;(n=_r(s=Ki(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),G(s))}else n=t;this.fitInternal(n,r)},i.prototype.fitInternal=function(t,i){var n=i||{},r=n.size;r||(r=this.getViewportSize_());var s,h=void 0!==n.padding?n.padding:[0,0,0,0],o=void 0!==n.nearest&&n.nearest;s=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.getResolutionForZoom(n.maxZoom):0;for(var u=t.getFlatCoordinates(),e=this.getRotation(),f=Math.cos(-e),a=Math.sin(-e),v=1/0,l=1/0,d=-1/0,p=-1/0,_=t.getStride(),m=0,w=u.length;m<w;m+=_){var M=u[m]*f-u[m+1]*a,g=u[m]*a+u[m+1]*f;v=Math.min(v,M),l=Math.min(l,g),d=Math.max(d,M),p=Math.max(p,g)}var b=this.getResolutionForExtentInternal([v,l,d,p],[r[0]-h[1]-h[3],r[1]-h[0]-h[2]]);b=isNaN(b)?s:Math.max(b,s),b=this.getConstrainedResolution(b,o?0:1);var y=(v+d)/2,O=(l+p)/2,j=[(y+=(h[1]-h[3])/2*b)*f-(O+=(h[0]-h[2])/2*b)*(a=-a),O*f+y*a],x=n.callback?n.callback:c;void 0!==n.duration?this.animateInternal({resolution:b,center:this.getConstrainedCenter(j,b),duration:n.duration,easing:n.easing},x):(this.targetResolution_=b,this.targetCenter_=j,this.applyTargetState_(!1,!0),Mr(x,!0))},i.prototype.centerOn=function(t,i,n){this.centerOnInternal(Hi(t,this.getProjection()),i,n)},i.prototype.centerOnInternal=function(t,i,n){var r=this.getRotation(),s=Math.cos(-r),h=Math.sin(-r),o=t[0]*s-t[1]*h,u=t[1]*s+t[0]*h,e=this.getResolution();this.setCenterInternal([(o+=(i[0]/2-n[0])*e)*s-(u+=(n[1]-i[1]/2)*e)*(h=-h),u*s+o*h])},i.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},i.prototype.adjustCenter=function(t){var i=Bi(this.targetCenter_,this.getProjection());this.setCenter([i[0]+t[0],i[1]+t[1]])},i.prototype.adjustCenterInternal=function(t){var i=this.targetCenter_;this.setCenterInternal([i[0]+t[0],i[1]+t[1]])},i.prototype.adjustResolution=function(t,i){var n=i&&Hi(i,this.getProjection());this.adjustResolutionInternal(t,n)},i.prototype.adjustResolutionInternal=function(t,i){var n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,n);i&&(this.targetCenter_=this.calculateCenterZoom(s,i)),this.targetResolution_*=t,this.applyTargetState_()},i.prototype.adjustZoom=function(t,i){this.adjustResolution(Math.pow(this.zoomFactor_,-t),i)},i.prototype.adjustRotation=function(t,i){i&&(i=Hi(i,this.getProjection())),this.adjustRotationInternal(t,i)},i.prototype.adjustRotationInternal=function(t,i){var n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);i&&(this.targetCenter_=this.calculateCenterRotate(r,i)),this.targetRotation_+=t,this.applyTargetState_()},i.prototype.setCenter=function(t){this.setCenterInternal(Hi(t,this.getProjection()))},i.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},i.prototype.setHint=function(t,i){return this.hints_[t]+=i,this.changed(),this.hints_[t]},i.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},i.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},i.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},i.prototype.applyTargetState_=function(t,i){var n=this.getAnimating()||this.getInteracting()||i,r=this.constraints_.rotation(this.targetRotation_,n),s=this.getViewportSize_(r),h=this.constraints_.resolution(this.targetResolution_,0,s,n),o=this.constraints_.center(this.targetCenter_,h,s,n);this.get("rotation")!==r&&this.set("rotation",r),this.get("resolution")!==h&&this.set("resolution",h),this.get("center")&&Ci(this.get("center"),o)||this.set("center",o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},i.prototype.resolveConstraints=function(t,i,n){var r=void 0!==t?t:200,s=i||0,h=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(h),u=this.constraints_.resolution(this.targetResolution_,s,o),e=this.constraints_.center(this.targetCenter_,u,o);if(0===r&&!this.cancelAnchor_)return this.targetResolution_=u,this.targetRotation_=h,this.targetCenter_=e,void this.applyTargetState_();var f=n||(0===r?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===u&&this.getRotation()===h&&this.getCenterInternal()&&Ci(this.getCenterInternal(),e)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:h,center:e,resolution:u,duration:r,easing:Zn,anchor:f}))},i.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(1,1)},i.prototype.endInteraction=function(t,i,n){var r=n&&Hi(n,this.getProjection());this.endInteractionInternal(t,i,r)},i.prototype.endInteractionInternal=function(t,i,n){this.setHint(1,-1),this.resolveConstraints(t,i,n)},i.prototype.getConstrainedCenter=function(t,i){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,i||this.getResolution(),n)},i.prototype.getConstrainedZoom=function(t,i){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,i))},i.prototype.getConstrainedResolution=function(t,i){var n=i||0,r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,n,r)},i}(kt);function Mr(t,i){setTimeout((function(){t(i)}),0)}function gr(t){return!(t.sourceCenter&&t.targetCenter&&!Ci(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function br(t,i){return Array.isArray(t)?t:(void 0===i?i=[t,t]:(i[0]=t,i[1]=t),i)}var yr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Or=function(t){function i(i){var n=t.call(this)||this,r=function(t){var i=null;void 0!==t.keyboardEventTarget&&(i="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var n,r,s,h={},o=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new jn({layers:t.layers});return h.layergroup=o,h.target=t.target,h.view=void 0!==t.view?t.view:new wr,void 0!==t.controls&&(Array.isArray(t.controls)?n=new yn(t.controls.slice()):(w("function"==typeof t.controls.getArray,47),n=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new yn(t.interactions.slice()):(w("function"==typeof t.interactions.getArray,48),r=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?s=new yn(t.overlays.slice()):(w("function"==typeof t.overlays.getArray,49),s=t.overlays):s=new yn,{controls:n,interactions:r,keyboardEventTarget:i,overlays:s,values:h}}(i);return n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=void 0!==i.maxTilesLoading?i.maxTilesLoading:16,n.pixelRatio_=void 0!==i.pixelRatio?i.pixelRatio:Gt,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=[1,0,0,1,0,0],n.pixelToCoordinateTransform_=[1,0,0,1,0,0],n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.style.pointerEvents="none",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.style.pointerEvents="none",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=null,n.moveTolerance_=i.moveTolerance,n.keyboardEventTarget_=r.keyboardEventTarget,n.keyHandlerKeys_=null,n.controls=r.controls||new yn,n.interactions=r.interactions||new yn,n.overlays_=r.overlays,n.overlayIdIndex_={},n.renderer_=null,n.postRenderFunctions_=[],n.tileQueue_=new Cn(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addEventListener(Nt("layergroup"),n.handleLayerGroupChanged_),n.addEventListener(Nt("view"),n.handleViewChanged_),n.addEventListener(Nt("size"),n.handleSizeChanged_),n.addEventListener(Nt("target"),n.handleTargetChanged_),n.setProperties(r.values),n.controls.forEach(function(t){t.setMap(this)}.bind(n)),n.controls.addEventListener("add",function(t){t.element.setMap(this)}.bind(n)),n.controls.addEventListener("remove",function(t){t.element.setMap(null)}.bind(n)),n.interactions.forEach(function(t){t.setMap(this)}.bind(n)),n.interactions.addEventListener("add",function(t){t.element.setMap(this)}.bind(n)),n.interactions.addEventListener("remove",function(t){t.element.setMap(null)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n.overlays_.addEventListener("add",function(t){this.addOverlayInternal_(t.element)}.bind(n)),n.overlays_.addEventListener("remove",function(t){var i=t.element.getId();void 0!==i&&delete this.overlayIdIndex_[i.toString()],t.element.setMap(null)}.bind(n)),n}return yr(i,t),i.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},i.prototype.addControl=function(t){this.getControls().push(t)},i.prototype.addInteraction=function(t){this.getInteractions().push(t)},i.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},i.prototype.addOverlay=function(t){this.getOverlays().push(t)},i.prototype.addOverlayInternal_=function(t){var i=t.getId();void 0!==i&&(this.overlayIdIndex_[i.toString()]=t),t.setMap(this)},i.prototype.disposeInternal=function(){this.setTarget(null),t.prototype.disposeInternal.call(this)},i.prototype.forEachFeatureAtPixel=function(t,i,n){if(this.frameState_){var r=this.getCoordinateFromPixelInternal(t);return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance*this.frameState_.pixelRatio:0,!1!==n.checkWrapped,i,null,void 0!==n.layerFilter?n.layerFilter:f,null)}},i.prototype.getFeaturesAtPixel=function(t,i){var n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),i),n},i.prototype.forEachLayerAtPixel=function(t,i,n){if(this.frameState_){var r=n||{};return this.renderer_.forEachLayerAtPixel(t,this.frameState_,void 0!==r.hitTolerance?r.hitTolerance*this.frameState_.pixelRatio:0,i,r.layerFilter||f)}},i.prototype.hasFeatureAtPixel=function(t,i){if(!this.frameState_)return!1;var n=this.getCoordinateFromPixelInternal(t);return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,!1!==i.checkWrapped,void 0!==i.layerFilter?i.layerFilter:f,null)},i.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},i.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},i.prototype.getEventPixel=function(t){var i=this.viewport_.getBoundingClientRect(),n="changedTouches"in t?t.changedTouches[0]:t;return[n.clientX-i.left,n.clientY-i.top]},i.prototype.getTarget=function(){return this.get("target")},i.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},i.prototype.getCoordinateFromPixel=function(t){return Bi(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},i.prototype.getCoordinateFromPixelInternal=function(t){var i=this.frameState_;return i?M(i.pixelToCoordinateTransform,t.slice()):null},i.prototype.getControls=function(){return this.controls},i.prototype.getOverlays=function(){return this.overlays_},i.prototype.getOverlayById=function(t){var i=this.overlayIdIndex_[t.toString()];return void 0!==i?i:null},i.prototype.getInteractions=function(){return this.interactions},i.prototype.getLayerGroup=function(){return this.get("layergroup")},i.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},i.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),i=0,n=t.length;i<n;++i){var r=t[i].layer.getSource();if(r&&r.loading)return!0}return!1},i.prototype.getPixelFromCoordinate=function(t){var i=Hi(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(i)},i.prototype.getPixelFromCoordinateInternal=function(t){var i=this.frameState_;return i?M(i.coordinateToPixelTransform,t.slice(0,2)):null},i.prototype.getRenderer=function(){return this.renderer_},i.prototype.getSize=function(){return this.get("size")},i.prototype.getView=function(){return this.get("view")},i.prototype.getViewport=function(){return this.viewport_},i.prototype.getOverlayContainer=function(){return this.overlayContainer_},i.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},i.prototype.getTilePriority=function(t,i,n,r){return function(t,i,n,r,s){if(!t||!(n in t.wantedTiles))return Tn;if(!t.wantedTiles[n][i.getKey()])return Tn;var h=t.viewState.center,o=r[0]-h[0],u=r[1]-h[1];return 65536*Math.log(s)+Math.sqrt(o*o+u*u)/s}(this.frameState_,t,i,n,r)},i.prototype.handleBrowserEvent=function(t,i){var n=new Sn(i||t.type,this,t);this.handleMapBrowserEvent(n)},i.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){var i=t.originalEvent,n=i.type;if("pointerdown"===n||"wheel"===n||"keydown"===n){var r=this.viewport_.getRootNode?this.viewport_.getRootNode():document,s=r===document?i.target:r.elementFromPoint(i.clientX,i.clientY);if(this.overlayContainerStopEvent_.contains(s)||!(r===document?document.documentElement:r).contains(s))return}t.frameState=this.frameState_;var h=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var o=h.length-1;o>=0;o--){var u=h[o];if(u.getActive()&&!u.handleEvent(t))break}}},i.prototype.handlePostRender=function(){var t=this.frameState_,i=this.tileQueue_;if(!i.isEmpty()){var n=this.maxTilesLoading_,r=n;if(t){var s=t.viewHints;if(s[0]||s[1]){var h=!Wt&&Date.now()-t.time>8;n=h?0:8,r=h?0:2}}i.getTilesLoading()<n&&(i.reprioritize(),i.loadMoreTiles(n,r))}!t||!this.hasListener("rendercomplete")||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent("rendercomplete",t);for(var o=this.postRenderFunctions_,u=0,e=o.length;u<e;++u)o[u](this,t);o.length=0},i.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},i.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.mapBrowserEventHandler_){for(var i=0,n=this.keyHandlerKeys_.length;i<n;++i)yt(this.keyHandlerKeys_[i]);this.keyHandlerKeys_=null,this.viewport_.removeEventListener("contextmenu",this.boundHandleBrowserEvent_),this.viewport_.removeEventListener("wheel",this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener("resize",this.handleResize_,!1),this.handleResize_=void 0),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Vt(this.viewport_)}if(t){for(var r in t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new Pn(this,this.moveTolerance_),Nn)this.mapBrowserEventHandler_.addEventListener(Nn[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener("contextmenu",this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener("wheel",this.boundHandleBrowserEvent_,!!Zt&&{passive:!1});var s=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[gt(s,"keydown",this.handleBrowserEvent,this),gt(s,"keypress",this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener("resize",this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()},i.prototype.handleTileChange_=function(){this.render()},i.prototype.handleViewPropertyChanged_=function(){this.render()},i.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(yt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(yt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=gt(t,"propertychange",this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=gt(t,"change",this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},i.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(yt),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[gt(t,"propertychange",this.render,this),gt(t,"change",this.render,this)]),this.render()},i.prototype.isRendered=function(){return!!this.frameState_},i.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},i.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),i=0,n=t.length;i<n;++i){var r=t[i].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}},i.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},i.prototype.removeControl=function(t){return this.getControls().remove(t)},i.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},i.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},i.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},i.prototype.renderFrame_=function(t){var i=this.getSize(),n=this.getView(),r=this.frameState_,s=null;if(void 0!==i&&function(t){return t[0]>0&&t[1]>0}(i)&&n&&n.isDef()){var h=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=n.getState();s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:r?r.declutterItems:[],extent:W(o.center,o.resolution,o.rotation,i),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:o,viewHints:h,wantedTiles:{}}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!B(this.previousExtent_)&&!I(s.extent,this.previousExtent_))&&(this.dispatchEvent(new An("movestart",this,r)),this.previousExtent_=T(this.previousExtent_)),this.previousExtent_&&!s.viewHints[0]&&!s.viewHints[1]&&!I(s.extent,this.previousExtent_)&&(this.dispatchEvent(new An("moveend",this,s)),x(s.extent,this.previousExtent_))),this.dispatchEvent(new An("postrender",this,s)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},i.prototype.setLayerGroup=function(t){this.set("layergroup",t)},i.prototype.setSize=function(t){this.set("size",t)},i.prototype.setTarget=function(t){this.set("target",t)},i.prototype.setView=function(t){this.set("view",t)},i.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var i=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth)])}else this.setSize(void 0);this.updateViewportSize_()},i.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var i=void 0,n=getComputedStyle(this.viewport_);n.width&&n.height&&(i=[parseInt(n.width,10),parseInt(n.height,10)]),t.setViewportSize(i)}},i}(kt),jr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xr=function(t){function i(i){var n=t.call(this)||this,r=i.element;return!r||i.target||r.style.pointerEvents||(r.style.pointerEvents="auto"),n.element=r||null,n.target_=null,n.map_=null,n.listenerKeys=[],i.render&&(n.render=i.render),i.target&&n.setTarget(i.target),n}return jr(i,t),i.prototype.disposeInternal=function(){Vt(this.element),t.prototype.disposeInternal.call(this)},i.prototype.getMap=function(){return this.map_},i.prototype.setMap=function(t){this.map_&&Vt(this.element);for(var i=0,n=this.listenerKeys.length;i<n;++i)yt(this.listenerKeys[i]);this.listenerKeys.length=0,this.map_=t,this.map_&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==c&&this.listenerKeys.push(gt(t,"postrender",this.render,this)),t.render())},i.prototype.render=function(){},i.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},i}(kt),Ar=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kr=function(t){function i(i){var n=this,r=i||{};(n=t.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this).ulElement_=document.createElement("ul"),n.collapsed_=void 0===r.collapsed||r.collapsed,n.overrideCollapsible_=void 0!==r.collapsible,n.collapsible_=void 0===r.collapsible||r.collapsible,n.collapsible_||(n.collapsed_=!1);var s=void 0!==r.className?r.className:"ol-attribution",h=void 0!==r.tipLabel?r.tipLabel:"Attributions",o=void 0!==r.collapseLabel?r.collapseLabel:"»";"string"==typeof o?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=o):n.collapseLabel_=o;var u=void 0!==r.label?r.label:"i";"string"==typeof u?(n.label_=document.createElement("span"),n.label_.textContent=u):n.label_=u;var e=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_,f=document.createElement("button");f.setAttribute("type","button"),f.title=h,f.appendChild(e),f.addEventListener("click",n.handleClick_.bind(n),!1);var a=n.element;return a.className=s+" ol-unselectable ol-control"+(n.collapsed_&&n.collapsible_?" ol-collapsed":"")+(n.collapsible_?"":" ol-uncollapsible"),a.appendChild(n.ulElement_),a.appendChild(f),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return Ar(i,t),i.prototype.collectSourceAttributions_=function(t){for(var i={},n=[],r=t.layerStatesArray,s=0,h=r.length;s<h;++s){var o=r[s];if(Ft(o,t.viewState)){var u=o.layer.getSource();if(u){var e=u.getAttributions();if(e){var f=e(t);if(f)if(this.overrideCollapsible_||!1!==u.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(f))for(var a=0,c=f.length;a<c;++a)f[a]in i||(n.push(f[a]),i[f[a]]=!0);else f in i||(n.push(f),i[f]=!0)}}}}return n},i.prototype.updateElement_=function(t){if(t){var i=this.collectSourceAttributions_(t),n=i.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!e(i,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(var r=0,s=i.length;r<s;++r){var h=document.createElement("li");h.innerHTML=i[r],this.ulElement_.appendChild(h)}this.renderedAttributions_=i}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},i.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},i.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?qt(this.collapseLabel_,this.label_):qt(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},i.prototype.getCollapsible=function(){return this.collapsible_},i.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},i.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},i.prototype.getCollapsed=function(){return this.collapsed_},i.prototype.render=function(t){this.updateElement_(t.frameState)},i}(xr),Sr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nr=function(t){function i(i){var n=this,r=i||{};n=t.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this;var s=void 0!==r.className?r.className:"ol-rotate",h=void 0!==r.label?r.label:"⇧";n.label_=null,"string"==typeof h?(n.label_=document.createElement("span"),n.label_.className="ol-compass",n.label_.textContent=h):(n.label_=h,n.label_.classList.add("ol-compass"));var o=r.tipLabel?r.tipLabel:"Reset rotation",u=document.createElement("button");u.className=s+"-reset",u.setAttribute("type","button"),u.title=o,u.appendChild(n.label_),u.addEventListener("click",n.handleClick_.bind(n),!1);var e=n.element;return e.className=s+" ol-unselectable ol-control",e.appendChild(u),n.callResetNorth_=r.resetNorth?r.resetNorth:void 0,n.duration_=void 0!==r.duration?r.duration:250,n.autoHide_=void 0===r.autoHide||r.autoHide,n.rotation_=void 0,n.autoHide_&&n.element.classList.add("ol-hidden"),n}return Sr(i,t),i.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},i.prototype.resetNorth_=function(){var t=this.getMap().getView();if(t){var i=t.getRotation();void 0!==i&&(this.duration_>0&&i%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Zn}):t.setRotation(0))}},i.prototype.render=function(t){var i=t.frameState;if(i){var n=i.viewState.rotation;if(n!=this.rotation_){var r="rotate("+n+"rad)";if(this.autoHide_){var s=this.element.classList.contains("ol-hidden");s||0!==n?s&&0!==n&&this.element.classList.remove("ol-hidden"):this.element.classList.add("ol-hidden")}this.label_.style.transform=r}this.rotation_=n}},i}(xr),Er=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pr=function(t){function i(i){var n=this,r=i||{};n=t.call(this,{element:document.createElement("div"),target:r.target})||this;var s=void 0!==r.className?r.className:"ol-zoom",h=void 0!==r.delta?r.delta:1,o=void 0!==r.zoomInLabel?r.zoomInLabel:"+",u=void 0!==r.zoomOutLabel?r.zoomOutLabel:"−",e=void 0!==r.zoomInTipLabel?r.zoomInTipLabel:"Zoom in",f=void 0!==r.zoomOutTipLabel?r.zoomOutTipLabel:"Zoom out",a=document.createElement("button");a.className=s+"-in",a.setAttribute("type","button"),a.title=e,a.appendChild("string"==typeof o?document.createTextNode(o):o),a.addEventListener("click",n.handleClick_.bind(n,h),!1);var c=document.createElement("button");c.className=s+"-out",c.setAttribute("type","button"),c.title=f,c.appendChild("string"==typeof u?document.createTextNode(u):u),c.addEventListener("click",n.handleClick_.bind(n,-h),!1);var v=n.element;return v.className=s+" ol-unselectable ol-control",v.appendChild(a),v.appendChild(c),n.duration_=void 0!==r.duration?r.duration:250,n}return Er(i,t),i.prototype.handleClick_=function(t,i){i.preventDefault(),this.zoomByDelta_(t)},i.prototype.zoomByDelta_=function(t){var i=this.getMap().getView();if(i){var n=i.getZoom();if(void 0!==n){var r=i.getConstrainedZoom(n+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:r,duration:this.duration_,easing:Zn})):i.setZoom(r)}}},i}(xr);var Tr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ir=function(t){function i(i){var n=t.call(this)||this;return i&&i.handleEvent&&(n.handleEvent=i.handleEvent),n.map_=null,n.setActive(!0),n}return Tr(i,t),i.prototype.getActive=function(){return this.get("active")},i.prototype.getMap=function(){return this.map_},i.prototype.handleEvent=function(){return!0},i.prototype.setActive=function(t){this.set("active",t)},i.prototype.setMap=function(t){this.map_=t},i}(kt);function Fr(t,i,n,r){var s=t.getZoom();if(void 0!==s){var h=t.getConstrainedZoom(s+i),o=t.getResolutionForZoom(h);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:void 0!==r?r:250,easing:Zn})}}var Cr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zr=function(t){function i(i){var n=t.call(this)||this,r=i||{};return n.delta_=r.delta?r.delta:1,n.duration_=void 0!==r.duration?r.duration:250,n}return Cr(i,t),i.prototype.handleEvent=function(t){var i=!1;if(t.type==Nn.DBLCLICK){var n=t.coordinate,r=t.originalEvent.shiftKey?-this.delta_:this.delta_;Fr(t.map.getView(),r,n,this.duration_),t.preventDefault(),i=!0}return!i},i}(Ir),Lr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rr=function(t){function i(i){var n=this,r=i||{};return n=t.call(this,r)||this,r.handleDownEvent&&(n.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(n.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(n.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(n.handleUpEvent=r.handleUpEvent),r.stopDown&&(n.stopDown=r.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return Lr(i,t),i.prototype.getPointerCount=function(){return this.targetPointers.length},i.prototype.handleDownEvent=function(){return!1},i.prototype.handleDragEvent=function(){},i.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var i=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Nn.POINTERDRAG)this.handleDragEvent(t),t.preventDefault();else if(t.type==Nn.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==Nn.POINTERDOWN){var r=this.handleDownEvent(t);this.handlingDownUpSequence=r,i=this.stopDown(r)}else t.type==Nn.POINTERMOVE&&this.handleMoveEvent(t);return!i},i.prototype.handleMoveEvent=function(){},i.prototype.handleUpEvent=function(){return!1},i.prototype.stopDown=function(t){return t},i.prototype.updateTrackedPointers_=function(t){if(function(t){var i=t.type;return i===Nn.POINTERDOWN||i===Nn.POINTERDRAG||i===Nn.POINTERUP}(t)){var i=t.originalEvent,n=i.pointerId.toString();t.type==Nn.POINTERUP?delete this.trackedPointers_[n]:(t.type==Nn.POINTERDOWN||n in this.trackedPointers_)&&(this.trackedPointers_[n]=i),this.targetPointers=_t(this.trackedPointers_)}},i}(Ir);function Dr(t){for(var i=t.length,n=0,r=0,s=0;s<i;s++)n+=t[s].clientX,r+=t[s].clientY;return[n/i,r/i]}function Xr(t){var i=arguments;return function(t){for(var n=!0,r=0,s=i.length;r<s&&(n=n&&i[r](t));++r);return n}}var Gr=function(t){var i=t.originalEvent;return i.altKey&&!(i.metaKey||i.ctrlKey)&&i.shiftKey},Yr=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){return t.target.getTargetElement().contains(document.activeElement)}(t)},Wr=f,Zr=function(t){var i=t.originalEvent;return 0==i.button&&!(Dt&&Xt&&i.ctrlKey)},Ur=function(t){var i=t.originalEvent;return!i.altKey&&!(i.metaKey||i.ctrlKey)&&!i.shiftKey},qr=function(t){var i=t.originalEvent;return!i.altKey&&!(i.metaKey||i.ctrlKey)&&i.shiftKey},Vr=function(t){var i=t.originalEvent.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i},Jr=function(t){var i=t.originalEvent;return w(void 0!==i,56),"mouse"==i.pointerType},$r=function(t){var i=t.originalEvent;return w(void 0!==i,56),i.isPrimary&&0===i.button},Br=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hr=function(t){function i(i){var n=t.call(this,{stopDown:a})||this,r=i||{};n.kinetic_=r.kinetic,n.lastCentroid=null,n.panning_=!1;var s=r.condition?r.condition:Xr(Ur,$r);return n.condition_=r.onFocusOnly?Xr(Yr,s):s,n.noKinetic_=!1,n}return Br(i,t),i.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var i,n,r=this.targetPointers,s=Dr(r);if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(s[0],s[1]),this.lastCentroid){var h=[this.lastCentroid[0]-s[0],s[1]-this.lastCentroid[1]],o=t.map.getView();i=h,n=o.getResolution(),i[0]*=n,i[1]*=n,zi(h,o.getRotation()),o.adjustCenterInternal(h)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=s,this.lastPointersCount_=r.length,t.originalEvent.preventDefault()},i.prototype.handleUpEvent=function(t){var i=t.map,n=i.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),h=n.getCenterInternal(),o=i.getPixelFromCoordinateInternal(h),u=i.getCoordinateFromPixelInternal([o[0]-r*Math.cos(s),o[1]-r*Math.sin(s)]);n.animateInternal({center:n.getConstrainedCenter(u),duration:500,easing:Zn})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},i.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},i}(Rr),Kr=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qr=function(t){function i(i){var n=this,r=i||{};return(n=t.call(this,{stopDown:a})||this).condition_=r.condition?r.condition:Gr,n.lastAngle_=void 0,n.duration_=void 0!==r.duration?r.duration:250,n}return Kr(i,t),i.prototype.handleDragEvent=function(t){if(Jr(t)){var i=t.map,n=i.getView();if(n.getConstraints().rotation!==Gn){var r=i.getSize(),s=t.pixel,h=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);void 0!==this.lastAngle_&&n.adjustRotationInternal(-(h-this.lastAngle_)),this.lastAngle_=h}}},i.prototype.handleUpEvent=function(t){return!Jr(t)||(t.map.getView().endInteraction(this.duration_),!1)},i.prototype.handleDownEvent=function(t){return!(!Jr(t)||!Zr(t)||!this.condition_(t)||(t.map.getView().beginInteraction(),this.lastAngle_=void 0,0))},i}(Rr),ts=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),is=function(t){function i(i){var n=t.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.style.pointerEvents="auto",n.element_.className="ol-box "+i,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return ts(i,t),i.prototype.disposeInternal=function(){this.setMap(null)},i.prototype.render_=function(){var t=this.startPixel_,i=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(t[0],i[0])+n,r.top=Math.min(t[1],i[1])+n,r.width=Math.abs(i[0]-t[0])+n,r.height=Math.abs(i[1]-t[1])+n},i.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var i=this.element_.style;i.left="inherit",i.top="inherit",i.width="inherit",i.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},i.prototype.setPixels=function(t,i){this.startPixel_=t,this.endPixel_=i,this.createOrUpdateGeometry(),this.render_()},i.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,i=this.endPixel_,n=[t,[t[0],i[1]],i,[i[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new pr([n])},i.prototype.getGeometry=function(){return this.geometry_},i}(r),ns=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rs=function(t){function i(i,n,r){var s=t.call(this,i)||this;return s.coordinate=n,s.mapBrowserEvent=r,s}return ns(i,t),i}(lt),ss=function(t){function i(i){var n=t.call(this)||this,r=i||{};return n.box_=new is(r.className||"ol-dragbox"),n.minArea_=void 0!==r.minArea?r.minArea:64,r.onBoxEnd&&(n.onBoxEnd=r.onBoxEnd),n.startPixel_=null,n.condition_=r.condition?r.condition:Zr,n.boxEndCondition_=r.boxEndCondition?r.boxEndCondition:n.defaultBoxEndCondition,n}return ns(i,t),i.prototype.defaultBoxEndCondition=function(t,i,n){var r=n[0]-i[0],s=n[1]-i[1];return r*r+s*s>=this.minArea_},i.prototype.getGeometry=function(){return this.box_.getGeometry()},i.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new rs("boxdrag",t.coordinate,t))},i.prototype.handleUpEvent=function(t){return this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd(t),this.dispatchEvent(new rs("boxend",t.coordinate,t))),!1},i.prototype.handleDownEvent=function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new rs("boxstart",t.coordinate,t)),!0)},i.prototype.onBoxEnd=function(){},i}(Rr),hs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),os=function(t){function i(i){var n=this,r=i||{};return(n=t.call(this,{condition:r.condition?r.condition:qr,className:r.className||"ol-dragzoom",minArea:r.minArea})||this).duration_=void 0!==r.duration?r.duration:200,n.out_=void 0!==r.out&&r.out,n}return hs(i,t),i.prototype.onBoxEnd=function(){var t=this.getMap(),i=t.getView(),n=t.getSize(),r=this.getGeometry().getExtent();if(this.out_){var s=i.calculateExtentInternal(n),h=function(t,i){return function(t,i){for(var n=0,r=i.length;n<r;++n)F(t,i[n]);return t}(T(i),t)}([t.getPixelFromCoordinateInternal(D(r)),t.getPixelFromCoordinateInternal(V(r))]);!function(t,i){var n=(t[2]-t[0])/2*(i-1),r=(t[3]-t[1])/2*(i-1);t[0]-=n,t[2]+=n,t[1]-=r,t[3]+=r}(s,1/i.getResolutionForExtentInternal(h,n)),r=s}var o=i.getConstrainedResolution(i.getResolutionForExtentInternal(r,n)),u=i.getConstrainedCenter(G(r),o);i.animateInternal({resolution:o,center:u,duration:this.duration_,easing:Zn})},i}(ss);var us=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),es=function(t){function i(i){var n=t.call(this)||this,r=i||{};return n.defaultCondition_=function(t){return Ur(t)&&Vr(t)},n.condition_=void 0!==r.condition?r.condition:n.defaultCondition_,n.duration_=void 0!==r.duration?r.duration:100,n.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,n}return us(i,t),i.prototype.handleEvent=function(t){var i=!1;if("keydown"==t.type){var n=t.originalEvent.keyCode;if(this.condition_(t)&&(40==n||37==n||39==n||38==n)){var r=t.map.getView(),s=r.getResolution()*this.pixelDelta_,h=0,o=0;40==n?o=-s:37==n?h=-s:39==n?h=s:o=s;var u=[h,o];zi(u,r.getRotation()),function(t,i,n){var r=t.getCenterInternal();r&&t.animateInternal({duration:void 0!==n?n:250,easing:qn,center:t.getConstrainedCenter([r[0]+i[0],r[1]+i[1]])})}(r,u,this.duration_),t.preventDefault(),i=!0}}return!i},i}(Ir),fs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),as=function(t){function i(i){var n=t.call(this)||this,r=i||{};return n.condition_=r.condition?r.condition:Vr,n.delta_=r.delta?r.delta:1,n.duration_=void 0!==r.duration?r.duration:100,n}return fs(i,t),i.prototype.handleEvent=function(t){var i=!1;if("keydown"==t.type||"keypress"==t.type){var n=t.originalEvent.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var r=t.map,s=n=="+".charCodeAt(0)?this.delta_:-this.delta_;Fr(r.getView(),s,void 0,this.duration_),t.preventDefault(),i=!0}}return!i},i}(Ir),cs=function(){function t(t,i,n){this.decay_=t,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,i){this.points_.push(t,i,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,i=this.points_.length-3;if(this.points_[i+2]<t)return!1;for(var n=i-3;n>0&&this.points_[n+2]>t;)n-=3;var r=this.points_[i+2]-this.points_[n+2];if(r<1e3/60)return!1;var s=this.points_[i]-this.points_[n],h=this.points_[i+1]-this.points_[n+1];return this.angle_=Math.atan2(h,s),this.initialVelocity_=Math.sqrt(s*s+h*h)/r,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}(),vs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ls=function(t){function i(i){var n=this,r=i||{};(n=t.call(this,r)||this).totalDelta_=0,n.lastDelta_=0,n.maxDelta_=void 0!==r.maxDelta?r.maxDelta:1,n.duration_=void 0!==r.duration?r.duration:250,n.timeout_=void 0!==r.timeout?r.timeout:80,n.useAnchor_=void 0===r.useAnchor||r.useAnchor,n.constrainResolution_=void 0!==r.constrainResolution&&r.constrainResolution;var s=r.condition?r.condition:Wr;return n.condition_=r.onFocusOnly?Xr(Yr,s):s,n.lastAnchor_=null,n.startTime_=void 0,n.mode_=void 0,n.trackpadEventGap_=400,n.deltaPerZoom_=300,n}return vs(i,t),i.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},i.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if("wheel"!==t.type)return!0;t.preventDefault();var i,n=t.map,r=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),"wheel"==t.type&&(i=r.deltaY,Rt&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=Gt),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)),0===i)return!1;this.lastDelta_=i;var s=Date.now();void 0===this.startTime_&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?"trackpad":"wheel");var h=n.getView();if("trackpad"===this.mode_&&!h.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(h.getAnimating()&&h.cancelAnimations(),h.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),h.adjustZoom(-i/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=s,!1;this.totalDelta_+=i;var o=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),o),!1},i.prototype.handleWheelZoom_=function(t){var i=t.getView();i.getAnimating()&&i.cancelAnimations();var n=-H(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(i.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Fr(i,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},i.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},i}(Ir),ds=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ps=function(t){function i(i){var n=this,r=i||{},s=r;return s.stopDown||(s.stopDown=a),(n=t.call(this,s)||this).anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=void 0!==r.threshold?r.threshold:.3,n.duration_=void 0!==r.duration?r.duration:250,n}return ds(i,t),i.prototype.handleDragEvent=function(t){var i=0,n=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(void 0!==this.lastAngle_){var h=s-this.lastAngle_;this.rotationDelta_+=h,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),i=h}this.lastAngle_=s;var o=t.map,u=o.getView();if(u.getConstraints().rotation!==Gn){var e=o.getViewport().getBoundingClientRect(),f=Dr(this.targetPointers);f[0]-=e.left,f[1]-=e.top,this.anchor_=o.getCoordinateFromPixelInternal(f),this.rotating_&&(o.render(),u.adjustRotationInternal(i,this.anchor_))}},i.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))},i.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var i=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||i.getView().beginInteraction(),!0}return!1},i}(Rr),_s=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ms=function(t){function i(i){var n=this,r=i||{},s=r;return s.stopDown||(s.stopDown=a),(n=t.call(this,s)||this).anchor_=null,n.duration_=void 0!==r.duration?r.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return _s(i,t),i.prototype.handleDragEvent=function(t){var i=1,n=this.targetPointers[0],r=this.targetPointers[1],s=n.clientX-r.clientX,h=n.clientY-r.clientY,o=Math.sqrt(s*s+h*h);void 0!==this.lastDistance_&&(i=this.lastDistance_/o),this.lastDistance_=o;var u=t.map,e=u.getView();1!=i&&(this.lastScaleDelta_=i);var f=u.getViewport().getBoundingClientRect(),a=Dr(this.targetPointers);a[0]-=f.left,a[1]-=f.top,this.anchor_=u.getCoordinateFromPixelInternal(a),u.render(),e.adjustResolutionInternal(i,this.anchor_)},i.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_,this.lastScaleDelta_>1?1:-1),1))},i.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var i=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||i.getView().beginInteraction(),!0}return!1},i}(Rr),ws=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ms=function(t){function i(i){var n=t.call(this)||this;return n.id_=void 0,n.geometryName_="geometry",n.style_=null,n.styleFunction_=void 0,n.geometryChangeKey_=null,n.addEventListener(Nt(n.geometryName_),n.handleGeometryChanged_),i&&("function"==typeof i.getSimplifiedGeometry?n.setGeometry(i):n.setProperties(i)),n}return ws(i,t),i.prototype.clone=function(){var t=new i(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var n=this.getGeometry();n&&t.setGeometry(n.clone());var r=this.getStyle();return r&&t.setStyle(r),t},i.prototype.getGeometry=function(){return this.get(this.geometryName_)},i.prototype.getId=function(){return this.id_},i.prototype.getGeometryName=function(){return this.geometryName_},i.prototype.getStyle=function(){return this.style_},i.prototype.getStyleFunction=function(){return this.styleFunction_},i.prototype.handleGeometryChange_=function(){this.changed()},i.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(yt(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=gt(t,"change",this.handleGeometryChange_,this)),this.changed()},i.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},i.prototype.setStyle=function(t){var i,n;this.style_=t,this.styleFunction_=t?"function"==typeof(i=t)?i:(Array.isArray(i)?n=i:(w("function"==typeof i.getZIndex,41),n=[i]),function(){return n}):void 0,this.changed()},i.prototype.setId=function(t){this.id_=t,this.changed()},i.prototype.setGeometryName=function(t){this.removeEventListener(Nt(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=t,this.addEventListener(Nt(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},i}(kt);function gs(t,i,n,r){for(var s=t[i],h=t[i+1],o=0,u=i+r;u<n;u+=r){var e=t[u],f=t[u+1];o+=Math.sqrt((e-s)*(e-s)+(f-h)*(f-h)),s=e,h=f}return o}var bs=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=br(t.scale),this.displacement_=t.displacement}return t.prototype.clone=function(){var i=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(i)?i.slice():i,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getScaleArray=function(){return this.scaleArray_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return v()},t.prototype.getImage=function(){return v()},t.prototype.getHitDetectionImage=function(){return v()},t.prototype.getPixelRatio=function(){return 1},t.prototype.getImageState=function(){return v()},t.prototype.getImageSize=function(){return v()},t.prototype.getHitDetectionImageSize=function(){return v()},t.prototype.getOrigin=function(){return v()},t.prototype.getSize=function(){return v()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=br(t)},t.prototype.listenImageChange=function(){v()},t.prototype.load=function(){v()},t.prototype.unlistenImageChange=function(){v()},t}(),ys=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Os=function(t){function i(i){var n=this;return(n=t.call(this,{opacity:1,rotateWithView:void 0!==i.rotateWithView&&i.rotateWithView,rotation:void 0!==i.rotation?i.rotation:0,scale:1,displacement:void 0!==i.displacement?i.displacement:[0,0]})||this).canvas_={},n.hitDetectionCanvas_=null,n.fill_=void 0!==i.fill?i.fill:null,n.origin_=[0,0],n.points_=i.points,n.radius_=void 0!==i.radius?i.radius:i.radius1,n.radius2_=i.radius2,n.angle_=void 0!==i.angle?i.angle:0,n.stroke_=void 0!==i.stroke?i.stroke:null,n.anchor_=null,n.size_=null,n.imageSize_=null,n.hitDetectionImageSize_=null,n.render(),n}return ys(i,t),i.prototype.clone=function(){var t=new i({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},i.prototype.getAnchor=function(){return this.anchor_},i.prototype.getAngle=function(){return this.angle_},i.prototype.getFill=function(){return this.fill_},i.prototype.getHitDetectionImage=function(){if(!this.hitDetectionCanvas_){var t=this.createRenderOptions();this.createHitDetectionCanvas_(t)}return this.hitDetectionCanvas_},i.prototype.getImage=function(t){if(!this.canvas_[t||1]){var i=this.createRenderOptions(),n=Ut(i.size*t||1,i.size*t||1);this.draw_(i,n,0,0,t||1),this.canvas_[t||1]=n.canvas}return this.canvas_[t||1]},i.prototype.getPixelRatio=function(t){return t},i.prototype.getImageSize=function(){return this.imageSize_},i.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},i.prototype.getImageState=function(){return 2},i.prototype.getOrigin=function(){return this.origin_},i.prototype.getPoints=function(){return this.points_},i.prototype.getRadius=function(){return this.radius_},i.prototype.getRadius2=function(){return this.radius2_},i.prototype.getSize=function(){return this.size_},i.prototype.getStroke=function(){return this.stroke_},i.prototype.listenImageChange=function(){},i.prototype.load=function(){},i.prototype.unlistenImageChange=function(){},i.prototype.createRenderOptions=function(){var t,i="round",n="round",r=0,s=null,h=0,o=0;return this.stroke_&&(null===(t=this.stroke_.getColor())&&(t="#000"),t=zt(t),void 0===(o=this.stroke_.getWidth())&&(o=1),s=this.stroke_.getLineDash(),h=this.stroke_.getLineDashOffset(),void 0===(n=this.stroke_.getLineJoin())&&(n="round"),void 0===(i=this.stroke_.getLineCap())&&(i="round"),void 0===(r=this.stroke_.getMiterLimit())&&(r=10)),{strokeStyle:t,strokeWidth:o,size:2*(this.radius_+o)+1,lineCap:i,lineDash:s,lineDashOffset:h,lineJoin:n,miterLimit:r}},i.prototype.render=function(){var t=this.createRenderOptions(),i=Ut(t.size,t.size);this.draw_(t,i,0,0,1),this.canvas_[1]=i.canvas;var n=i.canvas.width,r=n,s=this.getDisplacement();this.hitDetectionImageSize_=[t.size,t.size],this.createHitDetectionCanvas_(t),this.anchor_=[n/2-s[0],n/2+s[1]],this.size_=[n,n],this.imageSize_=[r,r]},i.prototype.draw_=function(t,i,n,r,s){var h,o,u;i.setTransform(s,0,0,s,0,0),i.translate(n,r),i.beginPath();var e=this.points_;if(e===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var f=void 0!==this.radius2_?this.radius2_:this.radius_;for(f!==this.radius_&&(e*=2),h=0;h<=e;h++)o=2*h*Math.PI/e-Math.PI/2+this.angle_,i.lineTo(t.size/2+(u=h%2==0?this.radius_:f)*Math.cos(o),t.size/2+u*Math.sin(o))}if(this.fill_){var a=this.fill_.getColor();null===a&&(a="#000"),i.fillStyle=zt(a),i.fill()}this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,i.setLineDash&&t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineCap=t.lineCap,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke()),i.closePath()},i.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionCanvas_=this.getImage(1),this.fill_){var i=this.fill_.getColor(),n=0;if("string"==typeof i&&(i=et(i)),null===i?n=1:Array.isArray(i)&&(n=4===i.length?i[3]:1),0===n){var r=Ut(t.size,t.size);this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(t,r,0,0)}}},i.prototype.drawHitDetectionCanvas_=function(t,i,n,r){i.translate(n,r),i.beginPath();var s=this.points_;if(s===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;h!==this.radius_&&(s*=2);var o=void 0,u=void 0,e=void 0;for(o=0;o<=s;o++)e=2*o*Math.PI/s-Math.PI/2+this.angle_,i.lineTo(t.size/2+(u=o%2==0?this.radius_:h)*Math.cos(e),t.size/2+u*Math.sin(e))}i.fillStyle="#000",i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.stroke()),i.closePath()},i}(bs),js=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xs=function(t){function i(i){var n=i||{};return t.call(this,{points:1/0,fill:n.fill,radius:n.radius,stroke:n.stroke,displacement:void 0!==n.displacement?n.displacement:[0,0]})||this}return js(i,t),i.prototype.clone=function(){var t=new i({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},i.prototype.setRadius=function(t){this.radius_=t,this.render()},i}(Os),As=function(){function t(t){var i=t||{};this.color_=void 0!==i.color?i.color:null}return t.prototype.clone=function(){var i=this.getColor();return new t({color:Array.isArray(i)?i.slice():i||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}(),ks=function(){function t(t){var i=t||{};this.color_=void 0!==i.color?i.color:null,this.lineCap_=i.lineCap,this.lineDash_=void 0!==i.lineDash?i.lineDash:null,this.lineDashOffset_=i.lineDashOffset,this.lineJoin_=i.lineJoin,this.miterLimit_=i.miterLimit,this.width_=i.width}return t.prototype.clone=function(){var i=this.getColor();return new t({color:Array.isArray(i)?i.slice():i||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}(),Ss=function(){function t(t){var i=t||{};this.geometry_=null,this.geometryFunction_=Ps,void 0!==i.geometry&&this.setGeometry(i.geometry),this.fill_=void 0!==i.fill?i.fill:null,this.image_=void 0!==i.image?i.image:null,this.renderer_=void 0!==i.renderer?i.renderer:null,this.stroke_=void 0!==i.stroke?i.stroke:null,this.text_=void 0!==i.text?i.text:null,this.zIndex_=i.zIndex}return t.prototype.clone=function(){var i=this.getGeometry();return i&&"object"==typeof i&&(i=i.clone()),new t({geometry:i,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(i){return i.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Ps,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}(),Ns=null;function Es(){if(!Ns){var t=new As({color:"rgba(255,255,255,0.4)"}),i=new ks({color:"#3399CC",width:1.25});Ns=[new Ss({image:new xs({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return Ns}function Ps(t){return t.getGeometry()}var Ts=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Is=function(t){function i(i){var n=this,r=i||{},s=dt({},r);return delete s.style,delete s.renderBuffer,delete s.updateWhileAnimating,delete s.updateWhileInteracting,(n=t.call(this,s)||this).declutter_=void 0!==r.declutter&&r.declutter,n.renderBuffer_=void 0!==r.renderBuffer?r.renderBuffer:100,n.style_=null,n.styleFunction_=void 0,n.setStyle(r.style),n.updateWhileAnimating_=void 0!==r.updateWhileAnimating&&r.updateWhileAnimating,n.updateWhileInteracting_=void 0!==r.updateWhileInteracting&&r.updateWhileInteracting,n}return Ts(i,t),i.prototype.getDeclutter=function(){return this.declutter_},i.prototype.getFeatures=function(i){return t.prototype.getFeatures.call(this,i)},i.prototype.getRenderBuffer=function(){return this.renderBuffer_},i.prototype.getRenderOrder=function(){return this.get("renderOrder")},i.prototype.getStyle=function(){return this.style_},i.prototype.getStyleFunction=function(){return this.styleFunction_},i.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},i.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},i.prototype.setRenderOrder=function(t){this.set("renderOrder",t)},i.prototype.setStyle=function(t){this.style_=void 0!==t?t:Es,this.styleFunction_=null===t?void 0:function(t){var i,n;"function"==typeof t?i=t:(Array.isArray(t)?n=t:(w("function"==typeof t.getZIndex,41),n=[t]),i=function(){return n});return i}(this.style_),this.changed()},i}(It),Fs=[8],Cs=[12],zs=[1],Ls=[3],Rs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ds=function(t){function i(i,n,r,s){var h=t.call(this)||this;return h.tolerance=i,h.maxExtent=n,h.pixelRatio=s,h.maxLineWidth=0,h.resolution=r,h.beginGeometryInstruction1_=null,h.beginGeometryInstruction2_=null,h.bufferedMaxExtent_=null,h.instructions=[],h.coordinates=[],h.tmpCoordinate_=[],h.hitDetectionInstructions=[],h.state={},h}return Rs(i,t),i.prototype.applyPixelRatio=function(t){var i=this.pixelRatio;return 1==i?t:t.map((function(t){return t*i}))},i.prototype.appendFlatCoordinates=function(t,i,n,r,s,h){var o=this.coordinates.length,u=this.getBufferedMaxExtent();h&&(i+=r);var e,f,a,c=t[i],v=t[i+1],l=this.tmpCoordinate_,d=!0;for(e=i+r;e<n;e+=r)l[0]=t[e],l[1]=t[e+1],(a=E(u,l))!==f?(d&&(this.coordinates[o++]=c,this.coordinates[o++]=v),this.coordinates[o++]=l[0],this.coordinates[o++]=l[1],d=!1):1===a?(this.coordinates[o++]=l[0],this.coordinates[o++]=l[1],d=!1):d=!0,c=l[0],v=l[1],f=a;return(s&&d||e===i+r)&&(this.coordinates[o++]=c,this.coordinates[o++]=v),o},i.prototype.drawCustomCoordinates_=function(t,i,n,r,s){for(var h=0,o=n.length;h<o;++h){var u=n[h],e=this.appendFlatCoordinates(t,i,u,r,!1,!1);s.push(e),i=u}return i},i.prototype.drawCustom=function(t,i,n){this.beginGeometry(t,i);var r,s,h,o,u,e=t.getType(),f=t.getStride(),a=this.coordinates.length;if("MultiPolygon"==e){r=t.getOrientedFlatCoordinates(),o=[];var c=t.getEndss();u=0;for(var v=0,l=c.length;v<l;++v){var d=[];u=this.drawCustomCoordinates_(r,u,c[v],f,d),o.push(d)}this.instructions.push([4,a,o,t,n,ir])}else"Polygon"==e||"MultiLineString"==e?(h=[],r="Polygon"==e?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),u=this.drawCustomCoordinates_(r,0,t.getEnds(),f,h),this.instructions.push([4,a,h,t,n,tr])):"LineString"==e||"MultiPoint"==e?(r=t.getFlatCoordinates(),s=this.appendFlatCoordinates(r,0,r.length,f,!1,!1),this.instructions.push([4,a,s,t,n,Qn])):"Point"==e&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),this.instructions.push([4,a,s=this.coordinates.length,t,n]));this.endGeometry(i)},i.prototype.beginGeometry=function(t,i){var n=t.getExtent();this.beginGeometryInstruction1_=[0,i,0,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[0,i,0,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},i.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},i.prototype.reverseHitDetectionInstructions=function(){var t,i=this.hitDetectionInstructions;i.reverse();var n,r,s=i.length,h=-1;for(t=0;t<s;++t)7==(r=(n=i[t])[0])?h=t:0==r&&(n[2]=t,o(this.hitDetectionInstructions,h,t),h=-1)},i.prototype.setFillStrokeStyle=function(t,i){var n=this.state;if(t){var r=t.getColor();n.fillStyle=zt(r||"#000")}else n.fillStyle=void 0;if(i){var s=i.getColor();n.strokeStyle=zt(s||"#000");var h=i.getLineCap();n.lineCap=void 0!==h?h:"round";var o=i.getLineDash();n.lineDash=o?o.slice():Ht;var u=i.getLineDashOffset();n.lineDashOffset=u||0;var e=i.getLineJoin();n.lineJoin=void 0!==e?e:"round";var f=i.getWidth();n.lineWidth=void 0!==f?f:1;var a=i.getMiterLimit();n.miterLimit=void 0!==a?a:10,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0},i.prototype.createFill=function(t){var i=t.fillStyle,n=[10,i];return"string"!=typeof i&&n.push(!0),n},i.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},i.prototype.createStroke=function(t){return[11,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},i.prototype.updateFillStyle=function(t,i){var n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(i.call(this,t)),t.currentFillStyle=n)},i.prototype.updateStrokeStyle=function(t,i){var n=t.strokeStyle,r=t.lineCap,s=t.lineDash,h=t.lineDashOffset,o=t.lineJoin,u=t.lineWidth,f=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=r||s!=t.currentLineDash&&!e(t.currentLineDash,s)||t.currentLineDashOffset!=h||t.currentLineJoin!=o||t.currentLineWidth!=u||t.currentMiterLimit!=f)&&(void 0!==n&&i.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=h,t.currentLineJoin=o,t.currentLineWidth=u,t.currentMiterLimit=f)},i.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[7,t];this.instructions.push(i),this.hitDetectionInstructions.push(i)},i.prototype.getBufferedMaxExtent=function(){return this.bufferedMaxExtent_||(this.bufferedMaxExtent_=x(this.maxExtent),this.maxLineWidth>0&&j(this.bufferedMaxExtent_,this.resolution*(this.maxLineWidth+1)/2,this.bufferedMaxExtent_)),this.bufferedMaxExtent_},i}(Ct),Xs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gs=function(t){function i(i,n,r,s){var h=t.call(this,i,n,r,s)||this;return h.declutterGroups_=null,h.hitDetectionImage_=null,h.image_=null,h.imagePixelRatio_=void 0,h.anchorX_=void 0,h.anchorY_=void 0,h.height_=void 0,h.opacity_=void 0,h.originX_=void 0,h.originY_=void 0,h.rotateWithView_=void 0,h.rotation_=void 0,h.scale_=void 0,h.width_=void 0,h}return Xs(i,t),i.prototype.drawCoordinates_=function(t,i,n,r){return this.appendFlatCoordinates(t,i,n,r,!1,!1)},i.prototype.drawPoint=function(t,i){if(this.image_){this.beginGeometry(t,i);var n=t.getFlatCoordinates(),r=t.getStride(),s=this.coordinates.length,h=this.drawCoordinates_(n,0,n.length,r);this.instructions.push([6,s,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]),this.hitDetectionInstructions.push([6,s,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(i)}},i.prototype.drawMultiPoint=function(t,i){if(this.image_){this.beginGeometry(t,i);var n=t.getFlatCoordinates(),r=t.getStride(),s=this.coordinates.length,h=this.drawCoordinates_(n,0,n.length,r);this.instructions.push([6,s,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]),this.hitDetectionInstructions.push([6,s,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(i)}},i.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},i.prototype.setImageStyle=function(t,i){var n=t.getAnchor(),r=t.getSize(),s=t.getHitDetectionImage(),h=t.getImage(this.pixelRatio),o=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.declutterGroups_=i,this.hitDetectionImage_=s,this.image_=h,this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=o[0],this.originY_=o[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0]},i}(Ds),Ys=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ws=function(t){function i(i,n,r,s){return t.call(this,i,n,r,s)||this}return Ys(i,t),i.prototype.drawFlatCoordinates_=function(t,i,n,r){var s=[9,this.coordinates.length,this.appendFlatCoordinates(t,i,n,r,!1,!1)];return this.instructions.push(s),this.hitDetectionInstructions.push(s),n},i.prototype.drawLineString=function(t,i){var n=this.state;if(void 0!==n.strokeStyle&&void 0!==n.lineWidth){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([11,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],zs);var r=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(r,0,r.length,s),this.hitDetectionInstructions.push(Cs),this.endGeometry(i)}},i.prototype.drawMultiLineString=function(t,i){var n=this.state;if(void 0!==n.strokeStyle&&void 0!==n.lineWidth){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([11,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],zs);for(var r=t.getEnds(),s=t.getFlatCoordinates(),h=t.getStride(),o=0,u=0,e=r.length;u<e;++u)o=this.drawFlatCoordinates_(s,o,r[u],h);this.hitDetectionInstructions.push(Cs),this.endGeometry(i)}},i.prototype.finish=function(){var i=this.state;return null!=i.lastStroke&&i.lastStroke!=this.coordinates.length&&this.instructions.push(Cs),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},i.prototype.applyStroke=function(i){null!=i.lastStroke&&i.lastStroke!=this.coordinates.length&&(this.instructions.push(Cs),i.lastStroke=this.coordinates.length),i.lastStroke=0,t.prototype.applyStroke.call(this,i),this.instructions.push(zs)},i}(Ds),Zs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Us=function(t){function i(i,n,r,s){return t.call(this,i,n,r,s)||this}return Zs(i,t),i.prototype.drawFlatCoordinatess_=function(t,i,n,r){var s=this.state,h=void 0!==s.fillStyle,o=void 0!==s.strokeStyle,u=n.length;this.instructions.push(zs),this.hitDetectionInstructions.push(zs);for(var e=0;e<u;++e){var f=n[e],a=[9,this.coordinates.length,this.appendFlatCoordinates(t,i,f,r,!0,!o)];this.instructions.push(a),this.hitDetectionInstructions.push(a),o&&(this.instructions.push(Ls),this.hitDetectionInstructions.push(Ls)),i=f}return h&&(this.instructions.push(Fs),this.hitDetectionInstructions.push(Fs)),o&&(this.instructions.push(Cs),this.hitDetectionInstructions.push(Cs)),i},i.prototype.drawCircle=function(t,i){var n=this.state;if(void 0!==n.fillStyle||void 0!==n.strokeStyle){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([10,"#000"]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([11,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var r=t.getFlatCoordinates(),s=t.getStride(),h=this.coordinates.length;this.appendFlatCoordinates(r,0,r.length,s,!1,!1);var o=[2,h];this.instructions.push(zs,o),this.hitDetectionInstructions.push(zs,o),void 0!==n.fillStyle&&(this.instructions.push(Fs),this.hitDetectionInstructions.push(Fs)),void 0!==n.strokeStyle&&(this.instructions.push(Cs),this.hitDetectionInstructions.push(Cs)),this.endGeometry(i)}},i.prototype.drawPolygon=function(t,i){var n=this.state;if(void 0!==n.fillStyle||void 0!==n.strokeStyle){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([10,"#000"]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([11,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var r=t.getEnds(),s=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(s,0,r,h),this.endGeometry(i)}},i.prototype.drawMultiPolygon=function(t,i){var n=this.state;if(void 0!==n.fillStyle||void 0!==n.strokeStyle){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([10,"#000"]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([11,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);for(var r=t.getEndss(),s=t.getOrientedFlatCoordinates(),h=t.getStride(),o=0,u=0,e=r.length;u<e;++u)o=this.drawFlatCoordinatess_(s,o,r[u],h);this.endGeometry(i)}},i.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var i=this.tolerance;if(0!==i)for(var n=this.coordinates,r=0,s=n.length;r<s;++r)n[r]=Hn(n[r],i);return t.prototype.finish.call(this)},i.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},i}(Ds);function qs(t,i,n,r,s){var h,o,u,e,f,a,c,v,l,d=n,p=n,_=0,m=0,w=n;for(h=n;h<r;h+=s){var M=i[h],g=i[h+1];void 0!==e&&(v=M-e,l=g-f,u=Math.sqrt(v*v+l*l),void 0!==a&&(m+=o,Math.acos((a*v+c*l)/(o*u))>t&&(m>_&&(_=m,d=w,p=h),m=0,w=h-s)),o=u,a=v,c=l),e=M,f=g}return(m+=u)>_?[w,h]:[d,p]}var Vs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Js={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},$s={Circle:Us,Default:Ds,Image:Gs,LineString:Ws,Polygon:Us,Text:function(t){function i(i,n,r,s){var h=t.call(this,i,n,r,s)||this;return h.labels_=null,h.text_="",h.textOffsetX_=0,h.textOffsetY_=0,h.textRotateWithView_=void 0,h.textRotation_=0,h.textFillState_=null,h.fillStates={},h.textStrokeState_=null,h.strokeStates={},h.textState_={},h.textStates={},h.textKey_="",h.fillKey_="",h.strokeKey_="",h}return Vs(i,t),i.prototype.finish=function(){var i=t.prototype.finish.call(this);return i.textStates=this.textStates,i.fillStates=this.fillStates,i.strokeStates=this.strokeStates,i},i.prototype.drawText=function(t,i){var n=this.textState_;if(""!==this.text_&&n&&(this.textFillState_||this.textStrokeState_)){var r,s,h=this.coordinates.length,o=t.getType(),u=null,e=2,f=t.getStride();if("line"===n.placement){if(!$(this.getBufferedMaxExtent(),t.getExtent()))return;var a=void 0;if(u=t.getFlatCoordinates(),"LineString"==o)a=[u.length];else if("MultiLineString"==o)a=t.getEnds();else if("Polygon"==o)a=t.getEnds().slice(0,1);else if("MultiPolygon"==o){var c=t.getEndss();for(a=[],r=0,s=c.length;r<s;++r)a.push(c[r][0])}this.beginGeometry(t,i);for(var v=n.textAlign,l=0,d=void 0,p=0,_=a.length;p<_;++p){if(null==v){var m=qs(n.maxAngle,u,l,a[p],f);l=m[0],d=m[1]}else d=a[p];for(r=l;r<d;r+=f)this.coordinates.push(u[r],u[r+1]);e=this.coordinates.length,l=a[p];var w=this.declutterGroups_?0===p?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(h,e,w),h=e}this.endGeometry(i)}else{var M=null;switch(n.overflow||(M=[]),o){case"Point":case"MultiPoint":e=(u=t.getFlatCoordinates()).length;break;case"LineString":u=t.getFlatMidpoint();break;case"Circle":u=t.getCenter();break;case"MultiLineString":f=2,e=(u=t.getFlatMidpoints()).length;break;case"Polygon":u=t.getFlatInteriorPoint(),n.overflow||M.push(u[2]/this.resolution),f=3;break;case"MultiPolygon":var g=t.getFlatInteriorPoints();for(u=[],r=0,s=g.length;r<s;r+=3)n.overflow||M.push(g[r+2]/this.resolution),u.push(g[r],g[r+1]);if(f=2,0==(e=u.length))return}e=this.appendFlatCoordinates(u,0,e,f,!1,!1),this.saveTextStates_(),(n.backgroundFill||n.backgroundStroke)&&(this.setFillStrokeStyle(n.backgroundFill,n.backgroundStroke),n.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),n.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,i);var b=n.padding;if(b!=Kt&&(n.scale[0]<0||n.scale[1]<0)){var y=n.padding[0],O=n.padding[1],j=n.padding[2],x=n.padding[3];n.scale[0]<0&&(O=-O,x=-x),n.scale[1]<0&&(y=-y,j=-j),b=[y,O,j,x]}var A=this.pixelRatio;this.instructions.push([6,h,e,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,b==Kt?Kt:b.map((function(t){return t*A})),!!n.backgroundFill,!!n.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,M]);var k=1/A;this.hitDetectionInstructions.push([6,h,e,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[k,k],NaN,b,!!n.backgroundFill,!!n.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,M]),this.endGeometry(i)}}},i.prototype.saveTextStates_=function(){var t=this.textStrokeState_,i=this.textState_,n=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var s=this.textKey_;s in this.textStates||(this.textStates[s]={font:i.font,textAlign:i.textAlign||"center",textBaseline:i.textBaseline||"middle",scale:i.scale});var h=this.fillKey_;n&&(h in this.fillStates||(this.fillStates[h]={fillStyle:n.fillStyle}))},i.prototype.drawChars_=function(t,i,n){var r=this.textStrokeState_,s=this.textState_,h=this.strokeKey_,o=this.textKey_,u=this.fillKey_;this.saveTextStates_();var e=this.pixelRatio,f=Js[s.textBaseline],a=this.textOffsetY_*e,c=this.text_,v=r?r.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([5,t,i,f,n,s.overflow,u,s.maxAngle,e,a,h,v*e,c,o,1]),this.hitDetectionInstructions.push([5,t,i,f,n,s.overflow,u,s.maxAngle,1,a,h,v,c,o,1/e])},i.prototype.setTextStyle=function(t,i){var n,r,s;if(t){this.declutterGroups_=i;var h=t.getFill();h?((r=this.textFillState_)||(this.textFillState_=r={}),r.fillStyle=zt(h.getColor()||"#000")):this.textFillState_=r=null;var o=t.getStroke();if(o){(s=this.textStrokeState_)||(this.textStrokeState_=s={});var u=o.getLineDash(),e=o.getLineDashOffset(),f=o.getWidth(),a=o.getMiterLimit();s.lineCap=o.getLineCap()||"round",s.lineDash=u?u.slice():Ht,s.lineDashOffset=void 0===e?0:e,s.lineJoin=o.getLineJoin()||"round",s.lineWidth=void 0===f?1:f,s.miterLimit=void 0===a?10:a,s.strokeStyle=zt(o.getColor()||"#000")}else this.textStrokeState_=s=null;n=this.textState_;var c=t.getFont()||"10px sans-serif";hi(c);var v=t.getScaleArray();n.overflow=t.getOverflow(),n.font=c,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.textBaseline=t.getTextBaseline()||"middle",n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||Kt,n.scale=void 0===v?[1,1]:v;var l=t.getOffsetX(),p=t.getOffsetY(),_=t.getRotateWithView(),m=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===p?0:p,this.textRotateWithView_=void 0!==_&&_,this.textRotation_=void 0===m?0:m,this.strokeKey_=s?("string"==typeof s.strokeStyle?s.strokeStyle:d(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.textBaseline||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+d(r.fillStyle):""}else this.text_=""},i}(Ds)},Bs=function(){function t(t,i,n,r,s){this.declutter_=s,this.declutterGroups_=null,this.tolerance_=t,this.maxExtent_=i,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}return t.prototype.addDeclutter=function(t){var i=null;return this.declutter_&&(t?(i=this.declutterGroups_)[0][0]++:this.declutterGroups_=i=[[1]]),i},t.prototype.finish=function(){var t={};for(var i in this.buildersByZIndex_){t[i]=t[i]||{};var n=this.buildersByZIndex_[i];for(var r in n){var s=n[r].finish();t[i][r]=s}}return t},t.prototype.getBuilder=function(t,i){var n=void 0!==t?t.toString():"0",r=this.buildersByZIndex_[n];void 0===r&&(this.buildersByZIndex_[n]=r={});var s=r[i];return void 0===s&&(s=new(0,$s[i])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[i]=s),s},t}(),Hs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ks=function(t){function i(i){var n=t.call(this)||this;return n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=i,n}return Hs(i,t),i.prototype.getFeatures=function(){return v()},i.prototype.prepareFrame=function(){return v()},i.prototype.renderFrame=function(){return v()},i.prototype.loadedTileCallback=function(t,i,n){t[i]||(t[i]={}),t[i][n.tileCoord.toString()]=n},i.prototype.createLoadedTileFinder=function(t,i,n){return function(r,s){var h=this.loadedTileCallback.bind(this,n,r);return t.forEachLoadedTile(i,r,s,h)}.bind(this)},i.prototype.forEachFeatureAtCoordinate=function(){},i.prototype.getDataAtPixel=function(){return v()},i.prototype.getLayer=function(){return this.layer_},i.prototype.handleFontsChanged=function(){},i.prototype.handleImageChange_=function(t){2===t.target.getState()&&this.renderIfReadyAndVisible()},i.prototype.loadImage=function(t){var i=t.getState();return 2!=i&&3!=i&&t.addEventListener("change",this.boundHandleImageChange_),0==i&&(t.load(),i=t.getState()),2==i},i.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&"ready"==t.getSourceState()&&t.changed()},i}(jt),Qs=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),th=function(t){function i(i){var n=t.call(this,i)||this;return n.container=null,n.tempTransform=[1,0,0,1,0,0],n.pixelTransform=[1,0,0,1,0,0],n.inversePixelTransform=[1,0,0,1,0,0],n.context=null,n.containerReused=!1,n}return Qs(i,t),i.prototype.useContainer=function(t,i){var n,r,s=this.getLayer().getClassName();if(t&&""===t.style.opacity&&t.className===s&&(h=t.firstElementChild)instanceof HTMLCanvasElement&&(r=h.getContext("2d")),!r||0!==r.canvas.width&&r.canvas.style.transform!==i?this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1):(this.container=t,this.context=r,this.containerReused=!0),!this.container){(n=document.createElement("div")).className=s;var h,o=n.style;o.position="absolute",o.width="100%",o.height="100%",r=Ut(),n.appendChild(h=r.canvas),(o=h.style).position="absolute",o.left="0",o.transformOrigin="top left",this.container=n,this.context=r}},i.prototype.clip=function(t,i,n){var r=i.pixelRatio,s=i.size[0]*r/2,h=i.size[1]*r/2,o=i.viewState.rotation,u=q(n),e=V(n),f=X(n),a=D(n);M(i.coordinateToPixelTransform,u),M(i.coordinateToPixelTransform,e),M(i.coordinateToPixelTransform,f),M(i.coordinateToPixelTransform,a),t.save(),ai(t,-o,s,h),t.beginPath(),t.moveTo(u[0]*r,u[1]*r),t.lineTo(e[0]*r,e[1]*r),t.lineTo(f[0]*r,f[1]*r),t.lineTo(a[0]*r,a[1]*r),t.clip(),ai(t,o,s,h)},i.prototype.clipUnrotated=function(t,i,n){var r=q(n),s=V(n),h=X(n),o=D(n);M(i.coordinateToPixelTransform,r),M(i.coordinateToPixelTransform,s),M(i.coordinateToPixelTransform,h),M(i.coordinateToPixelTransform,o);var u=this.inversePixelTransform;M(u,r),M(u,s),M(u,h),M(u,o),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(h[0]),Math.round(h[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()},i.prototype.dispatchRenderEvent_=function(t,i,n){var r=this.getLayer();if(r.hasListener(t)){var s=new mn(t,this.inversePixelTransform,n,i);r.dispatchEvent(s)}},i.prototype.preRender=function(t,i){this.dispatchRenderEvent_("prerender",t,i)},i.prototype.postRender=function(t,i){this.dispatchRenderEvent_("postrender",t,i)},i.prototype.getRenderTransform=function(t,i,n,r,s,h,o){var u=r/i;return g(this.tempTransform,s/2,h/2,u,-u,-n,-t[0]+o,-t[1])},i.prototype.getDataAtPixel=function(t){var i,n=M(this.inversePixelTransform,t.slice()),r=this.context;try{var s=Math.round(n[0]),h=Math.round(n[1]),o=document.createElement("canvas"),u=o.getContext("2d");o.width=1,o.height=1,u.clearRect(0,0,1,1),u.drawImage(r.canvas,s,h,1,1,0,0,1,1),i=u.getImageData(0,0,1,1).data}catch(e){return"SecurityError"===e.name?new Uint8Array:i}return 0===i[3]?null:i},i}(Ks);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var ih,nh=(function(t){t.exports=function(){function t(t,n,s,h,o){i(t,n,s||0,h||t.length-1,o||r)}function i(t,r,s,h,o){for(;h>s;){if(h-s>600){var u=h-s+1,e=r-s+1,f=Math.log(u),a=.5*Math.exp(2*f/3),c=.5*Math.sqrt(f*a*(u-a)/u)*(e-u/2<0?-1:1);i(t,r,Math.max(s,Math.floor(r-e*a/u+c)),Math.min(h,Math.floor(r+(u-e)*a/u+c)),o)}var v=t[r],l=s,d=h;for(n(t,s,r),o(t[h],v)>0&&n(t,s,h);l<d;){for(n(t,l,d),l++,d--;o(t[l],v)<0;)l++;for(;o(t[d],v)>0;)d--}0===o(t[s],v)?n(t,s,d):n(t,++d,h),d<=r&&(s=d+1),r<=d&&(h=d-1)}}function n(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function r(t,i){return t<i?-1:t>i?1:0}var s=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function h(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function o(t,i){u(t,0,t.children.length,i,t)}function u(t,i,n,r,s){s||(s=p(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var h=i;h<n;h++){var o=t.children[h];e(s,t.leaf?r(o):o)}return s}function e(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function f(t,i){return t.minX-i.minX}function a(t,i){return t.minY-i.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function v(t){return t.maxX-t.minX+(t.maxY-t.minY)}function l(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function d(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(i,n,r,s,h){for(var o=[n,r];o.length;)if(!((r=o.pop())-(n=o.pop())<=s)){var u=n+Math.ceil((r-n)/s/2)*s;t(i,u,n,r,h),o.push(n,u,u,r)}}return s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(t){var i=this.data,n=[];if(!d(t,i))return n;for(var r=this.toBBox,s=[];i;){for(var h=0;h<i.children.length;h++){var o=i.children[h],u=i.leaf?r(o):o;d(t,u)&&(i.leaf?n.push(o):l(t,u)?this._all(o,n):s.push(o))}i=s.pop()}return n},s.prototype.collides=function(t){var i=this.data;if(!d(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var s=i.children[r],h=i.leaf?this.toBBox(s):s;if(d(t,h)){if(i.leaf||l(t,h))return!0;n.push(s)}}i=n.pop()}return!1},s.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},s.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},s.prototype.clear=function(){return this.data=p([]),this},s.prototype.remove=function(t,i){if(!t)return this;for(var n,r,s,o=this.data,u=this.toBBox(t),e=[],f=[];o||e.length;){if(o||(o=e.pop(),r=e[e.length-1],n=f.pop(),s=!0),o.leaf){var a=h(t,o.children,i);if(-1!==a)return o.children.splice(a,1),e.push(o),this._condense(e),this}s||o.leaf||!l(o,u)?r?(n++,o=r.children[n],s=!1):o=null:(e.push(o),f.push(n),n=0,r=o,o=o.children[0])}return this},s.prototype.toBBox=function(t){return t},s.prototype.compareMinX=function(t,i){return t.minX-i.minX},s.prototype.compareMinY=function(t,i){return t.minY-i.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(t){return this.data=t,this},s.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},s.prototype._build=function(t,i,n,r){var s,h=n-i+1,u=this._maxEntries;if(h<=u)return o(s=p(t.slice(i,n+1)),this.toBBox),s;r||(r=Math.ceil(Math.log(h)/Math.log(u)),u=Math.ceil(h/Math.pow(u,r-1))),(s=p([])).leaf=!1,s.height=r;var e=Math.ceil(h/u),f=e*Math.ceil(Math.sqrt(u));_(t,i,n,f,this.compareMinX);for(var a=i;a<=n;a+=f){var c=Math.min(a+f-1,n);_(t,a,c,e,this.compareMinY);for(var v=a;v<=c;v+=e){var l=Math.min(v+e-1,c);s.children.push(this._build(t,v,l,r-1))}}return o(s,this.toBBox),s},s.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var s=1/0,h=1/0,o=void 0,u=0;u<i.children.length;u++){var e=i.children[u],f=c(e),a=(v=t,l=e,(Math.max(l.maxX,v.maxX)-Math.min(l.minX,v.minX))*(Math.max(l.maxY,v.maxY)-Math.min(l.minY,v.minY))-f);a<h?(h=a,s=f<s?f:s,o=e):a===h&&f<s&&(s=f,o=e)}i=o||i.children[0]}var v,l;return i},s.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),s=[],h=this._chooseSubtree(r,this.data,i,s);for(h.children.push(t),e(h,r);i>=0&&s[i].children.length>this._maxEntries;)this._split(s,i),i--;this._adjustParentBBoxes(r,s,i)},s.prototype._split=function(t,i){var n=t[i],r=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,r);var h=this._chooseSplitIndex(n,s,r),u=p(n.children.splice(h,n.children.length-h));u.height=n.height,u.leaf=n.leaf,o(n,this.toBBox),o(u,this.toBBox),i?t[i-1].children.push(u):this._splitRoot(n,u)},s.prototype._splitRoot=function(t,i){this.data=p([t,i]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(t,i,n){for(var r,s=1/0,h=1/0,o=i;o<=n-i;o++){var e=u(t,0,o,this.toBBox),f=u(t,o,n,this.toBBox),a=(l=e,d=f,p=void 0,_=void 0,m=void 0,w=void 0,p=Math.max(l.minX,d.minX),_=Math.max(l.minY,d.minY),m=Math.min(l.maxX,d.maxX),w=Math.min(l.maxY,d.maxY),Math.max(0,m-p)*Math.max(0,w-_)),v=c(e)+c(f);a<s?(s=a,r=o,h=v<h?v:h):a===s&&v<h&&(h=v,r=o)}var l,d,p,_,m,w;return r||n-i},s.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:f,s=t.leaf?this.compareMinY:a;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,s)&&t.children.sort(r)},s.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var s=this.toBBox,h=u(t,0,i,s),o=u(t,n-i,n,s),f=v(h)+v(o),a=i;a<n-i;a++){var c=t.children[a];e(h,t.leaf?s(c):c),f+=v(h)}for(var l=n-i-1;l>=i;l--){var d=t.children[l];e(o,t.leaf?s(d):d),f+=v(o)}return f},s.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)e(i[r],t)},s.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():o(t[i],this.toBBox)},s}()}(ih={path:undefined,exports:{},require:function(){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}}),ih.exports);function rh(t,i,n,r,s,h,o,u,e,f,a,c){var v,l=[];if(c){var d=di(t,i,n,r,c,[t[i],t[i+1]]);v=d[0]>d[d.length-r]}else v=t[i]>t[n-r];for(var p,_,m=s.length,w=t[i],M=t[i+1],g=t[i+=r],b=t[i+1],y=0,O=Math.sqrt(Math.pow(g-w,2)+Math.pow(b-M,2)),j=!1,x=0;x<m;++x){for(var A=s[p=v?m-x-1:x],k=u*e(f,A,a),S=h+k/2;i<n-r&&y+O<S;)w=g,M=b,g=t[i+=r],b=t[i+1],y+=O,O=Math.sqrt(Math.pow(g-w,2)+Math.pow(b-M,2));var N=S-y,E=Math.atan2(b-M,g-w);if(v&&(E+=E>0?-Math.PI:Math.PI),void 0!==_){var P=E-_;if(j=j||0!==P,P+=P>Math.PI?-2*Math.PI:P<-Math.PI?2*Math.PI:0,Math.abs(P)>o)return null}_=E;var T=N/O,I=st(w,g,T),F=st(M,b,T);l[p]=[I,F,k/2,E,A],h+=k}return j?l:[[l[0][0],l[0][1],l[0][2],l[0][3],s]]}var sh=[1/0,1/0,-1/0,-1/0],hh=[1,0,0,1,0,0],oh=[],uh=[],eh=[],fh=[],ah=function(){function t(t,i,n,r,s){this.overlaps=n,this.pixelRatio=i,this.resolution=t,this.declutterItems=[],this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderBuffer_=s,this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,i,n,r){var s=t+i+n+r;if(this.labels_[s])return this.labels_[s];var h=r?this.strokeStates[r]:null,o=n?this.fillStates[n]:null,u=this.textStates[i],e=this.pixelRatio,f=[u.scale[0]*e,u.scale[1]*e],a=Js[u.textAlign||"center"],c=r&&h.lineWidth?h.lineWidth:0,v=t.split("\n"),l=v.length,d=[],p=function(t,i,n){for(var r=i.length,s=0,h=0;h<r;++h){var o=ei(t,i[h]);s=Math.max(s,o),n.push(o)}return s}(u.font,v,d),_=oi(u.font),m=p+c,w=[],M=(m+2)*f[0],g=(_*l+c)*f[1],b={width:M<0?Math.floor(M):Math.ceil(M),height:g<0?Math.floor(g):Math.ceil(g),contextInstructions:w};1==f[0]&&1==f[1]||w.push("scale",f),w.push("font",u.font),r&&(w.push("strokeStyle",h.strokeStyle),w.push("lineWidth",c),w.push("lineCap",h.lineCap),w.push("lineJoin",h.lineJoin),w.push("miterLimit",h.miterLimit),(Yt?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(w.push("setLineDash",[h.lineDash]),w.push("lineDashOffset",h.lineDashOffset))),n&&w.push("fillStyle",o.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");var y,O=.5-a,j=a*m+O*c;if(r)for(y=0;y<l;++y)w.push("strokeText",[v[y],j+O*d[y],.5*(c+_)+y*_]);if(n)for(y=0;y<l;++y)w.push("fillText",[v[y],j+O*d[y],.5*(c+_)+y*_]);return this.labels_[s]=b,b},t.prototype.replayTextBackground_=function(t,i,n,r,s,h,o,u){t.beginPath(),t.moveTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,i),h&&(this.alignFill_=h[2],u&&(t.fillStyle=h[1]),this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())},t.prototype.replayImageOrLabel_=function(t,i,n,r,s,h,o,u,e,f,a,c,v,l,d,p,_,m,w){var b=m||w,y=p+a>s.width?s.width-a:p,O=e+c>s.height?s.height-c:e,j=_[3]+y*l[0]+_[1],x=_[0]+O*l[1]+_[2],A=(n-=h*=l[0])-_[3],k=(r-=o*=l[1])-_[0];(b||0!==v)&&(oh[0]=A,fh[0]=A,oh[1]=k,uh[1]=k,uh[0]=A+j,eh[0]=uh[0],eh[1]=k+x,fh[1]=eh[1]);var S=null;if(0!==v){var N=n+h,E=r+o;S=g(hh,N,E,1,1,v,-N,-E),M(hh,oh),M(hh,uh),M(hh,eh),M(hh,fh),P(Math.min(oh[0],uh[0],eh[0],fh[0]),Math.min(oh[1],uh[1],eh[1],fh[1]),Math.max(oh[0],uh[0],eh[0],fh[0]),Math.max(oh[1],uh[1],eh[1],fh[1]),sh)}else P(A,k,A+j,k+x,sh);var T=0,I=0;if(u){var F=this.renderBuffer_;F[0]=Math.max(F[0],J(sh)),T=F[0],F[1]=Math.max(F[1],Z(sh)),I=F[1]}var C=t.canvas,z=w?w[2]*l[0]/2:0,L=sh[0]-z<=(C.width+T)/i&&sh[2]+z>=-T/i&&sh[1]-z<=(C.height+I)/i&&sh[3]+z>=-I/i;if(d&&(n=Math.round(n),r=Math.round(r)),u){if(!L&&1==u[0])return!1;var R=L?[t,S?S.slice(0):null,f,s,a,c,y,O,n,r,l,sh.slice()]:null;R&&(b&&R.push(m,w,oh.slice(0),uh.slice(0),eh.slice(0),fh.slice(0)),u.push(R))}else L&&(b&&this.replayTextBackground_(t,oh,uh,eh,fh,m,w,!1),ci(t,S,f,s,a,c,y,O,n,r,l));return!0},t.prototype.fill_=function(t){if(this.alignFill_){var i=M(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,i){t.strokeStyle=i[1],t.lineWidth=i[2],t.lineCap=i[3],t.lineJoin=i[4],t.miterLimit=i[5],t.setLineDash&&(t.lineDashOffset=i[7],t.setLineDash(i[6]))},t.prototype.renderDeclutter=function(t,i,n,r){for(var s=[],h=1,o=t.length;h<o;++h){var u=(c=t[h])[11];s.push({minX:u[0],minY:u[1],maxX:u[2],maxY:u[3],value:i})}r||(r=new nh(9));var e=!1;for(h=0,o=s.length;h<o;++h)if(r.collides(s[h])){e=!0;break}if(!e){r.load(s);for(var f=1,a=t.length;f<a;++f){var c,v=(c=t[f])[0],l=v.globalAlpha;l!==n&&(v.globalAlpha=n),c.length>12&&this.replayTextBackground_(c[0],c[14],c[15],c[16],c[17],c[12],c[13],!0),ci.apply(void 0,c),l!==n&&(v.globalAlpha=l)}}return t.length=1,r},t.prototype.drawLabelWithPointPlacement_=function(t,i,n,r){var s=this.textStates[i],h=this.createLabel(t,i,r,n),o=this.strokeStates[n],u=this.pixelRatio,e=Js[s.textAlign||"center"],f=Js[s.textBaseline||"middle"],a=o&&o.lineWidth?o.lineWidth:0;return{label:h,anchorX:e*(h.width/u-2*s.scale[0])+2*(.5-e)*a,anchorY:f*h.height/u+2*(.5-f)*a}},t.prototype.execute_=function(t,i,n,r,s,h,o){var u,f,a;this.declutterItems.length=0,this.pixelCoordinates_&&e(n,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=li(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),(f=this.renderedTransform_)[0]=(a=n)[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5]);for(var c,v,l,d,p,_,m,w,M,g,b,y,O,j,x,A,k,S=0,N=r.length,E=0,P=0,T=0,I=null,F=null,C=this.coordinateCache_,z=this.viewRotation_,L=Math.round(1e12*Math.atan2(-n[1],n[0]))/1e12,R={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:z},D=this.instructions!=r||this.overlaps?0:200;S<N;){var X=r[S];switch(X[0]){case 0:(x=X[1]).getGeometry()?void 0===o||$(o,X[3])?++S:S=X[2]+1:S=X[2];break;case 1:P>D&&(this.fill_(t),P=0),T>D&&(t.stroke(),T=0),P||T||(t.beginPath(),d=NaN,p=NaN),++S;break;case 2:var G=u[E=X[1]],Y=u[E+1],W=u[E+2]-G,Z=u[E+3]-Y,U=Math.sqrt(W*W+Z*Z);t.moveTo(G+U,Y),t.arc(G,Y,U,0,2*Math.PI,!0),++S;break;case 3:t.closePath(),++S;break;case 4:E=X[1],c=X[2];var q=X[4],V=6==X.length?X[5]:void 0;R.geometry=X[3],R.feature=x,S in C||(C[S]=[]);var J=C[S];V?V(u,E,c,2,J):(J[0]=u[E],J[1]=u[E+1],J.length=2),q(J,R),++S;break;case 6:E=X[1],c=X[2],v=X[4],l=X[5],M=h?null:X[6];var B=X[7],H=X[8],K=X[9],Q=X[10],tt=X[11],it=X[12],nt=X[13],rt=X[14];if(!(g=X[3])&&X.length>=19){var st=this.drawLabelWithPointPlacement_(b=X[18],y=X[19],O=X[20],j=X[21]);X[3]=g=st.label,X[4]=v=(st.anchorX-X[22])*this.pixelRatio,X[5]=l=(st.anchorY-X[23])*this.pixelRatio,X[7]=B=g.height,X[14]=rt=g.width}var ht=void 0;X.length>24&&(ht=X[24]);var ot=void 0,ut=void 0,et=void 0;X.length>16?(ot=X[15],ut=X[16],et=X[17]):(ot=Kt,ut=!1,et=!1),tt&&L?it+=z:tt||L||(it-=z);for(var ft=0,at=0;E<c;E+=2)if(!(ht&&ht[ft++]<rt/this.pixelRatio)){if(M){var ct=Math.floor(at);w=M.length<ct+1?[M[0][0]]:M[ct]}(St=this.replayImageOrLabel_(t,i,u[E],u[E+1],g,v,l,w,B,H,K,Q,it,nt,s,rt,ot,ut?I:null,et?F:null))&&w&&M[M.length-1]!==w&&M.push(w),w&&(w.length-1===w[0]&&this.declutterItems.push(this,w,x),at+=1/w[0])}++S;break;case 5:var vt=X[1],lt=X[2],dt=X[3];w=h?null:X[4];var pt=X[5];j=X[6];var _t=X[7],mt=X[8],wt=X[9];O=X[10];var Mt=X[11];b=X[12];var gt=[X[14],X[14]],bt=this.textStates[y=X[13]],yt=bt.font,Ot=[bt.scale[0]*mt,bt.scale[1]*mt],jt=void 0;yt in this.widths_?jt=this.widths_[yt]:this.widths_[yt]=jt={};var xt=gs(u,vt,lt,2),At=Math.abs(Ot[0])*fi(yt,b,jt);if(pt||At<=xt){var kt=rh(u,vt,lt,2,b,(xt-At)*Js[this.textStates[y].textAlign],_t,Math.abs(Ot[0]),fi,yt,jt,L?0:this.viewRotation_);if(kt){var St=!1,Nt=void 0,Et=void 0,Pt=void 0,Tt=void 0;if(O)for(Nt=0,Et=kt.length;Nt<Et;++Nt)Pt=this.createLabel((Tt=kt[Nt])[4],y,"",O),St=this.replayImageOrLabel_(t,i,Tt[0],Tt[1],Pt,v=Tt[2]+Mt,l=dt*Pt.height+2*(.5-dt)*Mt*Ot[1]/Ot[0]-wt,w,Pt.height,1,0,0,Tt[3],gt,!1,Pt.width,Kt,null,null)||St;if(j)for(Nt=0,Et=kt.length;Nt<Et;++Nt)Pt=this.createLabel((Tt=kt[Nt])[4],y,j,""),St=this.replayImageOrLabel_(t,i,Tt[0],Tt[1],Pt,v=Tt[2],l=dt*Pt.height-wt,w,Pt.height,1,0,0,Tt[3],gt,!1,Pt.width,Kt,null,null)||St;St&&this.declutterItems.push(this,w,x)}}++S;break;case 7:if(void 0!==h){var It=h(x=X[1]);if(It)return It}++S;break;case 8:D?P++:this.fill_(t),++S;break;case 9:for(c=X[2],m=(k=u[(E=X[1])+1])+.5|0,(_=(A=u[E])+.5|0)===d&&m===p||(t.moveTo(A,k),d=_,p=m),E+=2;E<c;E+=2)_=(A=u[E])+.5|0,m=(k=u[E+1])+.5|0,E!=c-2&&_===d&&m===p||(t.lineTo(A,k),d=_,p=m);++S;break;case 10:I=X,this.alignFill_=X[2],P&&(this.fill_(t),P=0,T&&(t.stroke(),T=0)),t.fillStyle=X[1],++S;break;case 11:F=X,T&&(t.stroke(),T=0),this.setStrokeStyle_(t,X),++S;break;case 12:D?T++:t.stroke(),++S;break;default:++S}}P&&this.fill_(t),T&&t.stroke()},t.prototype.execute=function(t,i,n,r,s){this.viewRotation_=r,this.execute_(t,i,n,this.instructions,s,void 0,void 0)},t.prototype.executeHitDetection=function(t,i,n,r,s){return this.viewRotation_=n,this.execute_(t,1,i,this.hitDetectionInstructions,!0,r,s)},t}(),ch=["Polygon","Circle","LineString","Image","Text","Default"],vh=function(){function t(t,i,n,r,s,h){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=i,this.renderBuffer_=h,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(s)}return t.prototype.clip=function(t,i){var n=this.getClipCoords(i);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()},t.prototype.createExecutors_=function(t){for(var i in t){var n=this.executorsByZIndex_[i];void 0===n&&(this.executorsByZIndex_[i]=n={});var r=t[i],s=[this.renderBuffer_||0,this.renderBuffer_||0];for(var h in r)n[h]=new ah(this.resolution_,this.pixelRatio_,this.overlaps_,r[h],s)}},t.prototype.hasExecutors=function(t){for(var i in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[i],r=0,s=t.length;r<s;++r)if(t[r]in n)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(t,i,n,r,h,o){var u=2*(r=Math.round(r))+1,e=g(this.hitDetectionTransform_,r+.5,r+.5,1/i,-1/i,-n,-t[0],-t[1]);this.hitDetectionContext_||(this.hitDetectionContext_=Ut(u,u));var f,a=this.hitDetectionContext_;a.canvas.width!==u||a.canvas.height!==u?(a.canvas.width=u,a.canvas.height=u):a.clearRect(0,0,u,u),void 0!==this.renderBuffer_&&(F(f=[1/0,1/0,-1/0,-1/0],t),j(f,i*(this.renderBuffer_+r),f));var c,v=function(t){if(void 0!==lh[t])return lh[t];for(var i=2*t+1,n=new Array(i),r=0;r<i;r++)n[r]=new Array(i);for(var s=t,h=0,o=0;s>=h;)dh(n,t+s,t+h),dh(n,t+h,t+s),dh(n,t-h,t+s),dh(n,t-s,t+h),dh(n,t-s,t-h),dh(n,t-h,t-s),dh(n,t+h,t-s),dh(n,t+s,t-h),2*((o+=1+2*++h)-s)+1>0&&(o+=1-2*(s-=1));return lh[t]=n,n}(r);function l(t){for(var i=a.getImageData(0,0,u,u).data,n=0;n<u;n++)for(var r=0;r<u;r++)if(v[n][r]&&i[4*(r*u+n)+3]>0){var s=void 0;return(!o||"Image"!=c&&"Text"!=c||-1!==o.indexOf(t))&&(s=h(t)),s||void a.clearRect(0,0,u,u)}}var d,p,_,m,w,M=Object.keys(this.executorsByZIndex_).map(Number);for(M.sort(s),d=M.length-1;d>=0;--d){var b=M[d].toString();for(_=this.executorsByZIndex_[b],p=ch.length-1;p>=0;--p)if(void 0!==(m=_[c=ch[p]])&&(w=m.executeHitDetection(a,e,n,l,f)))return w}},t.prototype.getClipCoords=function(t){var i=this.maxExtent_;if(!i)return null;var n=i[0],r=i[1],s=i[2],h=i[3],o=[n,r,n,h,s,h,s,r];return li(o,0,8,2,t,o),o},t.prototype.isEmpty=function(){return mt(this.executorsByZIndex_)},t.prototype.execute=function(t,i,n,r,h,o,u){var e=Object.keys(this.executorsByZIndex_).map(Number);e.sort(s),this.maxExtent_&&(t.save(),this.clip(t,n));var f,a,c,v,l,d,p=o||ch;for(f=0,a=e.length;f<a;++f){var _=e[f].toString();for(l=this.executorsByZIndex_[_],c=0,v=p.length;c<v;++c){var m=p[c];if(void 0!==(d=l[m]))if(!u||"Image"!=m&&"Text"!=m)d.execute(t,i,n,r,h);else{var w=u[_];w?w.push(d,n.slice(0)):u[_]=[d,n.slice(0)]}}}this.maxExtent_&&t.restore()},t}(),lh={0:[[!0]]};function dh(t,i,n){var r,s=Math.floor(t.length/2);if(i>=s)for(r=s;r<i;r++)t[r][n]=!0;else if(i<s)for(r=i+1;r<s;r++)t[r][n]=!0}var ph=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_h=function(t){function i(i,n,r,s){var h=t.call(this)||this;return h.extent=i,h.pixelRatio_=r,h.resolution=n,h.state=s,h}return ph(i,t),i.prototype.changed=function(){this.dispatchEvent("change")},i.prototype.getExtent=function(){return this.extent},i.prototype.getImage=function(){return v()},i.prototype.getPixelRatio=function(){return this.pixelRatio_},i.prototype.getResolution=function(){return this.resolution},i.prototype.getState=function(){return this.state},i.prototype.load=function(){v()},i}(Mt),mh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function wh(t,i,n){var r=t;if(r.src&&Wt){var s=r.decode(),h=!0;return s.then((function(){h&&i()})).catch((function(t){h&&("EncodingError"===t.name&&"Invalid image type."===t.message?i():n())})),function(){h=!1}}var o=[bt(r,"load",i),bt(r,"error",n)];return function(){o.forEach(yt)}}!function(t){function i(i,n,r,s,h,o){var u=t.call(this,i,n,r,0)||this;return u.src_=s,u.image_=new Image,null!==h&&(u.image_.crossOrigin=h),u.unlisten_=null,u.state=0,u.imageLoadFunction_=o,u}mh(i,t),i.prototype.getImage=function(){return this.image_},i.prototype.handleImageError_=function(){this.state=3,this.unlistenImage_(),this.changed()},i.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Z(this.extent)/this.image_.height),this.state=2,this.unlistenImage_(),this.changed()},i.prototype.load=function(){0!=this.state&&3!=this.state||(this.state=1,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=wh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},i.prototype.setImage=function(t){this.image_=t},i.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}(_h);var Mh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gh=null,bh=function(t){function i(i,n,r,s,h,o){var u=t.call(this)||this;return u.hitDetectionImage_=null,u.image_=i||new Image,null!==s&&(u.image_.crossOrigin=s),u.canvas_={},u.color_=o,u.unlisten_=null,u.imageState_=h,u.size_=r,u.src_=n,u}return Mh(i,t),i.prototype.isTainted_=function(){if(void 0===this.tainted_&&2===this.imageState_){gh||(gh=Ut(1,1)),gh.drawImage(this.image_,0,0);try{gh.getImageData(0,0,1,1),this.tainted_=!1}catch(t){gh=null,this.tainted_=!0}}return!0===this.tainted_},i.prototype.dispatchChangeEvent_=function(){this.dispatchEvent("change")},i.prototype.handleImageError_=function(){this.imageState_=3,this.unlistenImage_(),this.dispatchChangeEvent_()},i.prototype.handleImageLoad_=function(){this.imageState_=2,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},i.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},i.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},i.prototype.getImageState=function(){return this.imageState_},i.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],i=this.size_[1],n=Ut(t,i);n.fillRect(0,0,t,i),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},i.prototype.getSize=function(){return this.size_},i.prototype.getSrc=function(){return this.src_},i.prototype.load=function(){if(0==this.imageState_){this.imageState_=1;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=wh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},i.prototype.replaceColor_=function(t){if(this.color_&&!this.canvas_[t]){var i=document.createElement("canvas");this.canvas_[t]=i,i.width=Math.ceil(this.image_.width*t),i.height=Math.ceil(this.image_.height*t);var n=i.getContext("2d");if(n.scale(t,t),n.drawImage(this.image_,0,0),this.isTainted_()){var r=this.color_;return n.globalCompositeOperation="multiply",n.fillStyle="rgb("+r[0]+","+r[1]+","+r[2]+")",n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="destination-in",void n.drawImage(this.image_,0,0)}for(var s=n.getImageData(0,0,i.width,i.height),h=s.data,o=this.color_[0]/255,u=this.color_[1]/255,e=this.color_[2]/255,f=0,a=h.length;f<a;f+=4)h[f]*=o,h[f+1]*=u,h[f+2]*=e;n.putImageData(s,0,0)}},i.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},i}(Mt),yh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oh=function(t){function i(i){var n=this,r=i||{};(n=t.call(this,{opacity:void 0!==r.opacity?r.opacity:1,rotation:void 0!==r.rotation?r.rotation:0,scale:void 0!==r.scale?r.scale:1,displacement:void 0!==r.displacement?r.displacement:[0,0],rotateWithView:void 0!==r.rotateWithView&&r.rotateWithView})||this).anchor_=void 0!==r.anchor?r.anchor:[.5,.5],n.normalizedAnchor_=null,n.anchorOrigin_=void 0!==r.anchorOrigin?r.anchorOrigin:"top-left",n.anchorXUnits_=void 0!==r.anchorXUnits?r.anchorXUnits:"fraction",n.anchorYUnits_=void 0!==r.anchorYUnits?r.anchorYUnits:"fraction",n.crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null;var s=void 0!==r.img?r.img:null,h=void 0!==r.imgSize?r.imgSize:null,o=r.src;w(!(void 0!==o&&s),4),w(!s||s&&h,5),void 0!==o&&0!==o.length||!s||(o=s.src||d(s)),w(void 0!==o&&o.length>0,6);var u=void 0!==r.src?0:2;return n.color_=void 0!==r.color?et(r.color):null,n.iconImage_=function(t,i,n,r,s,h){var o=vt.get(i,r,h);return o||(o=new bh(t,i,n,r,s,h),vt.set(i,r,h,o)),o}(s,o,h,n.crossOrigin_,u,n.color_),n.offset_=void 0!==r.offset?r.offset:[0,0],n.offsetOrigin_=void 0!==r.offsetOrigin?r.offsetOrigin:"top-left",n.origin_=null,n.size_=void 0!==r.size?r.size:null,n}return yh(i,t),i.prototype.clone=function(){var t=this.getScale();return new i({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},i.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,i=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!i)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=i[0]),"fraction"==this.anchorYUnits_&&(t[1]*=i[1])}if("top-left"!=this.anchorOrigin_){if(!i)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+i[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+i[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},i.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},i.prototype.getColor=function(){return this.color_},i.prototype.getImage=function(t){return this.iconImage_.getImage(t)},i.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},i.prototype.getImageSize=function(){return this.iconImage_.getSize()},i.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},i.prototype.getImageState=function(){return this.iconImage_.getImageState()},i.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},i.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_,i=this.getDisplacement();if("top-left"!=this.offsetOrigin_){var n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=r[0]-n[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=r[1]-n[1]-t[1])}return t[0]+=i[0],t[1]+=i[1],this.origin_=t,this.origin_},i.prototype.getSrc=function(){return this.iconImage_.getSrc()},i.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},i.prototype.listenImageChange=function(t){this.iconImage_.addEventListener("change",t)},i.prototype.load=function(){this.iconImage_.load()},i.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener("change",t)},i}(bs),jh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xh=function(t){function i(i){var n=t.call(this,i)||this;return n.boundHandleStyleImageChange_=n.handleStyleImageChange_.bind(n),n.dirty_=!1,n.hitDetectionImageData_=null,n.renderedFeatures_=null,n.renderedRevision_=-1,n.renderedResolution_=NaN,n.renderedExtent_=[1/0,1/0,-1/0,-1/0],n.renderedCenter_=null,n.renderedProjection_=null,n.renderedRenderOrder_=null,n.replayGroup_=null,n.replayGroupChanged=!0,n.clipping=!0,n}return jh(i,t),i.prototype.useContainer=function(i,n,r){r<1&&(i=null),t.prototype.useContainer.call(this,i,n,r)},i.prototype.renderFrame=function(t,i){var n=t.pixelRatio,r=t.layerStatesArray[t.layerIndex];!function(t,i,n){!function(t,i,n,r,s){t[0]=i,t[1]=0,t[2]=0,t[3]=s,t[4]=0,t[5]=0}(t,i,0,0,n)}(this.pixelTransform,1/n,1/n),b(this.inversePixelTransform,this.pixelTransform);var h=y(this.pixelTransform);this.useContainer(i,h,r.opacity);var o=this.context,u=o.canvas,e=this.replayGroup_;if(!e||e.isEmpty())return!this.containerReused&&u.width>0&&(u.width=0),this.container;var f=Math.round(t.size[0]*n),a=Math.round(t.size[1]*n);u.width!=f||u.height!=a?(u.width=f,u.height=a,u.style.transform!==h&&(u.style.transform=h)):this.containerReused||o.clearRect(0,0,f,a),this.preRender(o,t);var c=t.extent,v=t.viewState,l=v.center,d=v.resolution,p=v.projection,_=v.rotation,m=p.getExtent(),w=this.getLayer().getSource(),M=!1;if(r.extent&&this.clipping){var g=r.extent;(M=!S(g,t.extent)&&$(g,t.extent))&&this.clipUnrotated(o,t,g)}var O=t.viewHints,j=!(O[0]||O[1]),x=this.getRenderTransform(l,d,_,n,f,a,0),A=this.getLayer().getDeclutter()?{}:null;if(e.execute(o,1,x,_,j,void 0,A),w.getWrapX()&&p.canWrapX()&&!S(m,c)){for(var k=c[0],N=J(m),E=0;k<m[0];){--E;var P=this.getRenderTransform(l,d,_,n,f,a,N*E);e.execute(o,1,P,_,j,void 0,A),k+=N}for(E=0,k=c[2];k>m[2];){++E;var T=this.getRenderTransform(l,d,_,n,f,a,N*E);e.execute(o,1,T,_,j,void 0,A),k-=N}}if(A){var I=t.viewHints;!function(t,i,n,r,h,o){for(var u=Object.keys(t).map(Number).sort(s),e=0,f=u.length;e<f;++e)for(var a=t[u[e].toString()],c=void 0,v=0,l=a.length;v<l;){var d=a[v++],p=a[v++];d.execute(i,1,p,n,h),d!==c&&d.declutterItems.length>0&&(c=d,o.push({items:d.declutterItems,opacity:1}))}}(A,o,_,0,!(I[0]||I[1]),t.declutterItems)}M&&o.restore(),this.postRender(o,t);var F=r.opacity,C=this.container;return F!==parseFloat(C.style.opacity)&&(C.style.opacity=1===F?"":String(F)),this.renderedRotation_!==v.rotation&&(this.renderedRotation_=v.rotation,this.hitDetectionImageData_=null),this.container},i.prototype.getFeatures=function(t){return new Promise(function(i){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var n=[this.context.canvas.width,this.context.canvas.height];M(this.pixelTransform,n);var r=this.renderedCenter_,h=this.renderedResolution_,o=this.renderedRotation_,u=this.renderedProjection_,e=this.renderedExtent_,f=this.getLayer(),a=[],c=n[0]/2,v=n[1]/2;a.push(this.getRenderTransform(r,h,o,.5,c,v,0).slice());var l=f.getSource(),d=u.getExtent();if(l.getWrapX()&&u.canWrapX()&&!S(d,e)){for(var p=e[0],_=J(d),m=0;p<d[0];)--m,a.push(this.getRenderTransform(r,h,o,.5,c,v,_*m).slice()),p+=_;for(m=0,p=e[2];p>d[2];)++m,a.push(this.getRenderTransform(r,h,o,.5,c,v,_*m).slice()),p-=_}this.hitDetectionImageData_=function(t,i,n,r,h,o,u){var e=Ut(t[0]/2,t[1]/2);e.imageSmoothingEnabled=!1;for(var f=e.canvas,a=new un(e,.5,h,null,u),c=n.length,v=Math.floor(16777215/c),l={},d=1;d<=c;++d){var p=n[d-1],_=p.getStyleFunction()||r;if(r){var m=_(p,o);if(m){Array.isArray(m)||(m=[m]);for(var w="#"+("000000"+(d*v).toString(16)).slice(-6),M=0,g=m.length;M<g;++M){var b=m[M],y=b.clone(),O=y.getFill();O&&O.setColor(w);var j=y.getStroke();j&&j.setColor(w),y.setText(void 0);var x=b.getImage();if(x){var A=x.getImageSize();if(!A)continue;var k=document.createElement("canvas");k.width=A[0],k.height=A[1];var S=k.getContext("2d",{alpha:!1});S.fillStyle=w;var N=S.canvas;S.fillRect(0,0,N.width,N.height),Ut(A?A[0]:N.width,A?A[1]:N.height).drawImage(N,0,0),y.setImage(new Oh({img:N,imgSize:A,anchor:x.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:x.getOrigin(),size:x.getSize(),opacity:x.getOpacity(),scale:x.getScale(),rotation:x.getRotation(),rotateWithView:x.getRotateWithView()}))}var E=Number(y.getZIndex());(F=l[E])||(l[E]=F={},F.Polygon=[],F.Circle=[],F.LineString=[],F.Point=[]);var P=y.getGeometryFunction()(p);P&&$(h,P.getExtent())&&F[P.getType().replace("Multi","")].push(P,y)}}}}for(var T=Object.keys(l).map(Number).sort(s),I=(d=0,T.length);d<I;++d){var F=l[T[d]];for(var C in F){var z=F[C];for(M=0,g=z.length;M<g;M+=2){a.setStyle(z[M+1]);for(var L=0,R=i.length;L<R;++L)a.setTransform(i[L]),a.drawGeometry(z[M])}}}return e.getImageData(0,0,f.width,f.height)}(n,a,this.renderedFeatures_,f.getStyleFunction(),e,h,o)}i(function(t,i,n){var r=[];if(n){var s=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*n.width),h=n.data[s+2]+256*(n.data[s+1]+256*n.data[s]),o=Math.floor(16777215/i.length);h&&h%o==0&&r.push(i[h/o-1])}return r}(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},i.prototype.forEachFeatureAtCoordinate=function(t,i,n,r,s){if(this.replayGroup_){var h=i.viewState.resolution,o=i.viewState.rotation,u=this.getLayer(),e={};return this.replayGroup_.forEachFeatureAtCoordinate(t,h,o,n,(function(t){var i=d(t);if(!(i in e))return e[i]=!0,r(t,u)}),u.getDeclutter()?s:null)}},i.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},i.prototype.handleStyleImageChange_=function(){this.renderIfReadyAndVisible()},i.prototype.prepareFrame=function(t){var i=this.getLayer(),n=i.getSource();if(!n)return!1;var r=t.viewHints[0],s=t.viewHints[1],h=i.getUpdateWhileAnimating(),o=i.getUpdateWhileInteracting();if(!this.dirty_&&!h&&r||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var u=t.extent,e=t.viewState,f=e.projection,a=e.resolution,c=t.pixelRatio,v=i.getRevision(),l=i.getRenderBuffer(),d=i.getRenderOrder();void 0===d&&(d=fn);var p=e.center.slice(),_=j(u,l*a),m=[_.slice()],w=f.getExtent();if(n.getWrapX()&&f.canWrapX()&&!S(w,t.extent)){var M=J(w),g=Math.max(J(_)/2,M);_[0]=w[0]-g,_[2]=w[2]+g,Li(p,f);var b=function(t,i){var n=i.getExtent(),r=G(t);if(i.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){var s=J(n),h=Math.floor((r[0]-n[0])/s)*s;t[0]-=h,t[2]-=h}return t}(m[0],f);b[0]<w[0]&&b[2]<w[2]?m.push([b[0]+M,b[1],b[2]+M,b[3]]):b[0]>w[0]&&b[2]>w[2]&&m.push([b[0]-M,b[1],b[2]-M,b[3]])}if(!this.dirty_&&this.renderedResolution_==a&&this.renderedRevision_==v&&this.renderedRenderOrder_==d&&S(this.renderedExtent_,_))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;for(var y=new Bs(an(a,c),_,a,c,i.getDeclutter()),O=0,x=m.length;O<x;++O)n.loadFeatures(m[O],a,f);var A=function(t,i){var n=an(t,i);return n*n}(a,c),k=function(t){var n,r=t.getStyleFunction()||i.getStyleFunction();if(r&&(n=r(t,a)),n){var s=this.renderFeature(t,A,n,y,void 0);this.dirty_=this.dirty_||s}}.bind(this),N=n.getFeaturesInExtent(_);for(d&&N.sort(d),O=0,x=N.length;O<x;++O)k(N[O]);this.renderedFeatures_=N;var E=y.finish(),P=new vh(_,a,c,n.getOverlaps(),E,i.getRenderBuffer());return this.renderedResolution_=a,this.renderedRevision_=v,this.renderedRenderOrder_=d,this.renderedExtent_=_,this.renderedCenter_=p,this.renderedProjection_=f,this.replayGroup_=P,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},i.prototype.renderFeature=function(t,i,n,r,s){if(!n)return!1;var h=!1;if(Array.isArray(n))for(var o=0,u=n.length;o<u;++o)h=cn(r,t,n[o],i,this.boundHandleStyleImageChange_,s)||h;else h=cn(r,t,n,i,this.boundHandleStyleImageChange_,s);return h},i}(th),Ah=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kh=function(t){function i(i){return t.call(this,i)||this}return Ah(i,t),i.prototype.createRenderer=function(){return new xh(this)},i}(Is),Sh=function(){function t(t){this.rbush_=new nh(t),this.items_={}}return t.prototype.insert=function(t,i){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:i};this.rbush_.insert(n),this.items_[d(i)]=n},t.prototype.load=function(t,i){for(var n=new Array(i.length),r=0,s=i.length;r<s;r++){var h=t[r],o=i[r],u={minX:h[0],minY:h[1],maxX:h[2],maxY:h[3],value:o};n[r]=u,this.items_[d(o)]=u}this.rbush_.load(n)},t.prototype.remove=function(t){var i=d(t),n=this.items_[i];return delete this.items_[i],null!==this.rbush_.remove(n)},t.prototype.update=function(t,i){var n=this.items_[d(i)];I([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(i),this.insert(t,i))},t.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},t.prototype.getInExtent=function(t){return this.rbush_.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}).map((function(t){return t.value}))},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,i){return this.forEach_(this.getInExtent(t),i)},t.prototype.forEach_=function(t,i){for(var n,r=0,s=t.length;r<s;r++)if(n=i(t[r]))return n;return n},t.prototype.isEmpty=function(){return mt(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var i=this.rbush_.toJSON();return P(i.minX,i.minY,i.maxX,i.maxY,t)},t.prototype.concat=function(t){for(var i in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[i]=t.items_[i]},t}(),Nh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Eh=function(t){function i(i){var n=t.call(this)||this;return n.projection_=Gi(i.projection),n.attributions_=Ph(i.attributions),n.attributionsCollapsible_=void 0===i.attributionsCollapsible||i.attributionsCollapsible,n.loading=!1,n.state_=void 0!==i.state?i.state:"ready",n.wrapX_=void 0!==i.wrapX&&i.wrapX,n}return Nh(i,t),i.prototype.getAttributions=function(){return this.attributions_},i.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},i.prototype.getProjection=function(){return this.projection_},i.prototype.getResolutions=function(){return v()},i.prototype.getState=function(){return this.state_},i.prototype.getWrapX=function(){return this.wrapX_},i.prototype.getContextOptions=function(){},i.prototype.refresh=function(){this.changed()},i.prototype.setAttributions=function(t){this.attributions_=Ph(t),this.changed()},i.prototype.setState=function(t){this.state_=t,this.changed()},i}(kt);function Ph(t){return t?Array.isArray(t)?function(){return t}:"function"==typeof t?t:function(){return[t]}:null}function Th(){return[[-1/0,-1/0,1/0,1/0]]}function Ih(t,i){return function(t,i,n,r){return function(s,h,o){var u=new XMLHttpRequest;u.open("GET","function"==typeof t?t(s,h,o):t,!0),"arraybuffer"==i.getType()&&(u.responseType="arraybuffer"),u.withCredentials=!1,u.onload=function(){if(!u.status||u.status>=200&&u.status<300){var t=i.getType(),h=void 0;"json"==t||"text"==t?h=u.responseText:"xml"==t?(h=u.responseXML)||(h=(new DOMParser).parseFromString(u.responseText,"application/xml")):"arraybuffer"==t&&(h=u.response),h?n.call(this,i.readFeatures(h,{extent:s,featureProjection:o}),i.readProjection(h)):r.call(this)}else r.call(this)}.bind(this),u.onerror=function(){r.call(this)}.bind(this),u.send()}}(t,i,(function(t){"function"==typeof this.addFeatures&&this.addFeatures(t)}),c)}var Fh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ch=function(t){function i(i,n){var r=t.call(this,i)||this;return r.feature=n,r}return Fh(i,t),i}(lt),zh=function(t){function i(i){var n=this,r=i||{};(n=t.call(this,{attributions:r.attributions,projection:void 0,state:"ready",wrapX:void 0===r.wrapX||r.wrapX})||this).loader_=c,n.format_=r.format,n.overlaps_=void 0===r.overlaps||r.overlaps,n.url_=r.url,void 0!==r.loader?n.loader_=r.loader:void 0!==n.url_&&(w(n.format_,7),n.loader_=Ih(n.url_,n.format_)),n.strategy_=void 0!==r.strategy?r.strategy:Th;var s,h,o=void 0===r.useSpatialIndex||r.useSpatialIndex;return n.featuresRtree_=o?new Sh:null,n.loadedExtentsRtree_=new Sh,n.nullGeometryFeatures_={},n.idIndex_={},n.uidIndex_={},n.featureChangeKeys_={},n.featuresCollection_=null,Array.isArray(r.features)?h=r.features:r.features&&(h=(s=r.features).getArray()),o||void 0!==s||(s=new yn(h)),void 0!==h&&n.addFeaturesInternal(h),void 0!==s&&n.bindFeaturesCollection_(s),n}return Fh(i,t),i.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},i.prototype.addFeatureInternal=function(t){var i=d(t);if(this.addToIndex_(i,t)){this.setupChangeEvents_(i,t);var n=t.getGeometry();if(n){var r=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[i]=t;this.dispatchEvent(new Ch("addfeature",t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)},i.prototype.setupChangeEvents_=function(t,i){this.featureChangeKeys_[t]=[gt(i,"change",this.handleFeatureChange_,this),gt(i,"propertychange",this.handleFeatureChange_,this)]},i.prototype.addToIndex_=function(t,i){var n=!0,r=i.getId();return void 0!==r&&(r.toString()in this.idIndex_?n=!1:this.idIndex_[r.toString()]=i),n&&(w(!(t in this.uidIndex_),30),this.uidIndex_[t]=i),n},i.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},i.prototype.addFeaturesInternal=function(t){for(var i=[],n=[],r=[],s=0,h=t.length;s<h;s++){var o=d(e=t[s]);this.addToIndex_(o,e)&&n.push(e)}s=0;for(var u=n.length;s<u;s++){var e;o=d(e=n[s]),this.setupChangeEvents_(o,e);var f=e.getGeometry();if(f){var a=f.getExtent();i.push(a),r.push(e)}else this.nullGeometryFeatures_[o]=e}this.featuresRtree_&&this.featuresRtree_.load(i,r),s=0;for(var c=n.length;s<c;s++)this.dispatchEvent(new Ch("addfeature",n[s]))},i.prototype.bindFeaturesCollection_=function(t){var i=!1;this.addEventListener("addfeature",(function(n){i||(i=!0,t.push(n.feature),i=!1)})),this.addEventListener("removefeature",(function(n){i||(i=!0,t.remove(n.feature),i=!1)})),t.addEventListener("add",function(t){i||(i=!0,this.addFeature(t.element),i=!1)}.bind(this)),t.addEventListener("remove",function(t){i||(i=!0,this.removeFeature(t.element),i=!1)}.bind(this)),this.featuresCollection_=t},i.prototype.clear=function(t){if(t){for(var i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(yt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var n in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var r=new Ch("clear");this.dispatchEvent(r),this.changed()},i.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},i.prototype.forEachFeatureAtCoordinateDirect=function(t,i){return this.forEachFeatureInExtent([t[0],t[1],t[0],t[1]],(function(n){return n.getGeometry().intersectsCoordinate(t)?i(n):void 0}))},i.prototype.forEachFeatureInExtent=function(t,i){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,i);this.featuresCollection_&&this.featuresCollection_.forEach(i)},i.prototype.forEachFeatureIntersectingExtent=function(t,i){return this.forEachFeatureInExtent(t,(function(n){if(n.getGeometry().intersectsExtent(t)){var r=i(n);if(r)return r}}))},i.prototype.getFeaturesCollection=function(){return this.featuresCollection_},i.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),mt(this.nullGeometryFeatures_)||u(t,_t(this.nullGeometryFeatures_))),t},i.prototype.getFeaturesAtCoordinate=function(t){var i=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){i.push(t)})),i},i.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray():[]},i.prototype.getClosestFeatureToCoordinate=function(t,i){var n=t[0],r=t[1],s=null,h=[NaN,NaN],o=1/0,u=[-1/0,-1/0,1/0,1/0],e=i||f;return this.featuresRtree_.forEachInExtent(u,(function(t){if(e(t)){var i=t.getGeometry(),f=o;if((o=i.closestPointXY(n,r,h,o))<f){s=t;var a=Math.sqrt(o);u[0]=n-a,u[1]=r-a,u[2]=n+a,u[3]=r+a}}})),s},i.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},i.prototype.getFeatureById=function(t){var i=this.idIndex_[t.toString()];return void 0!==i?i:null},i.prototype.getFeatureByUid=function(t){var i=this.uidIndex_[t];return void 0!==i?i:null},i.prototype.getFormat=function(){return this.format_},i.prototype.getOverlaps=function(){return this.overlaps_},i.prototype.getUrl=function(){return this.url_},i.prototype.handleFeatureChange_=function(t){var i=t.target,n=d(i),r=i.getGeometry();if(r){var s=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(s,i)):this.featuresRtree_&&this.featuresRtree_.update(s,i)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(i),this.nullGeometryFeatures_[n]=i);var h=i.getId();if(void 0!==h){var o=h.toString();this.idIndex_[o]!==i&&(this.removeFromIdIndex_(i),this.idIndex_[o]=i)}else this.removeFromIdIndex_(i),this.uidIndex_[n]=i;this.changed(),this.dispatchEvent(new Ch("changefeature",i))},i.prototype.hasFeature=function(t){var i=t.getId();return void 0!==i?i in this.idIndex_:d(t)in this.uidIndex_},i.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&mt(this.nullGeometryFeatures_)},i.prototype.loadFeatures=function(t,i,n){var r=this.loadedExtentsRtree_,s=this.strategy_(t,i);this.loading=!1;for(var h=function(t){var h=s[t];r.forEachInExtent(h,(function(t){return S(t.extent,h)}))||(o.loader_.call(o,h,i,n),r.insert(h,{extent:h.slice()}),o.loading=o.loader_!==c)},o=this,u=0,e=s.length;u<e;++u)h(u)},i.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),t.prototype.refresh.call(this)},i.prototype.removeLoadedExtent=function(t){var i,n=this.loadedExtentsRtree_;n.forEachInExtent(t,(function(n){if(I(n.extent,t))return i=n,!0})),i&&n.remove(i)},i.prototype.removeFeature=function(t){var i=d(t);i in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[i]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},i.prototype.removeFeatureInternal=function(t){var i=d(t);this.featureChangeKeys_[i].forEach(yt),delete this.featureChangeKeys_[i];var n=t.getId();void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[i],this.dispatchEvent(new Ch("removefeature",t))},i.prototype.removeFromIdIndex_=function(t){var i=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],i=!0;break}return i},i.prototype.setLoader=function(t){this.loader_=t},i.prototype.setUrl=function(t){w(this.format_,7),this.setLoader(Ih(t,this.format_))},i}(Eh),Lh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rh=function(t){function i(i){return(i=dt({},i)).controls||(i.controls=function(){var t={},i=new yn;return(void 0===t.zoom||t.zoom)&&i.push(new Pr(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&i.push(new Nr(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&i.push(new kr(t.attributionOptions)),i}()),i.interactions||(i.interactions=function(){var t={onFocusOnly:!0}||{},i=new yn,n=new cs(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&i.push(new Qr),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&i.push(new zr({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&i.push(new Hr({onFocusOnly:t.onFocusOnly,kinetic:n})),(void 0===t.pinchRotate||t.pinchRotate)&&i.push(new ps),(void 0===t.pinchZoom||t.pinchZoom)&&i.push(new ms({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(i.push(new es),i.push(new as({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&i.push(new ls({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&i.push(new os({duration:t.zoomDuration})),i}()),t.call(this,i)||this}return Lh(i,t),i.prototype.createRenderer=function(){return new Mn(this)},i}(Or),Dh=function(){function t(t,i,n,r){this.minX=t,this.maxX=i,this.minY=n,this.maxY=r}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function Xh(t,i,n,r,s){return void 0!==s?(s.minX=t,s.maxX=i,s.minY=n,s.maxY=r,s):new Dh(t,i,n,r)}var Gh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yh=function(t){function i(i){var n=t.call(this,i)||this;return n.extentChanged=!0,n.renderedExtent_=null,n.renderedProjection=null,n.renderedTiles=[],n.newTiles_=!1,n.tmpExtent=[1/0,1/0,-1/0,-1/0],n.tmpTileRange_=new Dh(0,0,0,0),n}return Gh(i,t),i.prototype.isDrawableTile=function(t){var i=this.getLayer(),n=t.getState(),r=i.getUseInterimTilesOnError();return 2==n||4==n||3==n&&!r},i.prototype.getTile=function(t,i,n,r){var s=r.pixelRatio,h=r.viewState.projection,o=this.getLayer(),u=o.getSource().getTile(t,i,n,s,h);return 3==u.getState()&&(o.getUseInterimTilesOnError()?o.getPreload()>0&&(this.newTiles_=!0):u.setState(2)),this.isDrawableTile(u)||(u=u.getInterimTile()),u},i.prototype.loadedTileCallback=function(i,n,r){return!!this.isDrawableTile(r)&&t.prototype.loadedTileCallback.call(this,i,n,r)},i.prototype.prepareFrame=function(){return!!this.getLayer().getSource()},i.prototype.renderFrame=function(t,i){var n=t.layerStatesArray[t.layerIndex],r=t.viewState,h=r.projection,o=r.resolution,u=r.center,e=r.rotation,f=t.pixelRatio,a=this.getLayer(),c=a.getSource(),v=c.getRevision(),l=c.getTileGridForProjection(h),p=l.getZForResolution(o,c.zDirection),_=l.getResolution(p),m=t.extent,w=n.extent&&n.extent;w&&(m=U(m,n.extent));var O=c.getTilePixelRatio(f),j=Math.round(t.size[0]*O),x=Math.round(t.size[1]*O);if(e){var A=Math.round(Math.sqrt(j*j+x*x));j=A,x=A}var k=_*j/2/O,S=_*x/2/O,N=[u[0]-k,u[1]-S,u[0]+k,u[1]+S],E=l.getTileRangeForExtentAndZ(m,p),P={};P[p]={};var T=this.createLoadedTileFinder(c,h,P),F=this.tmpExtent,C=this.tmpTileRange_;this.newTiles_=!1;for(var z=E.minX;z<=E.maxX;++z)for(var L=E.minY;L<=E.maxY;++L){var R=this.getTile(p,z,L,t);if(this.isDrawableTile(R)){var D=d(this);if(2==R.getState()){P[p][R.tileCoord.toString()]=R;var X=R.inTransition(D);this.newTiles_||!X&&-1!==this.renderedTiles.indexOf(R)||(this.newTiles_=!0)}if(1===R.getAlpha(D,t.time))continue}var G=l.getTileCoordChildTileRange(R.tileCoord,C,F),Y=!1;G&&(Y=T(p+1,G)),Y||l.forEachTileCoordParentTileRange(R.tileCoord,T,C,F)}var W=_/o;g(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/O,1/O,e,-j/2,-x/2);var Z=function(t){return Yt?y(t):(vi||(vi=Ut(1,1).canvas),vi.style.transform=y(t),vi.style.transform)}(this.pixelTransform);this.useContainer(i,Z,n.opacity);var V=this.context,J=V.canvas;b(this.inversePixelTransform,this.pixelTransform),g(this.tempTransform,j/2,x/2,W,W,0,-j/2,-x/2),J.width!=j||J.height!=x?(J.width=j,J.height=x):this.containerReused||V.clearRect(0,0,j,x),w&&this.clipUnrotated(V,t,w),dt(V,c.getContextOptions()),this.preRender(V,t),this.renderedTiles.length=0;var $,B,H,K=Object.keys(P).map(Number);K.sort(s),1!==n.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?($=[],B=[]):K=K.reverse();for(var Q=K.length-1;Q>=0;--Q){var tt=K[Q],it=c.getTilePixelSize(tt,f,h),nt=l.getResolution(tt)/_,rt=it[0]*nt*W,st=it[1]*nt*W,ht=l.getTileCoordForCoordAndZ(q(N),tt),ot=l.getTileCoordExtent(ht),ut=M(this.tempTransform,[O*(ot[0]-N[0])/_,O*(N[3]-ot[3])/_]),et=O*c.getGutterForProjection(h),ft=P[tt];for(var at in ft){var ct=(R=ft[at]).tileCoord,vt=ut[0]-(ht[1]-ct[1])*rt,lt=Math.round(vt+rt),pt=ut[1]-(ht[2]-ct[2])*st,_t=Math.round(pt+st),mt=lt-(z=Math.round(vt)),wt=_t-(L=Math.round(pt)),Mt=p===tt;if(!(X=Mt&&1!==R.getAlpha(d(this),t.time)))if($){V.save(),H=[z,L,z+mt,L,z+mt,L+wt,z,L+wt];for(var gt=0,bt=$.length;gt<bt;++gt)if(p!==tt&&tt<B[gt]){var yt=$[gt];V.beginPath(),V.moveTo(H[0],H[1]),V.lineTo(H[2],H[3]),V.lineTo(H[4],H[5]),V.lineTo(H[6],H[7]),V.moveTo(yt[6],yt[7]),V.lineTo(yt[4],yt[5]),V.lineTo(yt[2],yt[3]),V.lineTo(yt[0],yt[1]),V.clip()}$.push(H),B.push(tt)}else V.clearRect(z,L,mt,wt);this.drawTileImage(R,t,z,L,mt,wt,et,Mt,n.opacity),$&&!X&&V.restore(),this.renderedTiles.push(R),this.updateUsedTiles(t.usedTiles,c,R)}}return this.renderedRevision=v,this.renderedResolution=_,this.extentChanged=!this.renderedExtent_||!I(this.renderedExtent_,N),this.renderedExtent_=N,this.renderedPixelRatio=f,this.renderedProjection=h,this.manageTilePyramid(t,c,l,f,h,m,p,a.getPreload()),this.scheduleExpireCache(t,c),this.postRender(V,t),n.extent&&V.restore(),Z!==J.style.transform&&(J.style.transform=Z),this.container},i.prototype.drawTileImage=function(t,i,n,r,s,h,o,u,e){var f=this.getTileImage(t);if(f){var a=d(this),c=u?t.getAlpha(a,i.time):1,v=e*c,l=v!==this.context.globalAlpha;l&&(this.context.save(),this.context.globalAlpha=v),this.context.drawImage(f,o,o,f.width-2*o,f.height-2*o,n,r,s,h),l&&this.context.restore(),1!==c?i.animate=!0:u&&t.endTransition(a)}},i.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},i.prototype.getTileImage=function(t){return t.getImage()},i.prototype.scheduleExpireCache=function(t,i){if(i.canExpireCache()){var n=function(t,i,n){var r=d(t);r in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[r])}.bind(null,i);t.postRenderFunctions.push(n)}},i.prototype.updateUsedTiles=function(t,i,n){var r=d(i);r in t||(t[r]={}),t[r][n.getKey()]=!0},i.prototype.manageTilePyramid=function(t,i,n,r,s,h,o,u,e){var f=d(i);f in t.wantedTiles||(t.wantedTiles[f]={});var a,c,v,l,p,_,m=t.wantedTiles[f],w=t.tileQueue,M=0;for(_=n.getMinZoom();_<=o;++_)for(c=n.getTileRangeForExtentAndZ(h,_,c),v=n.getResolution(_),l=c.minX;l<=c.maxX;++l)for(p=c.minY;p<=c.maxY;++p)o-_<=u?(++M,0==(a=i.getTile(_,l,p,r,s)).getState()&&(m[a.getKey()]=!0,w.isKeyQueued(a.getKey())||w.enqueue([a,f,n.getTileCoordCenter(a.tileCoord),v])),void 0!==e&&e(a)):i.useTile(_,l,p,s);i.updateCacheSize(M,s)},i}(th);var Wh=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zh=function(t){function i(i,n,r){var s=t.call(this)||this,h=r||{};return s.tileCoord=i,s.state=n,s.interimTile=null,s.hifi=!0,s.key="",s.transition_=void 0===h.transition?250:h.transition,s.transitionStarts_={},s}return Wh(i,t),i.prototype.changed=function(){this.dispatchEvent("change")},i.prototype.release=function(){},i.prototype.getKey=function(){return this.key+"/"+this.tileCoord},i.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this},i.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,i=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?i=t:0==t.getState()?i.interimTile=t.interimTile:i=t,t=i.interimTile}while(t)}},i.prototype.getTileCoord=function(){return this.tileCoord},i.prototype.getState=function(){return this.state},i.prototype.setState=function(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},i.prototype.load=function(){v()},i.prototype.getAlpha=function(t,i){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else this.transitionStarts_[t]=n=i;var r=i-n+1e3/60;return r>=this.transition_?1:Wn(r/this.transition_)},i.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},i.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},i}(Mt),Uh=function(){function t(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},t.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},t.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},t.prototype.forEach=function(t){for(var i=this.oldest_;i;)t(i.value_,i.key_,this),i=i.newer},t.prototype.get=function(t){var i=this.entries_[t];return w(void 0!==i,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_},t.prototype.remove=function(t){var i=this.entries_[t];return w(void 0!==i,15),i===this.newest_?(this.newest_=i.older,this.newest_&&(this.newest_.newer=null)):i===this.oldest_?(this.oldest_=i.newer,this.oldest_&&(this.oldest_.older=null)):(i.newer.older=i.older,i.older.newer=i.newer),delete this.entries_[t],--this.count_,i.value_},t.prototype.getCount=function(){return this.count_},t.prototype.getKeys=function(){var t,i=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)i[n++]=t.key_;return i},t.prototype.getValues=function(){var t,i=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)i[n++]=t.value_;return i},t.prototype.peekLast=function(){return this.oldest_.value_},t.prototype.peekLastKey=function(){return this.oldest_.key_},t.prototype.peekFirstKey=function(){return this.newest_.key_},t.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},t.prototype.replace=function(t,i){this.get(t),this.entries_[t].value_=i},t.prototype.set=function(t,i){w(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:i};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_},t.prototype.setSize=function(t){this.highWaterMark=t},t}();function qh(t,i,n,r){return void 0!==r?(r[0]=t,r[1]=i,r[2]=n,r):[t,i,n]}function Vh(t,i,n){return t+"/"+i+"/"+n}function Jh(t){return Vh(t[0],t[1],t[2])}var $h=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bh=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return $h(i,t),i.prototype.expireCache=function(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()},i.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=(i=this.peekFirstKey(),i.split("/").map(Number))[0];this.forEach(function(i){i.tileCoord[0]!==t&&(this.remove(Jh(i.tileCoord)),i.release())}.bind(this))}var i},i}(Uh);var Hh=[0,0,0],Kh=function(){function t(t){var i,n,r;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,w((!0,n=function(t,i){return i-t}||s,(i=this.resolutions_).every((function(t,r){if(0===r)return!0;var s=n(i[r-1],t);return!(s>0||0===s)}))),17),!t.origins)for(var h=0,o=this.resolutions_.length-1;h<o;++h)if(r){if(this.resolutions_[h]/this.resolutions_[h+1]!==r){r=void 0;break}}else r=this.resolutions_[h]/this.resolutions_[h+1];this.zoomFactor_=r,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,w(this.origins_.length==this.resolutions_.length,20));var u=t.extent;void 0===u||this.origin_||this.origins_||(this.origin_=q(u)),w(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,w(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,w(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==u?u:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t){return new Dh(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):u&&this.calculateTileRanges_(u)}return t.prototype.forEachTileCoord=function(t,i,n){for(var r=this.getTileRangeForExtentAndZ(t,i),s=r.minX,h=r.maxX;s<=h;++s)for(var o=r.minY,u=r.maxY;o<=u;++o)n([i,s,o])},t.prototype.forEachTileCoordParentTileRange=function(t,i,n,r){var s,h,o=null,u=t[0]-1;for(2===this.zoomFactor_?(s=t[1],h=t[2]):o=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(i(u,2===this.zoomFactor_?Xh(s=Math.floor(s/2),s,h=Math.floor(h/2),h,n):this.getTileRangeForExtentAndZ(o,u,n)))return!0;--u}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,i,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*t[1],s=2*t[2];return Xh(r,r+1,s,s+1,i)}var h=this.getTileCoordExtent(t,n);return this.getTileRangeForExtentAndZ(h,t[0]+1,i)}return null},t.prototype.getTileRangeExtent=function(t,i,n){var r=this.getOrigin(t),s=this.getResolution(t),h=br(this.getTileSize(t),this.tmpSize_);return P(r[0]+i.minX*h[0]*s,r[1]+i.minY*h[1]*s,r[0]+(i.maxX+1)*h[0]*s,r[1]+(i.maxY+1)*h[1]*s,n)},t.prototype.getTileRangeForExtentAndZ=function(t,i,n){var r=Hh;this.getTileCoordForXYAndZ_(t[0],t[3],i,!1,r);var s=r[1],h=r[2];return this.getTileCoordForXYAndZ_(t[2],t[1],i,!0,r),Xh(s,r[1],h,r[2],n)},t.prototype.getTileCoordCenter=function(t){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=br(this.getTileSize(t[0]),this.tmpSize_);return[i[0]+(t[1]+.5)*r[0]*n,i[1]-(t[2]+.5)*r[1]*n]},t.prototype.getTileCoordExtent=function(t,i){var n=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=br(this.getTileSize(t[0]),this.tmpSize_),h=n[0]+t[1]*s[0]*r,o=n[1]-(t[2]+1)*s[1]*r;return P(h,o,h+s[0]*r,o+s[1]*r,i)},t.prototype.getTileCoordForCoordAndResolution=function(t,i,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],i,!1,n)},t.prototype.getTileCoordForXYAndResolution_=function(t,i,n,r,s){var h=this.getZForResolution(n),o=n/this.getResolution(h),u=this.getOrigin(h),e=br(this.getTileSize(h),this.tmpSize_),f=r?.5:0,a=Math.floor((t-u[0])/n+(r?.5:0)),c=Math.floor((u[1]-i)/n+f),v=o*a/e[0],l=o*c/e[1];return r?(v=Math.ceil(v)-1,l=Math.ceil(l)-1):(v=Math.floor(v),l=Math.floor(l)),qh(h,v,l,s)},t.prototype.getTileCoordForXYAndZ_=function(t,i,n,r,s){var h=this.getOrigin(n),o=this.getResolution(n),u=br(this.getTileSize(n),this.tmpSize_),e=r?.5:0,f=Math.floor((t-h[0])/o+(r?.5:0)),a=Math.floor((h[1]-i)/o+e),c=f/u[0],v=a/u[1];return r?(c=Math.ceil(c)-1,v=Math.ceil(v)-1):(c=Math.floor(c),v=Math.floor(v)),qh(n,c,v,s)},t.prototype.getTileCoordForCoordAndZ=function(t,i,n){return this.getTileCoordForXYAndZ_(t[0],t[1],i,!1,n)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},t.prototype.getZForResolution=function(t,i){return H(h(this.resolutions_,t,i||0),this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var i=this.resolutions_.length,n=new Array(i),r=this.minZoom;r<i;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n},t}();function Qh(t){var i=t.getDefaultTileGrid();return i||(i=function(t){return function(t,i,n){var r=to(t,undefined,n);return new Kh({extent:t,origin:Y(t,"top-left"),resolutions:r,tileSize:n})}(io(t),0,void 0)}(t),t.setDefaultTileGrid(i)),i}function to(t,i,n,r){for(var s=void 0!==i?i:42,h=Z(t),o=J(t),u=br(void 0!==n?n:256),e=r>0?r:Math.max(o/u[0],h/u[1]),f=s+1,a=new Array(f),c=0;c<f;++c)a[c]=e/Math.pow(2,c);return a}function io(t){var i=(t=Gi(t)).getExtent();if(!i){var n=180*pi.degrees/t.getMetersPerUnit();i=P(-n,-n,n,n)}return i}var no=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ro=function(t){function i(i){var n=t.call(this,{attributions:i.attributions,attributionsCollapsible:i.attributionsCollapsible,projection:i.projection,state:i.state,wrapX:i.wrapX})||this;n.opaque_=void 0!==i.opaque&&i.opaque,n.tilePixelRatio_=void 0!==i.tilePixelRatio?i.tilePixelRatio:1,n.tileGrid=void 0!==i.tileGrid?i.tileGrid:null;var r=i.tileGrid;return r&&br(r.getTileSize(r.getMinZoom()),[256,256]),n.tileCache=new Bh(i.cacheSize||0),n.tmpSize=[0,0],n.key_=i.key||"",n.tileOptions={transition:i.transition},n.zDirection=i.zDirection?i.zDirection:0,n}return no(i,t),i.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},i.prototype.expireCache=function(t,i){var n=this.getTileCacheForProjection(t);n&&n.expireCache(i)},i.prototype.forEachLoadedTile=function(t,i,n,r){var s=this.getTileCacheForProjection(t);if(!s)return!1;for(var h,o,u,e=!0,f=n.minX;f<=n.maxX;++f)for(var a=n.minY;a<=n.maxY;++a)o=Vh(i,f,a),u=!1,s.containsKey(o)&&(u=2===(h=s.get(o)).getState())&&(u=!1!==r(h)),u||(e=!1);return e},i.prototype.getGutterForProjection=function(){return 0},i.prototype.getKey=function(){return this.key_},i.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},i.prototype.getOpaque=function(){return this.opaque_},i.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},i.prototype.getTile=function(){return v()},i.prototype.getTileGrid=function(){return this.tileGrid},i.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:Qh(t)},i.prototype.getTileCacheForProjection=function(t){var i=this.getProjection();return i&&!qi(i,t)?null:this.tileCache},i.prototype.getTilePixelRatio=function(){return this.tilePixelRatio_},i.prototype.getTilePixelSize=function(t,i,n){var r,s,h,o=this.getTileGridForProjection(n),u=this.getTilePixelRatio(i),e=br(o.getTileSize(t),this.tmpSize);return 1==u?e:(void 0===(h=this.tmpSize)&&(h=[0,0]),h[0]=(r=e)[0]*(s=u)+.5|0,h[1]=r[1]*s+.5|0,h)},i.prototype.getTileCoordForTileUrlFunction=function(t,i){var n=void 0!==i?i:this.getProjection(),r=this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=function(t,i,n){var r=i[0],s=t.getTileCoordCenter(i),h=io(n);if(k(h,s))return i;var o=J(h),u=Math.ceil((h[0]-s[0])/o);return s[0]+=o*u,t.getTileCoordForCoordAndZ(s,r)}(r,t,n)),function(t,i){var n=t[0],r=t[1],s=t[2];if(i.getMinZoom()>n||n>i.getMaxZoom())return!1;var h,o=i.getExtent();return!(h=o?i.getTileRangeForExtentAndZ(o,n):i.getFullTileRange(n))||h.containsXY(r,s)}(t,r)?t:null},i.prototype.clear=function(){this.tileCache.clear()},i.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},i.prototype.updateCacheSize=function(t,i){var n=this.getTileCacheForProjection(i);t>n.highWaterMark&&(n.highWaterMark=t)},i.prototype.useTile=function(){},i}(Eh),so=function(t){function i(i,n){var r=t.call(this,i)||this;return r.tile=n,r}return no(i,t),i}(lt);function ho(t,i){var n=/\{z\}/g,r=/\{x\}/g,s=/\{y\}/g,h=/\{-y\}/g;return function(o){return o?t.replace(n,o[0].toString()).replace(r,o[1].toString()).replace(s,o[2].toString()).replace(h,(function(){var t=i.getFullTileRange(o[0]);return w(t,55),(t.getHeight()-o[2]-1).toString()})):void 0}}var oo,uo=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),eo=function(t){function i(n){var r=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,opaque:n.opaque,projection:n.projection,state:n.state,tileGrid:n.tileGrid,tilePixelRatio:n.tilePixelRatio,wrapX:n.wrapX,transition:n.transition,key:n.key,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this;return r.generateTileUrlFunction_=r.tileUrlFunction===i.prototype.tileUrlFunction,r.tileLoadFunction=n.tileLoadFunction,n.tileUrlFunction&&(r.tileUrlFunction=n.tileUrlFunction.bind(r)),r.urls=null,n.urls?r.setUrls(n.urls):n.url&&r.setUrl(n.url),r.tileLoadingKeys_={},r}return uo(i,t),i.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},i.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},i.prototype.getUrls=function(){return this.urls},i.prototype.handleTileChange=function(t){var i,n=t.target,r=d(n),s=n.getState();1==s?(this.tileLoadingKeys_[r]=!0,i="tileloadstart"):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],i=3==s?"tileloaderror":2==s?"tileloadend":void 0),null!=i&&this.dispatchEvent(new so(i,n))},i.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},i.prototype.setTileUrlFunction=function(t,i){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==i?this.setKey(i):this.changed()},i.prototype.setUrl=function(t){var i=function(t){var i=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var r=n[1].charCodeAt(0),s=n[2].charCodeAt(0),h=void 0;for(h=r;h<=s;++h)i.push(t.replace(n[0],String.fromCharCode(h)));return i}if(n=/\{(\d+)-(\d+)\}/.exec(t)){for(var o=parseInt(n[2],10),u=parseInt(n[1],10);u<=o;u++)i.push(t.replace(n[0],u.toString()));return i}return i.push(t),i}(t);this.urls=i,this.setUrls(i)},i.prototype.setUrls=function(t){this.urls=t;var i=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,i){for(var n=t.length,r=new Array(n),s=0;s<n;++s)r[s]=ho(t[s],i);return function(t){return 1===t.length?t[0]:function(i,n,r){if(i){var s=rt(function(t){return(t[1]<<t[0])+t[2]}(i),t.length);return t[s](i,n,r)}}}(r)}(t,this.tileGrid),i):this.setKey(i)},i.prototype.tileUrlFunction=function(){},i.prototype.useTile=function(t,i,n){var r=Vh(t,i,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)},i}(ro),fo=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ao=function(t){function i(i){var n=this,r=i||{},s=dt({},r);return delete s.preload,delete s.useInterimTilesOnError,(n=t.call(this,s)||this).setPreload(void 0!==r.preload?r.preload:0),n.setUseInterimTilesOnError(void 0===r.useInterimTilesOnError||r.useInterimTilesOnError),n}return fo(i,t),i.prototype.getPreload=function(){return this.get("preload")},i.prototype.setPreload=function(t){this.set("preload",t)},i.prototype.getUseInterimTilesOnError=function(){return this.get("useInterimTilesOnError")},i.prototype.setUseInterimTilesOnError=function(t){this.set("useInterimTilesOnError",t)},i}(It),co=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vo=function(t){function i(i){return t.call(this,i)||this}return co(i,t),i.prototype.createRenderer=function(){return new Yh(this)},i}(ao),lo=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),po=function(t){function i(i,n,r,s,h,o){var u=t.call(this,i,n,o)||this;return u.crossOrigin_=s,u.src_=r,u.image_=new Image,null!==s&&(u.image_.crossOrigin=s),u.unlisten_=null,u.tileLoadFunction_=h,u}return lo(i,t),i.prototype.getImage=function(){return this.image_},i.prototype.getKey=function(){return this.src_},i.prototype.handleImageError_=function(){var t;this.state=3,this.unlistenImage_(),this.image_=((t=Ut(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},i.prototype.handleImageLoad_=function(){var t=this.image_;this.state=t.naturalWidth&&t.naturalHeight?2:4,this.unlistenImage_(),this.changed()},i.prototype.load=function(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=wh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},i.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},i}(Zh),_o=function(){function t(t,i,n,r,s,h){this.sourceProj_=t,this.targetProj_=i;var o={},u=Ji(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var i=t[0]+"/"+t[1];return o[i]||(o[i]=u(t)),o[i]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&J(r)==J(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?J(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?J(this.targetProj_.getExtent()):null;var e=q(n),f=V(n),a=X(n),c=D(n),v=this.transformInv_(e),l=this.transformInv_(f),d=this.transformInv_(a),p=this.transformInv_(c),_=10+(h?Math.max(0,Math.ceil(Q(R(n)/(h*h*256*256)))):0);if(this.addQuad_(e,f,a,c,v,l,d,p,_),this.wrapsXInSource_){var m=1/0;this.triangles_.forEach((function(t){m=Math.min(m,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-m>this.sourceWorldWidth_/2){var i=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];i[0][0]-m>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-m>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-m>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);var n=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-n<this.sourceWorldWidth_/2&&(t.source=i)}}.bind(this))}o={}}return t.prototype.addTriangle_=function(t,i,n,r,s,h){this.triangles_.push({source:[r,s,h],target:[t,i,n]})},t.prototype.addQuad_=function(t,i,n,r,s,h,o,u,e){var f=O([s,h,o,u]),a=this.sourceWorldWidth_?J(f)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,v=this.sourceProj_.canWrapX()&&a>.5&&a<1,l=!1;if(e>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(l=J(O([t,i,n,r]))/this.targetWorldWidth_>.25||l),!v&&this.sourceProj_.isGlobal()&&a&&(l=a>.25||l)),!(!l&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3]))||$(f,this.maxSourceExtent_)){var d=0;if(!(l||isFinite(s[0])&&isFinite(s[1])&&isFinite(h[0])&&isFinite(h[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(u[0])&&isFinite(u[1])))if(e>0)l=!0;else if(1!=(d=(isFinite(s[0])&&isFinite(s[1])?0:8)+(isFinite(h[0])&&isFinite(h[1])?0:4)+(isFinite(o[0])&&isFinite(o[1])?0:2)+(isFinite(u[0])&&isFinite(u[1])?0:1))&&2!=d&&4!=d&&8!=d)return;if(e>0){if(!l){var p=this.transformInv_([(t[0]+n[0])/2,(t[1]+n[1])/2]),_=void 0;_=v?(rt(s[0],c)+rt(o[0],c))/2-rt(p[0],c):(s[0]+o[0])/2-p[0];var m=(s[1]+o[1])/2-p[1];l=_*_+m*m>this.errorThresholdSquared_}if(l){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var w=[(i[0]+n[0])/2,(i[1]+n[1])/2],M=this.transformInv_(w),g=[(r[0]+t[0])/2,(r[1]+t[1])/2],b=this.transformInv_(g);this.addQuad_(t,i,w,g,s,h,M,b,e-1),this.addQuad_(g,w,n,r,b,M,o,u,e-1)}else{var y=[(t[0]+i[0])/2,(t[1]+i[1])/2],j=this.transformInv_(y),x=[(n[0]+r[0])/2,(n[1]+r[1])/2],A=this.transformInv_(x);this.addQuad_(t,y,x,r,s,j,A,u,e-1),this.addQuad_(y,i,n,x,j,h,o,A,e-1)}return}}if(v){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&d)&&this.addTriangle_(t,n,r,s,o,u),0==(14&d)&&this.addTriangle_(t,n,i,s,o,h),d&&(0==(13&d)&&this.addTriangle_(i,r,t,h,u,s),0==(7&d)&&this.addTriangle_(i,r,n,h,u,o))}},t.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(i){var n=i.source;F(t,n[0]),F(t,n[1]),F(t,n[2])})),t},t.prototype.getTriangles=function(){return this.triangles_},t}(),mo={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1};function wo(t,i,n,r,s){t.beginPath(),t.moveTo(0,0),t.lineTo(i,n),t.lineTo(r,s),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(i,r)+1,Math.max(n,s)),t.restore()}function Mo(t,i){return Math.abs(t[4*i]-210)>2||Math.abs(t[4*i+3]-191.25)>2}function go(t,i,n,r){var s=$i(n,i,t),h=Yi(i,r,n),o=i.getMetersPerUnit();void 0!==o&&(h*=o);var u=t.getMetersPerUnit();void 0!==u&&(h/=u);var e=t.getExtent();if(!e||k(e,s)){var f=Yi(t,h,s)/h;isFinite(f)&&f>0&&(h/=f)}return h}var bo=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yo=function(t){function i(i,n,r,s,h,o,u,e,f,a,c,v){var l=t.call(this,h,0)||this;l.renderEdges_=void 0!==c&&c,l.contextOptions_=v,l.pixelRatio_=u,l.gutter_=e,l.canvas_=null,l.sourceTileGrid_=n,l.targetTileGrid_=s,l.wrappedTileCoord_=o||h,l.sourceTiles_=[],l.sourcesListenerKeys_=null,l.sourceZ_=0;var d=s.getTileCoordExtent(l.wrappedTileCoord_),p=l.targetTileGrid_.getExtent(),_=l.sourceTileGrid_.getExtent(),m=p?U(d,p):d;if(0===R(m))return l.state=4,l;var w=i.getExtent();w&&(_=_?U(_,w):w);var M=s.getResolution(l.wrappedTileCoord_[0]),g=function(t,i,n,r){var s=G(n),h=go(t,i,s,r);return(!isFinite(h)||h<=0)&&L(n,(function(n){return h=go(t,i,n,r),isFinite(h)&&h>0})),h}(i,r,m,M);if(!isFinite(g)||g<=0)return l.state=4,l;if(l.triangulation_=new _o(i,r,m,_,g*(void 0!==a?a:.5),M),0===l.triangulation_.getTriangles().length)return l.state=4,l;l.sourceZ_=n.getZForResolution(g);var b=l.triangulation_.calculateSourceExtent();if(_&&(i.canWrapX()?(b[1]=H(b[1],_[1],_[3]),b[3]=H(b[3],_[1],_[3])):b=U(b,_)),R(b)){for(var y=n.getTileRangeForExtentAndZ(b,l.sourceZ_),O=y.minX;O<=y.maxX;O++)for(var j=y.minY;j<=y.maxY;j++){var x=f(l.sourceZ_,O,j,u);x&&l.sourceTiles_.push(x)}0===l.sourceTiles_.length&&(l.state=4)}else l.state=4;return l}return bo(i,t),i.prototype.getImage=function(){return this.canvas_},i.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(i){i&&2==i.getState()&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(i.tileCoord),image:i.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=3;else{var i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),r="number"==typeof n?n:n[0],s="number"==typeof n?n:n[1],h=this.targetTileGrid_.getResolution(i),o=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,i,n,r,s,h,o,u,e,f,a,c){var v=Ut(Math.round(n*t),Math.round(n*i));if(dt(v,c),0===e.length)return v.canvas;function l(t){return Math.round(t*n)/n}v.scale(n,n),v.globalCompositeOperation="lighter";var d=[1/0,1/0,-1/0,-1/0];e.forEach((function(t){var i,n;(n=t.extent)[0]<(i=d)[0]&&(i[0]=n[0]),n[2]>i[2]&&(i[2]=n[2]),n[1]<i[1]&&(i[1]=n[1]),n[3]>i[3]&&(i[3]=n[3])}));var p=J(d),_=Z(d),m=Ut(Math.round(n*p/r),Math.round(n*_/r));dt(m,c);var w=n/r;e.forEach((function(t){var i=t.extent[0]-d[0],n=-(t.extent[3]-d[3]),r=J(t.extent),s=Z(t.extent);t.image.width>0&&t.image.height>0&&m.drawImage(t.image,f,f,t.image.width-2*f,t.image.height-2*f,i*w,n*w,r*w,s*w)}));var M=q(o);return u.getTriangles().forEach((function(t){var i=t.source,s=t.target,o=i[0][0],u=i[0][1],e=i[1][0],f=i[1][1],a=i[2][0],p=i[2][1],_=l((s[0][0]-M[0])/h),w=l(-(s[0][1]-M[1])/h),g=l((s[1][0]-M[0])/h),b=l(-(s[1][1]-M[1])/h),y=l((s[2][0]-M[0])/h),O=l(-(s[2][1]-M[1])/h),j=o,x=u;o=0,u=0;var A=function(t){for(var i=t.length,n=0;n<i;n++){for(var r=n,s=Math.abs(t[n][n]),h=n+1;h<i;h++){var o=Math.abs(t[h][n]);o>s&&(s=o,r=h)}if(0===s)return null;var u=t[r];t[r]=t[n],t[n]=u;for(var e=n+1;e<i;e++)for(var f=-t[e][n]/t[n][n],a=n;a<i+1;a++)n==a?t[e][a]=0:t[e][a]+=f*t[n][a]}for(var c=new Array(i),v=i-1;v>=0;v--){c[v]=t[v][i]/t[v][v];for(var l=v-1;l>=0;l--)t[l][i]-=t[l][v]*c[v]}return c}([[e-=j,f-=x,0,0,g-_],[a-=j,p-=x,0,0,y-_],[0,0,e,f,b-w],[0,0,a,p,O-w]]);if(A){if(v.save(),v.beginPath(),function(){if(void 0===oo){var t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",wo(t,4,5,4,0),wo(t,4,5,0,5);var i=t.getImageData(0,0,3,3).data;oo=Mo(i,0)||Mo(i,4)||Mo(i,8)}return oo}()||c===mo){v.moveTo(g,b);for(var k=_-g,S=w-b,N=0;N<4;N++)v.lineTo(g+l((N+1)*k/4),b+l(N*S/3)),3!=N&&v.lineTo(g+l((N+1)*k/4),b+l((N+1)*S/3));v.lineTo(y,O)}else v.moveTo(g,b),v.lineTo(_,w),v.lineTo(y,O);v.clip(),v.transform(A[0],A[2],A[1],A[3],_,w),v.translate(d[0]-j,d[3]-x),v.scale(r/n,-r/n),v.drawImage(m.canvas,0,0),v.restore()}})),a&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,u.getTriangles().forEach((function(t){var i=t.target,n=(i[0][0]-M[0])/h,r=-(i[0][1]-M[1])/h,s=(i[1][0]-M[0])/h,o=-(i[1][1]-M[1])/h,u=(i[2][0]-M[0])/h,e=-(i[2][1]-M[1])/h;v.beginPath(),v.moveTo(s,o),v.lineTo(n,r),v.lineTo(u,e),v.closePath(),v.stroke()})),v.restore()),v.canvas}(r,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),h,u,this.triangulation_,t,this.gutter_,this.renderEdges_,this.contextOptions_),this.state=2}this.changed()},i.prototype.load=function(){if(0==this.state){this.state=1,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(i){var n=i.getState();if(0==n||1==n){t++;var r=gt(i,"change",(function(){var n=i.getState();2!=n&&3!=n&&4!=n||(yt(r),0==--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(r)}}.bind(this)),this.sourceTiles_.forEach((function(t){0==t.getState()&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},i.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(yt),this.sourcesListenerKeys_=null},i}(Zh),Oo=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jo=function(t){function i(i){var n=t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,opaque:i.opaque,projection:i.projection,state:i.state,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction?i.tileLoadFunction:xo,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:i.wrapX,transition:i.transition,key:i.key,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this;return n.crossOrigin=void 0!==i.crossOrigin?i.crossOrigin:null,n.tileClass=void 0!==i.tileClass?i.tileClass:po,n.tileCacheForProjection={},n.tileGridForProjection={},n.reprojectionErrorThreshold_=i.reprojectionErrorThreshold,n.contextOptions_=!1===i.imageSmoothing?mo:void 0,n.renderReprojectionEdges_=!1,n}return Oo(i,t),i.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},i.prototype.expireCache=function(t,i){var n=this.getTileCacheForProjection(t);for(var r in this.tileCache.expireCache(this.tileCache==n?i:{}),this.tileCacheForProjection){var s=this.tileCacheForProjection[r];s.expireCache(s==n?i:{})}},i.prototype.getContextOptions=function(){return this.contextOptions_},i.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!qi(this.getProjection(),t)?0:this.getGutter()},i.prototype.getGutter=function(){return 0},i.prototype.getKey=function(){return t.prototype.getKey.call(this)+(this.contextOptions_?"\n"+JSON.stringify(this.contextOptions_):"")},i.prototype.getOpaque=function(i){return!(this.getProjection()&&i&&!qi(this.getProjection(),i))&&t.prototype.getOpaque.call(this,i)},i.prototype.getTileGridForProjection=function(t){var i=this.getProjection();if(!this.tileGrid||i&&!qi(i,t)){var n=d(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=Qh(t)),this.tileGridForProjection[n]}return this.tileGrid},i.prototype.getTileCacheForProjection=function(t){var i=this.getProjection();if(!i||qi(i,t))return this.tileCache;var n=d(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Bh(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]},i.prototype.createTile_=function(t,i,n,r,s,h){var o=[t,i,n],u=this.getTileCoordForTileUrlFunction(o,s),e=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(o,void 0!==e?0:4,void 0!==e?e:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=h,f.addEventListener("change",this.handleTileChange.bind(this)),f},i.prototype.getTile=function(t,i,n,r,s){var h=this.getProjection();if(h&&s&&!qi(h,s)){var o=this.getTileCacheForProjection(s),u=[t,i,n],e=void 0,f=Jh(u);o.containsKey(f)&&(e=o.get(f));var a=this.getKey();if(e&&e.key==a)return e;var c=this.getTileGridForProjection(h),v=this.getTileGridForProjection(s),l=this.getTileCoordForTileUrlFunction(u,s),d=new yo(h,c,s,v,u,l,this.getTilePixelRatio(r),this.getGutter(),function(t,i,n,r){return this.getTileInternal(t,i,n,r,h)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.contextOptions_);return d.key=a,e?(d.interimTile=e,d.refreshInterimChain(),o.replace(f,d)):o.set(f,d),d}return this.getTileInternal(t,i,n,r,h||s)},i.prototype.getTileInternal=function(t,i,n,r,s){var h=null,o=Vh(t,i,n),u=this.getKey();if(this.tileCache.containsKey(o)){if((h=this.tileCache.get(o)).key!=u){var e=h;(h=this.createTile_(t,i,n,r,s,u)).interimTile=0==e.getState()?e.interimTile:e,h.refreshInterimChain(),this.tileCache.replace(o,h)}}else h=this.createTile_(t,i,n,r,s,u),this.tileCache.set(o,h);return h},i.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var i in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[i].clear();this.changed()}},i.prototype.setTileGridForProjection=function(t,i){var n=Gi(t);if(n){var r=d(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=i)}},i}(eo);function xo(t,i){t.getImage().src=i}var Ao=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ko=function(t){function i(i){var n=i||{},r=void 0!==n.projection?n.projection:"EPSG:3857",s=void 0!==n.tileGrid?n.tileGrid:function(t){var i=t||{},n=i.extent||Gi("EPSG:3857").getExtent(),r={extent:n,minZoom:i.minZoom,tileSize:i.tileSize,resolutions:to(n,i.maxZoom,i.tileSize,i.maxResolution)};return new Kh(r)}({extent:io(r),maxResolution:n.maxResolution,maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});return t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,imageSmoothing:n.imageSmoothing,opaque:n.opaque,projection:r,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:s,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this}return Ao(i,t),i}(jo),So=function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function r(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),No=function(t){function i(i){var n=i||{};return t.call(this,{attributions:void 0!==n.attributions?n.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'],cacheSize:n.cacheSize,crossOrigin:void 0!==n.crossOrigin?n.crossOrigin:"anonymous",imageSmoothing:n.imageSmoothing,opaque:void 0===n.opaque||n.opaque,maxZoom:void 0!==n.maxZoom?n.maxZoom:19,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,url:void 0!==n.url?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",wrapX:n.wrapX,attributionsCollapsible:!1})||this}return So(i,t),i}(ko);const Eo=class{constructor(i){t(this,i),this.error=!1,this.target="mapa"}async componentWillLoad(){try{let t=await fetch("https://get.geojs.io/v1/ip/geo.json");if(!t.ok)throw new Error;let i=await t.json();this.getLocationDataFromRequested(i)}catch(t){this.error=!0}}componentDidLoad(){this.error||(this.removeMapWrapperChilds(),this.map=new Rh({controls:[],target:this.target,layers:[new vo({source:new No}),new kh({source:this.getSourceForMarker(),style:this.getStyleForMarker()})],view:new wr({center:Ui([this.lon,this.lat]),zoom:14})}))}getSourceForMarker(){return new zh({features:[new Ms({geometry:new or(Ui([this.lon,this.lat]))})]})}getStyleForMarker(){return new Ss({image:new Oh({anchor:[0,.75],anchorXUnits:"fraction",anchorYUnits:"fraction",src:this.getResourcePath("15304585081556274015-20.png")})})}showError(){return this.error?i("div",{class:"geo-location__error-wrapper"},i("div",{class:"geo-location__error-icon"},i("img",{src:this.getResourcePath("14764845711548336260.svg")})),i("div",null,"Se ha producido un error al obtener los datos de localización.")):null}showLocationInfo(){return this.error?null:[i("div",{class:"geo-location__information-wrapper"},i("p",null,"IP: ",this.ip),i("p",null,"Desde: ",this.fromLocation)),i("div",{class:"geo-location__map-wrapper",id:this.target})]}showFooter(){return i("div",{class:"geo-location__footer"},"Iconos de ",i("a",{href:"https://freeicons.io/profile/730",target:"_blank"},"Anu Rocks"),", ",i("a",{href:"https://freeicons.io/profile/3",target:"_blank"},"icon king1")," y ",i("a",{href:"https://freeicons.io/profile/714",target:"_blank"},"Raj Dev")," desde ",i("a",{href:"https://freeicons.io",target:"_blank"},"freeicons.io"))}render(){return i("div",{class:"geo-location__wrapper"},i("div",{class:"geo-location__title-wrapper"},i("div",{class:"geo-location__icon-wrapper"},i("img",{src:this.getResourcePath("19872325951553771550.svg")})),i("div",{class:"geo-location__title-text"},"Geo Localización")),this.showLocationInfo(),this.showError(),this.showFooter())}getResourcePath(t){return n("./assets/"+t)}removeMapWrapperChilds(){const t=document.getElementById(this.target);for(;t.firstChild;)t.removeChild(t.firstChild)}getLocationDataFromRequested(t){this.ip=t.ip,this.lon=+t.longitude,this.lat=+t.latitude,this.fromLocation=`${t.city?t.city:"Sin datos"} (${t.region?t.region:"Sin datos"}) - ${t.country}`}static get assetsDirs(){return["./assets"]}};Eo.style=".geo-location__wrapper.sc-gtx-geo-location{font-family:Verdana, Geneva, Tahoma, sans-serif;border:solid 1px #000;padding:0.5rem 1rem;font-size:0.75rem;max-width:300px}.geo-location__title-wrapper.sc-gtx-geo-location{margin-bottom:0.5rem;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-align:center;align-items:center;-ms-flex-pack:start;justify-content:flex-start}.geo-location__icon-wrapper.sc-gtx-geo-location,.geo-location__error-icon.sc-gtx-geo-location{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.geo-location__icon-wrapper.sc-gtx-geo-location img.sc-gtx-geo-location,.geo-location__error-icon.sc-gtx-geo-location img.sc-gtx-geo-location{width:1.5rem;height:auto;margin:0;margin-right:0.5rem;display:block}.geo-location__error-icon.sc-gtx-geo-location img.sc-gtx-geo-location{height:2.5rem;width:auto}.geo-location__title-text.sc-gtx-geo-location{padding:0.25rem 0}.geo-location__footer.sc-gtx-geo-location{margin-top:0.5rem;text-align:justify}.geo-location__information-wrapper.sc-gtx-geo-location{margin-bottom:0.5rem}.geo-location__information-wrapper.sc-gtx-geo-location p.sc-gtx-geo-location{margin:0.5rem 0 0 0}.geo-location__map-wrapper.sc-gtx-geo-location{height:100px;width:100%}.geo-location__error-wrapper.sc-gtx-geo-location{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:start;justify-content:flex-start}";export{Eo as gtx_geo_location}