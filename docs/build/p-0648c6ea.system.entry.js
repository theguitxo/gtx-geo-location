var __awaiter=this&&this.__awaiter||function(t,e,i,n){function r(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(e){o(e)}}function s(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):r(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,r,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return u([t,e])}}function u(a){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,r&&(o=a[0]&2?r["return"]:a[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;if(r=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:i.label++;return{value:a[1],done:false};case 5:i.label++;r=a[1];a=[0];continue;case 7:a=i.ops.pop();i.trys.pop();continue;default:if(!(o=i.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){i=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(a[0]===6&&i.label<o[1]){i.label=o[1];o=a;break}if(o&&i.label<o[2]){i.label=o[2];i.ops.push(a);break}if(o[2])i.ops.pop();i.trys.pop();continue}a=e.call(t,i)}catch(s){a=[6,s];r=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-bf78d6a7.system.js"],(function(t){"use strict";var e,i,n;return{setters:[function(t){e=t.r;i=t.h;n=t.g}],execute:function(){var r=function(){function t(){this.disposed=false}t.prototype.dispose=function(){if(!this.disposed){this.disposed=true;this.disposeInternal()}};t.prototype.disposeInternal=function(){};return t}();function o(t,e){return t>e?1:t<e?-1:0}function a(t,e,i){var n=t.length;if(t[0]<=e){return 0}else if(e<=t[n-1]){return n-1}else{var r=void 0;if(i>0){for(r=1;r<n;++r){if(t[r]<e){return r-1}}}else if(i<0){for(r=1;r<n;++r){if(t[r]<=e){return r}}}else{for(r=1;r<n;++r){if(t[r]==e){return r}else if(t[r]<e){if(t[r-1]-e<e-t[r]){return r-1}else{return r}}}}return n-1}}function s(t,e,i){while(e<i){var n=t[e];t[e]=t[i];t[i]=n;++e;--i}}function u(t,e){var i=Array.isArray(e)?e:[e];var n=i.length;for(var r=0;r<n;r++){t[t.length]=i[r]}}function l(t,e){var i=t.length;if(i!==e.length){return false}for(var n=0;n<i;n++){if(t[n]!==e[n]){return false}}return true}function h(t,e,i){var n=e||o;return t.every((function(e,r){if(r===0){return true}var o=n(t[r-1],e);return!(o>0||i&&o===0)}))}function f(){return true}function c(){return false}function p(){}function d(t){var e=false;var i;var n;var r;return function(){var o=Array.prototype.slice.call(arguments);if(!e||this!==r||!l(o,n)){e=true;r=this;n=o;i=t.apply(this,arguments)}return i}}function v(){return function(){throw new Error("Unimplemented abstract method.")}()}var _=0;function g(t){return t.ol_uid||(t.ol_uid=String(++_))}var y="6.4.3";var m=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var x=function(t){m(e,t);function e(e){var i=this;var n="v"+y.split("-")[0];var r="Assertion failed. See https://openlayers.org/en/"+n+"/doc/errors/#"+e+" for details.";i=t.call(this,r)||this;i.code=e;i.name="AssertionError";i.message=r;return i}return e}(Error);function E(t,e){if(!t){throw new x(e)}}var T=new Array(6);function R(){return[1,0,0,1,0,0]}function O(t,e,i,n,r,o,a){t[0]=e;t[1]=i;t[2]=n;t[3]=r;t[4]=o;t[5]=a;return t}function C(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];return t}function S(t,e){var i=e[0];var n=e[1];e[0]=t[0]*i+t[2]*n+t[4];e[1]=t[1]*i+t[3]*n+t[5];return e}function I(t,e,i){return O(t,e,0,0,i,0,0)}function w(t,e,i,n,r,o,a,s){var u=Math.sin(o);var l=Math.cos(o);t[0]=n*l;t[1]=r*u;t[2]=-n*u;t[3]=r*l;t[4]=a*n*l-s*n*u+e;t[5]=a*r*u+s*r*l+i;return t}function P(t,e){var i=b(e);E(i!==0,32);var n=e[0];var r=e[1];var o=e[2];var a=e[3];var s=e[4];var u=e[5];t[0]=a/i;t[1]=-r/i;t[2]=-o/i;t[3]=n/i;t[4]=(o*u-a*s)/i;t[5]=-(n*u-r*s)/i;return t}function b(t){return t[0]*t[3]-t[1]*t[2]}function L(t){return"matrix("+t.join(", ")+")"}var A={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};var M={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function D(t){var e=X();for(var i=0,n=t.length;i<n;++i){q(e,t[i])}return e}function F(t,e,i){if(i){i[0]=t[0]-e;i[1]=t[1]-e;i[2]=t[2]+e;i[3]=t[3]+e;return i}else{return[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}}function N(t,e){if(e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}else{return t.slice()}}function k(t,e,i){var n,r;if(e<t[0]){n=t[0]-e}else if(t[2]<e){n=e-t[2]}else{n=0}if(i<t[1]){r=t[1]-i}else if(t[3]<i){r=i-t[3]}else{r=0}return n*n+r*r}function G(t,e){return Y(t,e[0],e[1])}function j(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Y(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function z(t,e){var i=t[0];var n=t[1];var r=t[2];var o=t[3];var a=e[0];var s=e[1];var u=M.UNKNOWN;if(a<i){u=u|M.LEFT}else if(a>r){u=u|M.RIGHT}if(s<n){u=u|M.BELOW}else if(s>o){u=u|M.ABOVE}if(u===M.UNKNOWN){u=M.INTERSECTING}return u}function X(){return[Infinity,Infinity,-Infinity,-Infinity]}function W(t,e,i,n,r){if(r){r[0]=t;r[1]=e;r[2]=i;r[3]=n;return r}else{return[t,e,i,n]}}function K(t){return W(Infinity,Infinity,-Infinity,-Infinity,t)}function Z(t,e){var i=t[0];var n=t[1];return W(i,n,i,n,e)}function U(t,e){var i=K(e);return J(i,t)}function B(t,e,i,n,r){var o=K(r);return Q(o,t,e,i,n)}function V(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function H(t,e){if(e[0]<t[0]){t[0]=e[0]}if(e[2]>t[2]){t[2]=e[2]}if(e[1]<t[1]){t[1]=e[1]}if(e[3]>t[3]){t[3]=e[3]}return t}function q(t,e){if(e[0]<t[0]){t[0]=e[0]}if(e[0]>t[2]){t[2]=e[0]}if(e[1]<t[1]){t[1]=e[1]}if(e[1]>t[3]){t[3]=e[1]}}function J(t,e){for(var i=0,n=e.length;i<n;++i){q(t,e[i])}return t}function Q(t,e,i,n,r){for(;i<n;i+=r){$(t,e[i],e[i+1])}return t}function $(t,e,i){t[0]=Math.min(t[0],e);t[1]=Math.min(t[1],i);t[2]=Math.max(t[2],e);t[3]=Math.max(t[3],i)}function tt(t,e){var i;i=e(it(t));if(i){return i}i=e(nt(t));if(i){return i}i=e(ht(t));if(i){return i}i=e(lt(t));if(i){return i}return false}function et(t){var e=0;if(!pt(t)){e=ft(t)*st(t)}return e}function it(t){return[t[0],t[1]]}function nt(t){return[t[2],t[1]]}function rt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function ot(t,e){var i;if(e===A.BOTTOM_LEFT){i=it(t)}else if(e===A.BOTTOM_RIGHT){i=nt(t)}else if(e===A.TOP_LEFT){i=lt(t)}else if(e===A.TOP_RIGHT){i=ht(t)}else{E(false,13)}return i}function at(t,e,i,n,r){var o=e*n[0]/2;var a=e*n[1]/2;var s=Math.cos(i);var u=Math.sin(i);var l=o*s;var h=o*u;var f=a*s;var c=a*u;var p=t[0];var d=t[1];var v=p-l+c;var _=p-l-c;var g=p+l-c;var y=p+l+c;var m=d-h-f;var x=d-h+f;var E=d+h+f;var T=d+h-f;return W(Math.min(v,_,g,y),Math.min(m,x,E,T),Math.max(v,_,g,y),Math.max(m,x,E,T),r)}function st(t){return t[3]-t[1]}function ut(t,e,i){var n=i?i:X();if(ct(t,e)){if(t[0]>e[0]){n[0]=t[0]}else{n[0]=e[0]}if(t[1]>e[1]){n[1]=t[1]}else{n[1]=e[1]}if(t[2]<e[2]){n[2]=t[2]}else{n[2]=e[2]}if(t[3]<e[3]){n[3]=t[3]}else{n[3]=e[3]}}else{K(n)}return n}function lt(t){return[t[0],t[3]]}function ht(t){return[t[2],t[3]]}function ft(t){return t[2]-t[0]}function ct(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function pt(t){return t[2]<t[0]||t[3]<t[1]}function dt(t,e){if(e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}else{return t}}function vt(t,e){var i=(t[2]-t[0])/2*(e-1);var n=(t[3]-t[1])/2*(e-1);t[0]-=i;t[2]+=i;t[1]-=n;t[3]+=n}function _t(t,e,i){var n=false;var r=z(t,e);var o=z(t,i);if(r===M.INTERSECTING||o===M.INTERSECTING){n=true}else{var a=t[0];var s=t[1];var u=t[2];var l=t[3];var h=e[0];var f=e[1];var c=i[0];var p=i[1];var d=(p-f)/(c-h);var v=void 0,_=void 0;if(!!(o&M.ABOVE)&&!(r&M.ABOVE)){v=c-(p-l)/d;n=v>=a&&v<=u}if(!n&&!!(o&M.RIGHT)&&!(r&M.RIGHT)){_=p-(c-u)*d;n=_>=s&&_<=l}if(!n&&!!(o&M.BELOW)&&!(r&M.BELOW)){v=c-(p-s)/d;n=v>=a&&v<=u}if(!n&&!!(o&M.LEFT)&&!(r&M.LEFT)){_=p-(c-a)*d;n=_>=s&&_<=l}}return n}function gt(t,e){var i=e.getExtent();var n=rt(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){var r=ft(i);var o=Math.floor((n[0]-i[0])/r);var a=o*r;t[0]-=a;t[2]-=a}return t}function yt(t,e,i){return Math.min(Math.max(t,e),i)}var mt=function(){var t;if("cosh"in Math){t=Math.cosh}else{t=function(t){var e=Math.exp(t);return(e+1/e)/2}}return t}();var xt=function(){var t;if("log2"in Math){t=Math.log2}else{t=function(t){return Math.log(t)*Math.LOG2E}}return t}();function Et(t,e,i,n,r,o){var a=r-i;var s=o-n;if(a!==0||s!==0){var u=((t-i)*a+(e-n)*s)/(a*a+s*s);if(u>1){i=r;n=o}else if(u>0){i+=a*u;n+=s*u}}return Tt(t,e,i,n)}function Tt(t,e,i,n){var r=i-t;var o=n-e;return r*r+o*o}function Rt(t){var e=t.length;for(var i=0;i<e;i++){var n=i;var r=Math.abs(t[i][i]);for(var o=i+1;o<e;o++){var a=Math.abs(t[o][i]);if(a>r){r=a;n=o}}if(r===0){return null}var s=t[n];t[n]=t[i];t[i]=s;for(var u=i+1;u<e;u++){var l=-t[u][i]/t[i][i];for(var h=i;h<e+1;h++){if(i==h){t[u][h]=0}else{t[u][h]+=l*t[i][h]}}}}var f=new Array(e);for(var c=e-1;c>=0;c--){f[c]=t[c][e]/t[c][c];for(var p=c-1;p>=0;p--){t[p][e]-=t[p][c]*f[c]}}return f}function Ot(t){return t*Math.PI/180}function Ct(t,e){var i=t%e;return i*e<0?i+e:i}function St(t,e,i){return t+i*(e-t)}var It=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i;var wt=/^([a-z]*)$|^hsla?\(.*\)$/i;function Pt(t){if(typeof t==="string"){return t}else{return Ft(t)}}function bt(t){var e=document.createElement("div");e.style.color=t;if(e.style.color!==""){document.body.appendChild(e);var i=getComputedStyle(e).color;document.body.removeChild(e);return i}else{return""}}var Lt=function(){var t=1024;var e={};var i=0;return function(n){var r;if(e.hasOwnProperty(n)){r=e[n]}else{if(i>=t){var o=0;for(var a in e){if((o++&3)===0){delete e[a];--i}}}r=Mt(n);e[n]=r;++i}return r}}();function At(t){if(Array.isArray(t)){return t}else{return Lt(t)}}function Mt(t){var e,i,n,r,o;if(wt.exec(t)){t=bt(t)}if(It.exec(t)){var a=t.length-1;var s=void 0;if(a<=4){s=1}else{s=2}var u=a===4||a===8;e=parseInt(t.substr(1+0*s,s),16);i=parseInt(t.substr(1+1*s,s),16);n=parseInt(t.substr(1+2*s,s),16);if(u){r=parseInt(t.substr(1+3*s,s),16)}else{r=255}if(s==1){e=(e<<4)+e;i=(i<<4)+i;n=(n<<4)+n;if(u){r=(r<<4)+r}}o=[e,i,n,r/255]}else if(t.indexOf("rgba(")==0){o=t.slice(5,-1).split(",").map(Number);Dt(o)}else if(t.indexOf("rgb(")==0){o=t.slice(4,-1).split(",").map(Number);o.push(1);Dt(o)}else{E(false,14)}return o}function Dt(t){t[0]=yt(t[0]+.5|0,0,255);t[1]=yt(t[1]+.5|0,0,255);t[2]=yt(t[2]+.5|0,0,255);t[3]=yt(t[3],0,1);return t}function Ft(t){var e=t[0];if(e!=(e|0)){e=e+.5|0}var i=t[1];if(i!=(i|0)){i=i+.5|0}var n=t[2];if(n!=(n|0)){n=n+.5|0}var r=t[3]===undefined?1:t[3];return"rgba("+e+","+i+","+n+","+r+")"}var Nt=function(){function t(){this.cache_={};this.cacheSize_=0;this.maxCacheSize_=32}t.prototype.clear=function(){this.cache_={};this.cacheSize_=0};t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_};t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var i=this.cache_[e];if((t++&3)===0&&!i.hasListener()){delete this.cache_[e];--this.cacheSize_}}}};t.prototype.get=function(t,e,i){var n=kt(t,e,i);return n in this.cache_?this.cache_[n]:null};t.prototype.set=function(t,e,i,n){var r=kt(t,e,i);this.cache_[r]=n;++this.cacheSize_};t.prototype.setSize=function(t){this.maxCacheSize_=t;this.expire()};return t}();function kt(t,e,i){var n=i?Pt(i):"null";return e+":"+t+":"+n}var Gt=new Nt;var jt=function(){function t(t){this.type=t;this.target=null}t.prototype.preventDefault=function(){this.propagationStopped=true};t.prototype.stopPropagation=function(){this.propagationStopped=true};return t}();var Yt={PROPERTYCHANGE:"propertychange"};var zt=typeof Object.assign==="function"?Object.assign:function(t,e){if(t===undefined||t===null){throw new TypeError("Cannot convert undefined or null to object")}var i=Object(t);for(var n=1,r=arguments.length;n<r;++n){var o=arguments[n];if(o!==undefined&&o!==null){for(var a in o){if(o.hasOwnProperty(a)){i[a]=o[a]}}}}return i};function Xt(t){for(var e in t){delete t[e]}}var Wt=typeof Object.values==="function"?Object.values:function(t){var e=[];for(var i in t){e.push(t[i])}return e};function Kt(t){var e;for(e in t){return false}return!e}var Zt=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ut=function(t){Zt(e,t);function e(e){var i=t.call(this)||this;i.eventTarget_=e;i.pendingRemovals_=null;i.dispatching_=null;i.listeners_=null;return i}e.prototype.addEventListener=function(t,e){if(!t||!e){return}var i=this.listeners_||(this.listeners_={});var n=i[t]||(i[t]=[]);if(n.indexOf(e)===-1){n.push(e)}};e.prototype.dispatchEvent=function(t){var e=typeof t==="string"?new jt(t):t;var i=e.type;if(!e.target){e.target=this.eventTarget_||this}var n=this.listeners_&&this.listeners_[i];var r;if(n){var o=this.dispatching_||(this.dispatching_={});var a=this.pendingRemovals_||(this.pendingRemovals_={});if(!(i in o)){o[i]=0;a[i]=0}++o[i];for(var s=0,u=n.length;s<u;++s){if("handleEvent"in n[s]){r=n[s].handleEvent(e)}else{r=n[s].call(this,e)}if(r===false||e.propagationStopped){r=false;break}}--o[i];if(o[i]===0){var l=a[i];delete a[i];while(l--){this.removeEventListener(i,p)}delete o[i]}return r}};e.prototype.disposeInternal=function(){this.listeners_&&Xt(this.listeners_)};e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||undefined};e.prototype.hasListener=function(t){if(!this.listeners_){return false}return t?t in this.listeners_:Object.keys(this.listeners_).length>0};e.prototype.removeEventListener=function(t,e){var i=this.listeners_&&this.listeners_[t];if(i){var n=i.indexOf(e);if(n!==-1){if(this.pendingRemovals_&&t in this.pendingRemovals_){i[n]=p;++this.pendingRemovals_[t]}else{i.splice(n,1);if(i.length===0){delete this.listeners_[t]}}}}};return e}(r);var Bt={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Vt(t,e,i,n,r){if(n&&n!==t){i=i.bind(n)}if(r){var o=i;i=function(){t.removeEventListener(e,i);o.apply(this,arguments)}}var a={target:t,type:e,listener:i};t.addEventListener(e,i);return a}function Ht(t,e,i,n){return Vt(t,e,i,n,true)}function qt(t){if(t&&t.target){t.target.removeEventListener(t.type,t.listener);Xt(t)}}var Jt=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Qt=function(t){Jt(e,t);function e(){var e=t.call(this)||this;e.revision_=0;return e}e.prototype.changed=function(){++this.revision_;this.dispatchEvent(Bt.CHANGE)};e.prototype.getRevision=function(){return this.revision_};e.prototype.on=function(t,e){if(Array.isArray(t)){var i=t.length;var n=new Array(i);for(var r=0;r<i;++r){n[r]=Vt(this,t[r],e)}return n}else{return Vt(this,t,e)}};e.prototype.once=function(t,e){var i;if(Array.isArray(t)){var n=t.length;i=new Array(n);for(var r=0;r<n;++r){i[r]=Ht(this,t[r],e)}}else{i=Ht(this,t,e)}e.ol_key=i;return i};e.prototype.un=function(t,e){var i=e.ol_key;if(i){$t(i)}else if(Array.isArray(t)){for(var n=0,r=t.length;n<r;++n){this.removeEventListener(t[n],e)}}else{this.removeEventListener(t,e)}};return e}(Ut);function $t(t){if(Array.isArray(t)){for(var e=0,i=t.length;e<i;++e){qt(t[e])}}else{qt(t)}}var te=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ee=function(t){te(e,t);function e(e,i,n){var r=t.call(this,e)||this;r.key=i;r.oldValue=n;return r}return e}(jt);var ie=function(t){te(e,t);function e(e){var i=t.call(this)||this;g(i);i.values_=null;if(e!==undefined){i.setProperties(e)}return i}e.prototype.get=function(t){var e;if(this.values_&&this.values_.hasOwnProperty(t)){e=this.values_[t]}return e};e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]};e.prototype.getProperties=function(){return this.values_&&zt({},this.values_)||{}};e.prototype.hasProperties=function(){return!!this.values_};e.prototype.notify=function(t,e){var i;i=re(t);this.dispatchEvent(new ee(i,t,e));i=Yt.PROPERTYCHANGE;this.dispatchEvent(new ee(i,t,e))};e.prototype.set=function(t,e,i){var n=this.values_||(this.values_={});if(i){n[t]=e}else{var r=n[t];n[t]=e;if(r!==e){this.notify(t,r)}}};e.prototype.setProperties=function(t,e){for(var i in t){this.set(i,t[i],e)}};e.prototype.unset=function(t,e){if(this.values_&&t in this.values_){var i=this.values_[t];delete this.values_[t];if(Kt(this.values_)){this.values_=null}if(!e){this.notify(t,i)}}};return e}(Qt);var ne={};function re(t){return ne.hasOwnProperty(t)?ne[t]:ne[t]="change:"+t}var oe={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"};var ae=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var se=function(t){ae(e,t);function e(e){var i=t.call(this)||this;var n=zt({},e);n[oe.OPACITY]=e.opacity!==undefined?e.opacity:1;E(typeof n[oe.OPACITY]==="number",64);n[oe.VISIBLE]=e.visible!==undefined?e.visible:true;n[oe.Z_INDEX]=e.zIndex;n[oe.MAX_RESOLUTION]=e.maxResolution!==undefined?e.maxResolution:Infinity;n[oe.MIN_RESOLUTION]=e.minResolution!==undefined?e.minResolution:0;n[oe.MIN_ZOOM]=e.minZoom!==undefined?e.minZoom:-Infinity;n[oe.MAX_ZOOM]=e.maxZoom!==undefined?e.maxZoom:Infinity;i.className_=n.className!==undefined?e.className:"ol-layer";delete n.className;i.setProperties(n);i.state_=null;return i}e.prototype.getClassName=function(){return this.className_};e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:t===undefined?true:t};var i=this.getZIndex();e.opacity=yt(Math.round(this.getOpacity()*100)/100,0,1);e.sourceState=this.getSourceState();e.visible=this.getVisible();e.extent=this.getExtent();e.zIndex=i!==undefined?i:e.managed===false?Infinity:0;e.maxResolution=this.getMaxResolution();e.minResolution=Math.max(this.getMinResolution(),0);e.minZoom=this.getMinZoom();e.maxZoom=this.getMaxZoom();this.state_=e;return e};e.prototype.getLayersArray=function(t){return v()};e.prototype.getLayerStatesArray=function(t){return v()};e.prototype.getExtent=function(){return this.get(oe.EXTENT)};e.prototype.getMaxResolution=function(){return this.get(oe.MAX_RESOLUTION)};e.prototype.getMinResolution=function(){return this.get(oe.MIN_RESOLUTION)};e.prototype.getMinZoom=function(){return this.get(oe.MIN_ZOOM)};e.prototype.getMaxZoom=function(){return this.get(oe.MAX_ZOOM)};e.prototype.getOpacity=function(){return this.get(oe.OPACITY)};e.prototype.getSourceState=function(){return v()};e.prototype.getVisible=function(){return this.get(oe.VISIBLE)};e.prototype.getZIndex=function(){return this.get(oe.Z_INDEX)};e.prototype.setExtent=function(t){this.set(oe.EXTENT,t)};e.prototype.setMaxResolution=function(t){this.set(oe.MAX_RESOLUTION,t)};e.prototype.setMinResolution=function(t){this.set(oe.MIN_RESOLUTION,t)};e.prototype.setMaxZoom=function(t){this.set(oe.MAX_ZOOM,t)};e.prototype.setMinZoom=function(t){this.set(oe.MIN_ZOOM,t)};e.prototype.setOpacity=function(t){E(typeof t==="number",64);this.set(oe.OPACITY,t)};e.prototype.setVisible=function(t){this.set(oe.VISIBLE,t)};e.prototype.setZIndex=function(t){this.set(oe.Z_INDEX,t)};e.prototype.disposeInternal=function(){if(this.state_){this.state_.layer=null;this.state_=null}t.prototype.disposeInternal.call(this)};return e}(ie);var ue={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var le={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};var he=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var fe=function(t){he(e,t);function e(e){var i=this;var n=zt({},e);delete n.source;i=t.call(this,n)||this;i.mapPrecomposeKey_=null;i.mapRenderKey_=null;i.sourceChangeKey_=null;i.renderer_=null;if(e.render){i.render=e.render}if(e.map){i.setMap(e.map)}i.addEventListener(re(oe.SOURCE),i.handleSourcePropertyChange_);var r=e.source?e.source:null;i.setSource(r);return i}e.prototype.getLayersArray=function(t){var e=t?t:[];e.push(this);return e};e.prototype.getLayerStatesArray=function(t){var e=t?t:[];e.push(this.getLayerState());return e};e.prototype.getSource=function(){return this.get(oe.SOURCE)||null};e.prototype.getSourceState=function(){var t=this.getSource();return!t?le.UNDEFINED:t.getState()};e.prototype.handleSourceChange_=function(){this.changed()};e.prototype.handleSourcePropertyChange_=function(){if(this.sourceChangeKey_){qt(this.sourceChangeKey_);this.sourceChangeKey_=null}var t=this.getSource();if(t){this.sourceChangeKey_=Vt(t,Bt.CHANGE,this.handleSourceChange_,this)}this.changed()};e.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)};e.prototype.render=function(t,e){var i=this.getRenderer();if(i.prepareFrame(t)){return i.renderFrame(t,e)}};e.prototype.setMap=function(t){if(this.mapPrecomposeKey_){qt(this.mapPrecomposeKey_);this.mapPrecomposeKey_=null}if(!t){this.changed()}if(this.mapRenderKey_){qt(this.mapRenderKey_);this.mapRenderKey_=null}if(t){this.mapPrecomposeKey_=Vt(t,ue.PRECOMPOSE,(function(t){var e=t;var i=e.frameState.layerStatesArray;var n=this.getLayerState(false);E(!i.some((function(t){return t.layer===n.layer})),67);i.push(n)}),this);this.mapRenderKey_=Vt(this,Bt.CHANGE,t.render,t);this.changed()}};e.prototype.setSource=function(t){this.set(oe.SOURCE,t)};e.prototype.getRenderer=function(){if(!this.renderer_){this.renderer_=this.createRenderer()}return this.renderer_};e.prototype.hasRenderer=function(){return!!this.renderer_};e.prototype.createRenderer=function(){return null};e.prototype.disposeInternal=function(){this.setSource(null);t.prototype.disposeInternal.call(this)};return e}(se);function ce(t,e){if(!t.visible){return false}var i=e.resolution;if(i<t.minResolution||i>=t.maxResolution){return false}var n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}var pe={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};var de=function(){function t(){}t.prototype.drawCustom=function(t,e,i){};t.prototype.drawGeometry=function(t){};t.prototype.setStyle=function(t){};t.prototype.drawCircle=function(t,e){};t.prototype.drawFeature=function(t,e){};t.prototype.drawGeometryCollection=function(t,e){};t.prototype.drawLineString=function(t,e){};t.prototype.drawMultiLineString=function(t,e){};t.prototype.drawMultiPoint=function(t,e){};t.prototype.drawMultiPolygon=function(t,e){};t.prototype.drawPoint=function(t,e){};t.prototype.drawPolygon=function(t,e){};t.prototype.drawText=function(t,e){};t.prototype.setFillStrokeStyle=function(t,e){};t.prototype.setImageStyle=function(t,e){};t.prototype.setTextStyle=function(t,e){};return t}();function ve(t){if(Array.isArray(t)){return Ft(t)}else{return t}}var _e=typeof navigator!=="undefined"&&typeof navigator.userAgent!=="undefined"?navigator.userAgent.toLowerCase():"";var ge=_e.indexOf("firefox")!==-1;var ye=_e.indexOf("safari")!==-1&&_e.indexOf("chrom")==-1;var me=_e.indexOf("webkit")!==-1&&_e.indexOf("edge")==-1;var xe=_e.indexOf("macintosh")!==-1;var Ee=typeof devicePixelRatio!=="undefined"?devicePixelRatio:1;var Te=typeof WorkerGlobalScope!=="undefined"&&typeof OffscreenCanvas!=="undefined"&&self instanceof WorkerGlobalScope;var Re=typeof Image!=="undefined"&&Image.prototype.decode;var Oe=function(){var t=false;try{var e=Object.defineProperty({},"passive",{get:function(){t=true}});window.addEventListener("_",null,e);window.removeEventListener("_",null,e)}catch(i){}return t}();function Ce(t,e,i){var n=i&&i.length?i.shift():Te?new OffscreenCanvas(t||300,e||300):document.createElement("canvas");if(t){n.width=t}if(e){n.height=e}return n.getContext("2d")}function Se(t,e){var i=e.parentNode;if(i){i.replaceChild(t,e)}}function Ie(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function we(t){while(t.lastChild){t.removeChild(t.lastChild)}}function Pe(t,e){var i=t.childNodes;for(var n=0;true;++n){var r=i[n];var o=e[n];if(!r&&!o){break}if(r===o){continue}if(!r){t.appendChild(o);continue}if(!o){t.removeChild(r);--n;continue}t.insertBefore(o,r)}}var be="ol-hidden";var Le="ol-unselectable";var Ae="ol-control";var Me="ol-collapsed";var De=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i");var Fe=["style","variant","weight","size","lineHeight","family"];var Ne=function(t){var e=t.match(De);if(!e){return null}var i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(var n=0,r=Fe.length;n<r;++n){var o=e[n+1];if(o!==undefined){i[Fe[n]]=o}}i.families=i.family.split(/,\s?/);return i};var ke="10px sans-serif";var Ge="#000";var je="round";var Ye=[];var ze=0;var Xe="round";var We=10;var Ke="#000";var Ze="center";var Ue="middle";var Be=[0,0,0,0];var Ve=1;var He=new ie;var qe=new Ut;qe.setSize=function(){console.warn("labelCache is deprecated.")};var Je=null;var Qe;var $e={};var ti=function(){var t=100;var e="32px ";var i=["monospace","serif"];var n=i.length;var r="wmytzilWMYTZIL@#/&?$%10";var o,a;function s(t,o,s){var u=true;for(var l=0;l<n;++l){var h=i[l];a=ni(t+" "+o+" "+e+h,r);if(s!=h){var f=ni(t+" "+o+" "+e+s+","+h,r);u=u&&f!=a}}if(u){return true}return false}function u(){var e=true;var i=He.getKeys();for(var n=0,r=i.length;n<r;++n){var a=i[n];if(He.get(a)<t){if(s.apply(this,a.split("\n"))){Xt($e);Je=null;Qe=undefined;He.set(a,t)}else{He.set(a,He.get(a)+1,true);e=false}}}if(e){clearInterval(o);o=undefined}}return function(e){var i=Ne(e);if(!i){return}var n=i.families;for(var r=0,a=n.length;r<a;++r){var l=n[r];var h=i.style+"\n"+i.weight+"\n"+l;if(He.get(h)===undefined){He.set(h,t,true);if(!s(i.style,i.weight,l)){He.set(h,0,true);if(o===undefined){o=setInterval(u,32)}}}}}}();var ei=function(){var t;var e=$e;return function(i){var n=e[i];if(n==undefined){if(Te){var r=Ne(i);var o=ii(i,"Žg");var a=isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight);$e[i]=a*(o.actualBoundingBoxAscent+o.actualBoundingBoxDescent)}else{if(!t){t=document.createElement("div");t.innerHTML="M";t.style.margin="0 !important";t.style.padding="0 !important";t.style.position="absolute !important";t.style.left="-99999px !important"}t.style.font=i;document.body.appendChild(t);n=t.offsetHeight;e[i]=n;document.body.removeChild(t)}}return n}}();function ii(t,e){if(!Je){Je=Ce(1,1)}if(t!=Qe){Je.font=t;Qe=Je.font}return Je.measureText(e)}function ni(t,e){return ii(t,e).width}function ri(t,e,i){if(e in i){return i[e]}var n=ni(t,e);i[e]=n;return n}function oi(t,e,i){var n=e.length;var r=0;for(var o=0;o<n;++o){var a=ni(t,e[o]);r=Math.max(r,a);i.push(a)}return r}function ai(t,e,i,n){if(e!==0){t.translate(i,n);t.rotate(e);t.translate(-i,-n)}}function si(t,e,i,n,r,o,a,s,u,l,h){t.save();if(i!==1){t.globalAlpha*=i}if(e){t.setTransform.apply(t,e)}if(n.contextInstructions){t.translate(u,l);t.scale(h[0],h[1]);ui(n,t)}else if(h[0]<0||h[1]<0){t.translate(u,l);t.scale(h[0],h[1]);t.drawImage(n,r,o,a,s,0,0,a,s)}else{t.drawImage(n,r,o,a,s,u,l,a*h[0],s*h[1])}t.restore()}function ui(t,e){var i=t.contextInstructions;for(var n=0,r=i.length;n<r;n+=2){if(Array.isArray(i[n+1])){e[i[n]].apply(e,i[n+1])}else{e[i[n]]=i[n+1]}}}var li=null;function hi(t){if(Te){return L(t)}else{if(!li){li=Ce(1,1).canvas}li.style.transform=L(t);return li.style.transform}}function fi(t,e,i,n,r,o){var a=o?o:[];var s=0;for(var u=e;u<i;u+=n){var l=t[u];var h=t[u+1];a[s++]=r[0]*l+r[2]*h+r[4];a[s++]=r[1]*l+r[3]*h+r[5]}if(o&&a.length!=s){a.length=s}return a}function ci(t,e,i,n,r,o,a){var s=a?a:[];var u=Math.cos(r);var l=Math.sin(r);var h=o[0];var f=o[1];var c=0;for(var p=e;p<i;p+=n){var d=t[p]-h;var v=t[p+1]-f;s[c++]=h+d*u-v*l;s[c++]=f+d*l+v*u;for(var _=p+2;_<p+n;++_){s[c++]=t[_]}}if(a&&s.length!=c){s.length=c}return s}function pi(t,e,i,n,r,o,a,s){var u=s?s:[];var l=a[0];var h=a[1];var f=0;for(var c=e;c<i;c+=n){var p=t[c]-l;var d=t[c+1]-h;u[f++]=l+r*p;u[f++]=h+o*d;for(var v=c+2;v<c+n;++v){u[f++]=t[v]}}if(s&&u.length!=f){u.length=f}return u}function di(t,e,i,n,r,o,a){var s=a?a:[];var u=0;for(var l=e;l<i;l+=n){s[u++]=t[l]+r;s[u++]=t[l+1]+o;for(var h=l+2;h<l+n;++h){s[u++]=t[h]}}if(a&&s.length!=u){s.length=u}return s}var vi={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"};var _i={};_i[vi.DEGREES]=2*Math.PI*6370997/360;_i[vi.FEET]=.3048;_i[vi.METERS]=1;_i[vi.USFEET]=1200/3937;var gi=function(){function t(t){this.code_=t.code;this.units_=t.units;this.extent_=t.extent!==undefined?t.extent:null;this.worldExtent_=t.worldExtent!==undefined?t.worldExtent:null;this.axisOrientation_=t.axisOrientation!==undefined?t.axisOrientation:"enu";this.global_=t.global!==undefined?t.global:false;this.canWrapX_=!!(this.global_&&this.extent_);this.getPointResolutionFunc_=t.getPointResolution;this.defaultTileGrid_=null;this.metersPerUnit_=t.metersPerUnit}t.prototype.canWrapX=function(){return this.canWrapX_};t.prototype.getCode=function(){return this.code_};t.prototype.getExtent=function(){return this.extent_};t.prototype.getUnits=function(){return this.units_};t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||_i[this.units_]};t.prototype.getWorldExtent=function(){return this.worldExtent_};t.prototype.getAxisOrientation=function(){return this.axisOrientation_};t.prototype.isGlobal=function(){return this.global_};t.prototype.setGlobal=function(t){this.global_=t;this.canWrapX_=!!(t&&this.extent_)};t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_};t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t};t.prototype.setExtent=function(t){this.extent_=t;this.canWrapX_=!!(this.global_&&t)};t.prototype.setWorldExtent=function(t){this.worldExtent_=t};t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t};t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};return t}();var yi=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var mi=6378137;var xi=Math.PI*mi;var Ei=[-xi,-xi,xi,xi];var Ti=[-180,-85,180,85];var Ri=function(t){yi(e,t);function e(e){return t.call(this,{code:e,units:vi.METERS,extent:Ei,global:true,worldExtent:Ti,getPointResolution:function(t,e){return t/mt(e[1]/mi)}})||this}return e}(gi);var Oi=[new Ri("EPSG:3857"),new Ri("EPSG:102100"),new Ri("EPSG:102113"),new Ri("EPSG:900913"),new Ri("urn:ogc:def:crs:EPSG:6.18:3:3857"),new Ri("urn:ogc:def:crs:EPSG::3857"),new Ri("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Ci(t,e,i){var n=t.length;var r=i>1?i:2;var o=e;if(o===undefined){if(r>2){o=t.slice()}else{o=new Array(n)}}var a=xi;for(var s=0;s<n;s+=r){o[s]=a*t[s]/180;var u=mi*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));if(u>a){u=a}else if(u<-a){u=-a}o[s+1]=u}return o}function Si(t,e,i){var n=t.length;var r=i>1?i:2;var o=e;if(o===undefined){if(r>2){o=t.slice()}else{o=new Array(n)}}for(var a=0;a<n;a+=r){o[a]=180*t[a]/xi;o[a+1]=360*Math.atan(Math.exp(t[a+1]/mi))/Math.PI-90}return o}var Ii=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var wi=6378137;var Pi=[-180,-90,180,90];var bi=Math.PI*wi/180;var Li=function(t){Ii(e,t);function e(e,i){return t.call(this,{code:e,units:vi.DEGREES,extent:Pi,axisOrientation:i,global:true,metersPerUnit:bi,worldExtent:Pi})||this}return e}(gi);var Ai=[new Li("CRS:84"),new Li("EPSG:4326","neu"),new Li("urn:ogc:def:crs:EPSG::4326","neu"),new Li("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Li("urn:ogc:def:crs:OGC:1.3:CRS84"),new Li("urn:ogc:def:crs:OGC:2:84"),new Li("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Li("urn:x-ogc:def:crs:EPSG:4326","neu")];var Mi={};function Di(t){return Mi[t]||null}function Fi(t,e){Mi[t]=e}var Ni={};function ki(t,e,i){var n=t.getCode();var r=e.getCode();if(!(n in Ni)){Ni[n]={}}Ni[n][r]=i}function Gi(t,e){var i;if(t in Ni&&e in Ni[t]){i=Ni[t][e]}return i}var ji=6371008.8;function Yi(t,e,i){var n=i||ji;var r=Ot(t[1]);var o=Ot(e[1]);var a=(o-r)/2;var s=Ot(e[0]-t[0])/2;var u=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(r)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}function zi(t,e){t[0]+=+e[0];t[1]+=+e[1];return t}function Xi(t,e){var i=true;for(var n=t.length-1;n>=0;--n){if(t[n]!=e[n]){i=false;break}}return i}function Wi(t,e){var i=Math.cos(e);var n=Math.sin(e);var r=t[0]*i-t[1]*n;var o=t[1]*i+t[0]*n;t[0]=r;t[1]=o;return t}function Ki(t,e){t[0]*=e;t[1]*=e;return t}function Zi(t,e){if(e.canWrapX()){var i=ft(e.getExtent());var n=Ui(t,e,i);if(n){t[0]-=n*i}}return t}function Ui(t,e,i){var n=e.getExtent();var r=0;if(e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])){var o=i||ft(n);r=Math.floor((t[0]-n[0])/o)}return r}function Bi(t,e,i){var n;if(e!==undefined){for(var r=0,o=t.length;r<o;++r){e[r]=t[r]}n=e}else{n=t.slice()}return n}function Vi(t,e,i){if(e!==undefined&&t!==e){for(var n=0,r=t.length;n<r;++n){e[n]=t[n]}t=e}return t}function Hi(t){Fi(t.getCode(),t);ki(t,t,Bi)}function qi(t){t.forEach(Hi)}function Ji(t){return typeof t==="string"?Di(t):t||null}function Qi(t,e,i,n){t=Ji(t);var r;var o=t.getPointResolutionFunc();if(o){r=o(e,i);if(n&&n!==t.getUnits()){var a=t.getMetersPerUnit();if(a){r=r*a/_i[n]}}}else{var s=t.getUnits();if(s==vi.DEGREES&&!n||n==vi.DEGREES){r=e}else{var u=on(t,Ji("EPSG:4326"));var l=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];l=u(l,l,2);var h=Yi(l.slice(0,2),l.slice(2,4));var f=Yi(l.slice(4,6),l.slice(6,8));r=(h+f)/2;var a=n?_i[n]:t.getMetersPerUnit();if(a!==undefined){r/=a}}}return r}function $i(t){qi(t);t.forEach((function(e){t.forEach((function(t){if(e!==t){ki(e,t,Bi)}}))}))}function tn(t,e,i,n){t.forEach((function(t){e.forEach((function(e){ki(t,e,i);ki(e,t,n)}))}))}function en(t,e){if(!t){return Ji(e)}else if(typeof t==="string"){return Ji(t)}else{return t}}function nn(t,e){return sn(t,"EPSG:4326",e!==undefined?e:"EPSG:3857")}function rn(t,e){if(t===e){return true}var i=t.getUnits()===e.getUnits();if(t.getCode()===e.getCode()){return i}else{var n=on(t,e);return n===Bi&&i}}function on(t,e){var i=t.getCode();var n=e.getCode();var r=Gi(i,n);if(!r){r=Vi}return r}function an(t,e){var i=Ji(t);var n=Ji(e);return on(i,n)}function sn(t,e,i){var n=an(e,i);return n(t,undefined,t.length)}var un=null;function ln(){return un}function hn(t,e){{return t}}function fn(t,e){{return t}}function cn(t,e){{return t}}function pn(t,e){{return t}}function dn(){$i(Oi);$i(Ai);tn(Ai,Oi,Ci,Si)}dn();var vn=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var _n=R();var gn=function(t){vn(e,t);function e(){var e=t.call(this)||this;e.extent_=X();e.extentRevision_=-1;e.simplifiedGeometryMaxMinSquaredTolerance=0;e.simplifiedGeometryRevision=0;e.simplifyTransformedInternal=d((function(t,e,i){if(!i){return this.getSimplifiedGeometry(e)}var n=this.clone();n.applyTransform(i);return n.getSimplifiedGeometry(e)}));return e}e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)};e.prototype.clone=function(){return v()};e.prototype.closestPointXY=function(t,e,i,n){return v()};e.prototype.containsXY=function(t,e){var i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e};e.prototype.getClosestPoint=function(t,e){var i=e?e:[NaN,NaN];this.closestPointXY(t[0],t[1],i,Infinity);return i};e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])};e.prototype.computeExtent=function(t){return v()};e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);if(isNaN(e[0])||isNaN(e[1])){K(e)}this.extentRevision_=this.getRevision()}return dt(this.extent_,t)};e.prototype.rotate=function(t,e){v()};e.prototype.scale=function(t,e,i){v()};e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)};e.prototype.getSimplifiedGeometry=function(t){return v()};e.prototype.getType=function(){return v()};e.prototype.applyTransform=function(t){v()};e.prototype.intersectsExtent=function(t){return v()};e.prototype.translate=function(t,e){v()};e.prototype.transform=function(t,e){var i=Ji(t);var n=i.getUnits()==vi.TILE_PIXELS?function(t,n,r){var o=i.getExtent();var a=i.getWorldExtent();var s=st(a)/st(o);w(_n,a[0],a[3],s,-s,0,0,0);fi(t,0,t.length,r,_n,n);return an(i,e)(t,n,r)}:an(i,e);this.applyTransform(n);return this};return e}(ie);var yn={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};var mn=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var xn=function(t){mn(e,t);function e(){var e=t.call(this)||this;e.layout=yn.XY;e.stride=2;e.flatCoordinates=null;return e}e.prototype.computeExtent=function(t){return B(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)};e.prototype.getCoordinates=function(){return v()};e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)};e.prototype.getFlatCoordinates=function(){return this.flatCoordinates};e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)};e.prototype.getLayout=function(){return this.layout};e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()){this.simplifiedGeometryMaxMinSquaredTolerance=0;this.simplifiedGeometryRevision=this.getRevision()}if(t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance){return this}var e=this.getSimplifiedGeometryInternal(t);var i=e.getFlatCoordinates();if(i.length<this.flatCoordinates.length){return e}else{this.simplifiedGeometryMaxMinSquaredTolerance=t;return this}};e.prototype.getSimplifiedGeometryInternal=function(t){return this};e.prototype.getStride=function(){return this.stride};e.prototype.setFlatCoordinates=function(t,e){this.stride=Tn(t);this.layout=t;this.flatCoordinates=e};e.prototype.setCoordinates=function(t,e){v()};e.prototype.setLayout=function(t,e,i){var n;if(t){n=Tn(t)}else{for(var r=0;r<i;++r){if(e.length===0){this.layout=yn.XY;this.stride=2;return}else{e=e[0]}}n=e.length;t=En(n)}this.layout=t;this.stride=n};e.prototype.applyTransform=function(t){if(this.flatCoordinates){t(this.flatCoordinates,this.flatCoordinates,this.stride);this.changed()}};e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();ci(i,0,i.length,n,t,e,i);this.changed()}};e.prototype.scale=function(t,e,i){var n=e;if(n===undefined){n=t}var r=i;if(!r){r=rt(this.getExtent())}var o=this.getFlatCoordinates();if(o){var a=this.getStride();pi(o,0,o.length,a,t,n,r,o);this.changed()}};e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();di(i,0,i.length,n,t,e,i);this.changed()}};return e}(gn);function En(t){var e;if(t==2){e=yn.XY}else if(t==3){e=yn.XYZ}else if(t==4){e=yn.XYZM}return e}function Tn(t){var e;if(t==yn.XY){e=2}else if(t==yn.XYZ||t==yn.XYM){e=3}else if(t==yn.XYZM){e=4}return e}function Rn(t,e,i){var n=t.getFlatCoordinates();if(!n){return null}else{var r=t.getStride();return fi(n,0,n.length,r,e,i)}}var On=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Cn=function(t){On(e,t);function e(e,i,n,r,o,a,s){var u=t.call(this)||this;u.context_=e;u.pixelRatio_=i;u.extent_=n;u.transform_=r;u.viewRotation_=o;u.squaredTolerance_=a;u.userTransform_=s;u.contextFillState_=null;u.contextStrokeState_=null;u.contextTextState_=null;u.fillState_=null;u.strokeState_=null;u.image_=null;u.imageAnchorX_=0;u.imageAnchorY_=0;u.imageHeight_=0;u.imageOpacity_=0;u.imageOriginX_=0;u.imageOriginY_=0;u.imageRotateWithView_=false;u.imageRotation_=0;u.imageScale_=[0,0];u.imageWidth_=0;u.text_="";u.textOffsetX_=0;u.textOffsetY_=0;u.textRotateWithView_=false;u.textRotation_=0;u.textScale_=[0,0];u.textFillState_=null;u.textStrokeState_=null;u.textState_=null;u.pixelCoordinates_=[];u.tmpLocalTransform_=R();return u}e.prototype.drawImages_=function(t,e,i,n){if(!this.image_){return}var r=fi(t,e,i,2,this.transform_,this.pixelCoordinates_);var o=this.context_;var a=this.tmpLocalTransform_;var s=o.globalAlpha;if(this.imageOpacity_!=1){o.globalAlpha=s*this.imageOpacity_}var u=this.imageRotation_;if(this.imageRotateWithView_){u+=this.viewRotation_}for(var l=0,h=r.length;l<h;l+=2){var f=r[l]-this.imageAnchorX_;var c=r[l+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){var p=f+this.imageAnchorX_;var d=c+this.imageAnchorY_;w(a,p,d,1,1,u,-p,-d);o.setTransform.apply(o,a);o.translate(p,d);o.scale(this.imageScale_[0],this.imageScale_[1]);o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_);o.setTransform(1,0,0,1,0,0)}else{o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,c,this.imageWidth_,this.imageHeight_)}}if(this.imageOpacity_!=1){o.globalAlpha=s}};e.prototype.drawText_=function(t,e,i,n){if(!this.textState_||this.text_===""){return}if(this.textFillState_){this.setContextFillState_(this.textFillState_)}if(this.textStrokeState_){this.setContextStrokeState_(this.textStrokeState_)}this.setContextTextState_(this.textState_);var r=fi(t,e,i,n,this.transform_,this.pixelCoordinates_);var o=this.context_;var a=this.textRotation_;if(this.textRotateWithView_){a+=this.viewRotation_}for(;e<i;e+=n){var s=r[e]+this.textOffsetX_;var u=r[e+1]+this.textOffsetY_;if(a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1){var l=w(this.tmpLocalTransform_,s,u,1,1,a,-s,-u);o.setTransform.apply(o,l);o.translate(s,u);o.scale(this.textScale_[0],this.textScale_[1]);if(this.textStrokeState_){o.strokeText(this.text_,0,0)}if(this.textFillState_){o.fillText(this.text_,0,0)}o.setTransform(1,0,0,1,0,0)}else{if(this.textStrokeState_){o.strokeText(this.text_,s,u)}if(this.textFillState_){o.fillText(this.text_,s,u)}}}};e.prototype.moveToLineTo_=function(t,e,i,n,r){var o=this.context_;var a=fi(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);var s=a.length;if(r){s-=2}for(var u=2;u<s;u+=2){o.lineTo(a[u],a[u+1])}if(r){o.closePath()}return i};e.prototype.drawRings_=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r){e=this.moveToLineTo_(t,e,i[r],n,true)}return e};e.prototype.drawCircle=function(t){if(!ct(this.extent_,t.getExtent())){return}if(this.fillState_||this.strokeState_){if(this.fillState_){this.setContextFillState_(this.fillState_)}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_)}var e=Rn(t,this.transform_,this.pixelCoordinates_);var i=e[2]-e[0];var n=e[3]-e[1];var r=Math.sqrt(i*i+n*n);var o=this.context_;o.beginPath();o.arc(e[0],e[1],r,0,2*Math.PI);if(this.fillState_){o.fill()}if(this.strokeState_){o.stroke()}}if(this.text_!==""){this.drawText_(t.getCenter(),0,2,2)}};e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke());this.setImageStyle(t.getImage());this.setTextStyle(t.getText())};e.prototype.setTransform=function(t){this.transform_=t};e.prototype.drawGeometry=function(t){var e=t.getType();switch(e){case pe.POINT:this.drawPoint(t);break;case pe.LINE_STRING:this.drawLineString(t);break;case pe.POLYGON:this.drawPolygon(t);break;case pe.MULTI_POINT:this.drawMultiPoint(t);break;case pe.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case pe.MULTI_POLYGON:this.drawMultiPolygon(t);break;case pe.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case pe.CIRCLE:this.drawCircle(t);break}};e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);if(!i||!ct(this.extent_,i.getExtent())){return}this.setStyle(e);this.drawGeometry(i)};e.prototype.drawGeometryCollection=function(t){var e=t.getGeometriesArray();for(var i=0,n=e.length;i<n;++i){this.drawGeometry(e[i])}};e.prototype.drawPoint=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}var e=t.getFlatCoordinates();var i=t.getStride();if(this.image_){this.drawImages_(e,0,e.length,i)}if(this.text_!==""){this.drawText_(e,0,e.length,i)}};e.prototype.drawMultiPoint=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}var e=t.getFlatCoordinates();var i=t.getStride();if(this.image_){this.drawImages_(e,0,e.length,i)}if(this.text_!==""){this.drawText_(e,0,e.length,i)}};e.prototype.drawLineString=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}if(!ct(this.extent_,t.getExtent())){return}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_;var i=t.getFlatCoordinates();e.beginPath();this.moveToLineTo_(i,0,i.length,t.getStride(),false);e.stroke()}if(this.text_!==""){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}};e.prototype.drawMultiLineString=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}var e=t.getExtent();if(!ct(this.extent_,e)){return}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_;var n=t.getFlatCoordinates();var r=0;var o=t.getEnds();var a=t.getStride();i.beginPath();for(var s=0,u=o.length;s<u;++s){r=this.moveToLineTo_(n,r,o[s],a,false)}i.stroke()}if(this.text_!==""){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}};e.prototype.drawPolygon=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}if(!ct(this.extent_,t.getExtent())){return}if(this.strokeState_||this.fillState_){if(this.fillState_){this.setContextFillState_(this.fillState_)}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_)}var e=this.context_;e.beginPath();this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride());if(this.fillState_){e.fill()}if(this.strokeState_){e.stroke()}}if(this.text_!==""){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}};e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}if(!ct(this.extent_,t.getExtent())){return}if(this.strokeState_||this.fillState_){if(this.fillState_){this.setContextFillState_(this.fillState_)}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_)}var e=this.context_;var i=t.getOrientedFlatCoordinates();var n=0;var r=t.getEndss();var o=t.getStride();e.beginPath();for(var a=0,s=r.length;a<s;++a){var u=r[a];n=this.drawRings_(i,n,u,o)}if(this.fillState_){e.fill()}if(this.strokeState_){e.stroke()}}if(this.text_!==""){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}};e.prototype.setContextFillState_=function(t){var e=this.context_;var i=this.contextFillState_;if(!i){e.fillStyle=t.fillStyle;this.contextFillState_={fillStyle:t.fillStyle}}else{if(i.fillStyle!=t.fillStyle){i.fillStyle=t.fillStyle;e.fillStyle=t.fillStyle}}};e.prototype.setContextStrokeState_=function(t){var e=this.context_;var i=this.contextStrokeState_;if(!i){e.lineCap=t.lineCap;if(e.setLineDash){e.setLineDash(t.lineDash);e.lineDashOffset=t.lineDashOffset}e.lineJoin=t.lineJoin;e.lineWidth=t.lineWidth;e.miterLimit=t.miterLimit;e.strokeStyle=t.strokeStyle;this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle}}else{if(i.lineCap!=t.lineCap){i.lineCap=t.lineCap;e.lineCap=t.lineCap}if(e.setLineDash){if(!l(i.lineDash,t.lineDash)){e.setLineDash(i.lineDash=t.lineDash)}if(i.lineDashOffset!=t.lineDashOffset){i.lineDashOffset=t.lineDashOffset;e.lineDashOffset=t.lineDashOffset}}if(i.lineJoin!=t.lineJoin){i.lineJoin=t.lineJoin;e.lineJoin=t.lineJoin}if(i.lineWidth!=t.lineWidth){i.lineWidth=t.lineWidth;e.lineWidth=t.lineWidth}if(i.miterLimit!=t.miterLimit){i.miterLimit=t.miterLimit;e.miterLimit=t.miterLimit}if(i.strokeStyle!=t.strokeStyle){i.strokeStyle=t.strokeStyle;e.strokeStyle=t.strokeStyle}}};e.prototype.setContextTextState_=function(t){var e=this.context_;var i=this.contextTextState_;var n=t.textAlign?t.textAlign:Ze;if(!i){e.font=t.font;e.textAlign=n;e.textBaseline=t.textBaseline;this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline}}else{if(i.font!=t.font){i.font=t.font;e.font=t.font}if(i.textAlign!=n){i.textAlign=n;e.textAlign=n}if(i.textBaseline!=t.textBaseline){i.textBaseline=t.textBaseline;e.textBaseline=t.textBaseline}}};e.prototype.setFillStrokeStyle=function(t,e){if(!t){this.fillState_=null}else{var i=t.getColor();this.fillState_={fillStyle:ve(i?i:Ge)}}if(!e){this.strokeState_=null}else{var n=e.getColor();var r=e.getLineCap();var o=e.getLineDash();var a=e.getLineDashOffset();var s=e.getLineJoin();var u=e.getWidth();var l=e.getMiterLimit();this.strokeState_={lineCap:r!==undefined?r:je,lineDash:o?o:Ye,lineDashOffset:a?a:ze,lineJoin:s!==undefined?s:Xe,lineWidth:this.pixelRatio_*(u!==undefined?u:Ve),miterLimit:l!==undefined?l:We,strokeStyle:ve(n?n:Ke)}}};e.prototype.setImageStyle=function(t){if(!t){this.image_=null}else{var e=t.getSize();if(!e){this.image_=null}else{var i=t.getAnchor();var n=t.getImage(1);var r=t.getOrigin();var o=t.getScaleArray();this.imageAnchorX_=i[0];this.imageAnchorY_=i[1];this.imageHeight_=e[1];this.image_=n;this.imageOpacity_=t.getOpacity();this.imageOriginX_=r[0];this.imageOriginY_=r[1];this.imageRotateWithView_=t.getRotateWithView();this.imageRotation_=t.getRotation();this.imageScale_=[this.pixelRatio_*o[0],this.pixelRatio_*o[1]];this.imageWidth_=e[0]}}};e.prototype.setTextStyle=function(t){if(!t){this.text_=""}else{var e=t.getFill();if(!e){this.textFillState_=null}else{var i=e.getColor();this.textFillState_={fillStyle:ve(i?i:Ge)}}var n=t.getStroke();if(!n){this.textStrokeState_=null}else{var r=n.getColor();var o=n.getLineCap();var a=n.getLineDash();var s=n.getLineDashOffset();var u=n.getLineJoin();var l=n.getWidth();var h=n.getMiterLimit();this.textStrokeState_={lineCap:o!==undefined?o:je,lineDash:a?a:Ye,lineDashOffset:s?s:ze,lineJoin:u!==undefined?u:Xe,lineWidth:l!==undefined?l:Ve,miterLimit:h!==undefined?h:We,strokeStyle:ve(r?r:Ke)}}var f=t.getFont();var c=t.getOffsetX();var p=t.getOffsetY();var d=t.getRotateWithView();var v=t.getRotation();var _=t.getScaleArray();var g=t.getText();var y=t.getTextAlign();var m=t.getTextBaseline();this.textState_={font:f!==undefined?f:ke,textAlign:y!==undefined?y:Ze,textBaseline:m!==undefined?m:Ue};this.text_=g!==undefined?g:"";this.textOffsetX_=c!==undefined?this.pixelRatio_*c:0;this.textOffsetY_=p!==undefined?this.pixelRatio_*p:0;this.textRotateWithView_=d!==undefined?d:false;this.textRotation_=v!==undefined?v:0;this.textScale_=[this.pixelRatio_*_[0],this.pixelRatio_*_[1]]}};return e}(de);var Sn={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};var In={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var wn=.5;var Pn={Point:zn,LineString:Gn,Polygon:Wn,MultiPoint:Xn,MultiLineString:jn,MultiPolygon:Yn,GeometryCollection:kn,Circle:Mn};function bn(t,e){return parseInt(g(t),10)-parseInt(g(e),10)}function Ln(t,e){var i=An(t,e);return i*i}function An(t,e){return wn*t/e}function Mn(t,e,i,n){var r=i.getFill();var o=i.getStroke();if(r||o){var a=t.getBuilder(i.getZIndex(),Sn.CIRCLE);a.setFillStrokeStyle(r,o);a.drawCircle(e,n)}var s=i.getText();if(s){var u=t.getBuilder(i.getZIndex(),Sn.TEXT);u.setTextStyle(s,t.addDeclutter(false));u.drawText(e,n)}}function Dn(t,e,i,n,r,o){var a=false;var s=i.getImage();if(s){var u=s.getImageState();if(u==In.LOADED||u==In.ERROR){s.unlistenImageChange(r)}else{if(u==In.IDLE){s.load()}u=s.getImageState();s.listenImageChange(r);a=true}}Fn(t,e,i,n,o);return a}function Fn(t,e,i,n,r){var o=i.getGeometryFunction()(e);if(!o){return}var a=o.simplifyTransformed(n,r);var s=i.getRenderer();if(s){Nn(t,a,i,e)}else{var u=Pn[a.getType()];u(t,a,i,e)}}function Nn(t,e,i,n){if(e.getType()==pe.GEOMETRY_COLLECTION){var r=e.getGeometries();for(var o=0,a=r.length;o<a;++o){Nn(t,r[o],i,n)}return}var s=t.getBuilder(i.getZIndex(),Sn.DEFAULT);s.drawCustom(e,n,i.getRenderer())}function kn(t,e,i,n){var r=e.getGeometriesArray();var o,a;for(o=0,a=r.length;o<a;++o){var s=Pn[r[o].getType()];s(t,r[o],i,n)}}function Gn(t,e,i,n){var r=i.getStroke();if(r){var o=t.getBuilder(i.getZIndex(),Sn.LINE_STRING);o.setFillStrokeStyle(null,r);o.drawLineString(e,n)}var a=i.getText();if(a){var s=t.getBuilder(i.getZIndex(),Sn.TEXT);s.setTextStyle(a,t.addDeclutter(false));s.drawText(e,n)}}function jn(t,e,i,n){var r=i.getStroke();if(r){var o=t.getBuilder(i.getZIndex(),Sn.LINE_STRING);o.setFillStrokeStyle(null,r);o.drawMultiLineString(e,n)}var a=i.getText();if(a){var s=t.getBuilder(i.getZIndex(),Sn.TEXT);s.setTextStyle(a,t.addDeclutter(false));s.drawText(e,n)}}function Yn(t,e,i,n){var r=i.getFill();var o=i.getStroke();if(o||r){var a=t.getBuilder(i.getZIndex(),Sn.POLYGON);a.setFillStrokeStyle(r,o);a.drawMultiPolygon(e,n)}var s=i.getText();if(s){var u=t.getBuilder(i.getZIndex(),Sn.TEXT);u.setTextStyle(s,t.addDeclutter(false));u.drawText(e,n)}}function zn(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=In.LOADED){return}var o=t.getBuilder(i.getZIndex(),Sn.IMAGE);o.setImageStyle(r,t.addDeclutter(false));o.drawPoint(e,n)}var a=i.getText();if(a){var s=t.getBuilder(i.getZIndex(),Sn.TEXT);s.setTextStyle(a,t.addDeclutter(!!r));s.drawText(e,n)}}function Xn(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=In.LOADED){return}var o=t.getBuilder(i.getZIndex(),Sn.IMAGE);o.setImageStyle(r,t.addDeclutter(false));o.drawMultiPoint(e,n)}var a=i.getText();if(a){var s=t.getBuilder(i.getZIndex(),Sn.TEXT);s.setTextStyle(a,t.addDeclutter(!!r));s.drawText(e,n)}}function Wn(t,e,i,n){var r=i.getFill();var o=i.getStroke();if(r||o){var a=t.getBuilder(i.getZIndex(),Sn.POLYGON);a.setFillStrokeStyle(r,o);a.drawPolygon(e,n)}var s=i.getText();if(s){var u=t.getBuilder(i.getZIndex(),Sn.TEXT);u.setTextStyle(s,t.addDeclutter(false));u.drawText(e,n)}}function Kn(t,e){if(e){e.clear()}var i=t.declutterItems;for(var n=i.length-1;n>=0;--n){var r=i[n];var o=r.items;for(var a=0,s=o.length;a<s;a+=3){e=o[a].renderDeclutter(o[a+1],o[a+2],r.opacity,e)}}i.length=0;return e}var Zn=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Un=function(t){Zn(e,t);function e(e){var i=t.call(this)||this;i.map_=e;i.declutterTree_=null;return i}e.prototype.dispatchRenderEvent=function(t,e){v()};e.prototype.calculateMatrices2D=function(t){var e=t.viewState;var i=t.coordinateToPixelTransform;var n=t.pixelToCoordinateTransform;w(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]);P(n,i)};e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,a,s){var u;var l=e.viewState;function h(t,e,i){return r.call(o,e,t?i:null)}var f=l.projection;var c=Zi(t.slice(),f);var p=[[0,0]];if(f.canWrapX()&&n){var d=f.getExtent();var v=ft(d);p.push([-v,0],[v,0])}var _=e.layerStatesArray;var g=_.length;var y;if(this.declutterTree_){y=this.declutterTree_.all().map((function(t){return t.value}))}var m=[];for(var x=0;x<p.length;x++){for(var E=g-1;E>=0;--E){var T=_[E];var R=T.layer;if(R.hasRenderer()&&ce(T,l)&&a.call(s,R)){var O=R.getRenderer();var C=R.getSource();if(O&&C){var S=C.getWrapX()?c:t;var I=h.bind(null,T.managed);m[0]=S[0]+p[x][0];m[1]=S[1]+p[x][1];u=O.forEachFeatureAtCoordinate(m,e,i,I,y)}if(u){return u}}}}return undefined};e.prototype.forEachLayerAtPixel=function(t,e,i,n,r){return v()};e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r,o){var a=this.forEachFeatureAtCoordinate(t,e,i,n,f,this,r,o);return a!==undefined};e.prototype.getMap=function(){return this.map_};e.prototype.renderFrame=function(t){this.declutterTree_=Kn(t,this.declutterTree_)};e.prototype.scheduleExpireIconCache=function(t){if(Gt.canExpireCache()){t.postRenderFunctions.push(Bn)}};return e}(r);function Bn(t,e){Gt.expire()}var Vn=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Hn=function(t){Vn(e,t);function e(e,i,n,r){var o=t.call(this,e)||this;o.inversePixelTransform=i;o.frameState=n;o.context=r;return o}return e}(jt);var qn=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Jn=function(t){qn(e,t);function e(e){var i=t.call(this,e)||this;i.fontChangeListenerKey_=Vt(He,Yt.PROPERTYCHANGE,e.redrawText.bind(e));i.element_=document.createElement("div");var n=i.element_.style;n.position="absolute";n.width="100%";n.height="100%";n.zIndex="0";i.element_.className=Le+" ol-layers";var r=e.getViewport();r.insertBefore(i.element_,r.firstChild||null);i.children_=[];i.renderedVisible_=true;return i}e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap();if(i.hasListener(t)){var n=new Hn(t,undefined,e);i.dispatchEvent(n)}};e.prototype.disposeInternal=function(){qt(this.fontChangeListenerKey_);this.element_.parentNode.removeChild(this.element_);t.prototype.disposeInternal.call(this)};e.prototype.renderFrame=function(e){if(!e){if(this.renderedVisible_){this.element_.style.display="none";this.renderedVisible_=false}return}this.calculateMatrices2D(e);this.dispatchRenderEvent(ue.PRECOMPOSE,e);var i=e.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex}));var n=e.viewState;this.children_.length=0;var r=null;for(var o=0,a=i.length;o<a;++o){var s=i[o];e.layerIndex=o;if(!ce(s,n)||s.sourceState!=le.READY&&s.sourceState!=le.UNDEFINED){continue}var u=s.layer;var l=u.render(e,r);if(!l){continue}if(l!==r){this.children_.push(l);r=l}}t.prototype.renderFrame.call(this,e);Pe(this.element_,this.children_);this.dispatchRenderEvent(ue.POSTCOMPOSE,e);if(!this.renderedVisible_){this.element_.style.display="";this.renderedVisible_=true}this.scheduleExpireIconCache(e)};e.prototype.forEachLayerAtPixel=function(t,e,i,n,r){var o=e.viewState;var a=e.layerStatesArray;var s=a.length;for(var u=s-1;u>=0;--u){var l=a[u];var h=l.layer;if(h.hasRenderer()&&ce(l,o)&&r(h)){var f=h.getRenderer();var c=f.getDataAtPixel(t,e,i);if(c){var p=n(h,c);if(p){return p}}}}return undefined};return e}(Un);var Qn={ADD:"add",REMOVE:"remove"};var $n=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var tr={LENGTH:"length"};var er=function(t){$n(e,t);function e(e,i,n){var r=t.call(this,e)||this;r.element=i;r.index=n;return r}return e}(jt);var ir=function(t){$n(e,t);function e(e,i){var n=t.call(this)||this;var r=i||{};n.unique_=!!r.unique;n.array_=e?e:[];if(n.unique_){for(var o=0,a=n.array_.length;o<a;++o){n.assertUnique_(n.array_[o],o)}}n.updateLength_();return n}e.prototype.clear=function(){while(this.getLength()>0){this.pop()}};e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e){this.push(t[e])}return this};e.prototype.forEach=function(t){var e=this.array_;for(var i=0,n=e.length;i<n;++i){t(e[i],i,e)}};e.prototype.getArray=function(){return this.array_};e.prototype.item=function(t){return this.array_[t]};e.prototype.getLength=function(){return this.get(tr.LENGTH)};e.prototype.insertAt=function(t,e){if(this.unique_){this.assertUnique_(e)}this.array_.splice(t,0,e);this.updateLength_();this.dispatchEvent(new er(Qn.ADD,e,t))};e.prototype.pop=function(){return this.removeAt(this.getLength()-1)};e.prototype.push=function(t){if(this.unique_){this.assertUnique_(t)}var e=this.getLength();this.insertAt(e,t);return this.getLength()};e.prototype.remove=function(t){var e=this.array_;for(var i=0,n=e.length;i<n;++i){if(e[i]===t){return this.removeAt(i)}}return undefined};e.prototype.removeAt=function(t){var e=this.array_[t];this.array_.splice(t,1);this.updateLength_();this.dispatchEvent(new er(Qn.REMOVE,e,t));return e};e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){if(this.unique_){this.assertUnique_(e,t)}var n=this.array_[t];this.array_[t]=e;this.dispatchEvent(new er(Qn.REMOVE,n,t));this.dispatchEvent(new er(Qn.ADD,e,t))}else{for(var r=i;r<t;++r){this.insertAt(r,undefined)}this.insertAt(t,e)}};e.prototype.updateLength_=function(){this.set(tr.LENGTH,this.array_.length)};e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i){if(this.array_[i]===t&&i!==e){throw new x(58)}}};return e}(ie);var nr=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var rr={LAYERS:"layers"};var or=function(t){nr(e,t);function e(e){var i=this;var n=e||{};var r=zt({},n);delete r.layers;var o=n.layers;i=t.call(this,r)||this;i.layersListenerKeys_=[];i.listenerKeys_={};i.addEventListener(re(rr.LAYERS),i.handleLayersChanged_);if(o){if(Array.isArray(o)){o=new ir(o.slice(),{unique:true})}else{E(typeof o.getArray==="function",43)}}else{o=new ir(undefined,{unique:true})}i.setLayers(o);return i}e.prototype.handleLayerChange_=function(){this.changed()};e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(qt);this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(Vt(t,Qn.ADD,this.handleLayersAdd_,this),Vt(t,Qn.REMOVE,this.handleLayersRemove_,this));for(var e in this.listenerKeys_){this.listenerKeys_[e].forEach(qt)}Xt(this.listenerKeys_);var i=t.getArray();for(var n=0,r=i.length;n<r;n++){var o=i[n];this.listenerKeys_[g(o)]=[Vt(o,Yt.PROPERTYCHANGE,this.handleLayerChange_,this),Vt(o,Bt.CHANGE,this.handleLayerChange_,this)]}this.changed()};e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[g(e)]=[Vt(e,Yt.PROPERTYCHANGE,this.handleLayerChange_,this),Vt(e,Bt.CHANGE,this.handleLayerChange_,this)];this.changed()};e.prototype.handleLayersRemove_=function(t){var e=t.element;var i=g(e);this.listenerKeys_[i].forEach(qt);delete this.listenerKeys_[i];this.changed()};e.prototype.getLayers=function(){return this.get(rr.LAYERS)};e.prototype.setLayers=function(t){this.set(rr.LAYERS,t)};e.prototype.getLayersArray=function(t){var e=t!==undefined?t:[];this.getLayers().forEach((function(t){t.getLayersArray(e)}));return e};e.prototype.getLayerStatesArray=function(t){var e=t!==undefined?t:[];var i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));var n=this.getLayerState();for(var r=i,o=e.length;r<o;r++){var a=e[r];a.opacity*=n.opacity;a.visible=a.visible&&n.visible;a.maxResolution=Math.min(a.maxResolution,n.maxResolution);a.minResolution=Math.max(a.minResolution,n.minResolution);a.minZoom=Math.max(a.minZoom,n.minZoom);a.maxZoom=Math.min(a.maxZoom,n.maxZoom);if(n.extent!==undefined){if(a.extent!==undefined){a.extent=ut(a.extent,n.extent)}else{a.extent=n.extent}}}return e};e.prototype.getSourceState=function(){return le.READY};return e}(se);var ar=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var sr=function(t){ar(e,t);function e(e,i,n){var r=t.call(this,e)||this;r.map=i;r.frameState=n!==undefined?n:null;return r}return e}(jt);var ur=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var lr=function(t){ur(e,t);function e(e,i,n,r,o){var a=t.call(this,e,i,o)||this;a.originalEvent=n;a.pixel_=null;a.coordinate_=null;a.dragging=r!==undefined?r:false;return a}Object.defineProperty(e.prototype,"pixel",{get:function(){if(!this.pixel_){this.pixel_=this.map.getEventPixel(this.originalEvent)}return this.pixel_},set:function(t){this.pixel_=t},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"coordinate",{get:function(){if(!this.coordinate_){this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)}return this.coordinate_},set:function(t){this.coordinate_=t},enumerable:false,configurable:true});e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this);this.originalEvent.preventDefault()};e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this);this.originalEvent.stopPropagation()};return e}(sr);var hr={SINGLECLICK:"singleclick",CLICK:Bt.CLICK,DBLCLICK:Bt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var fr={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var cr=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var pr=function(t){cr(e,t);function e(e,i){var n=t.call(this,e)||this;n.map_=e;n.dragging_=false;n.dragListenerKeys_=[];n.moveTolerance_=i?i*Ee:Ee;n.down_=null;var r=n.map_.getViewport();n.activePointers_=0;n.trackedTouches_={};n.element_=r;n.pointerdownListenerKey_=Vt(r,fr.POINTERDOWN,n.handlePointerDown_,n);n.relayedListenerKey_=Vt(r,fr.POINTERMOVE,n.relayEvent_,n);n.boundHandleTouchMove_=n.handleTouchMove_.bind(n);n.element_.addEventListener(Bt.TOUCHMOVE,n.boundHandleTouchMove_,Oe?{passive:false}:false);return n}e.prototype.emulateClick_=function(t){var e=new lr(hr.CLICK,this.map_,t);this.dispatchEvent(e);if(this.clickTimeoutId_!==undefined){clearTimeout(this.clickTimeoutId_);this.clickTimeoutId_=undefined;e=new lr(hr.DBLCLICK,this.map_,t);this.dispatchEvent(e)}else{this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=undefined;var e=new lr(hr.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)}};e.prototype.updateActivePointers_=function(t){var e=t;if(e.type==hr.POINTERUP||e.type==hr.POINTERCANCEL){delete this.trackedTouches_[e.pointerId]}else if(e.type==hr.POINTERDOWN){this.trackedTouches_[e.pointerId]=true}this.activePointers_=Object.keys(this.trackedTouches_).length};e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new lr(hr.POINTERUP,this.map_,t);this.dispatchEvent(e);if(!e.propagationStopped&&!this.dragging_&&this.isMouseActionButton_(t)){this.emulateClick_(this.down_)}if(this.activePointers_===0){this.dragListenerKeys_.forEach(qt);this.dragListenerKeys_.length=0;this.dragging_=false;this.down_=null}};e.prototype.isMouseActionButton_=function(t){return t.button===0};e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new lr(hr.POINTERDOWN,this.map_,t);this.dispatchEvent(e);this.down_=t;if(this.dragListenerKeys_.length===0){this.dragListenerKeys_.push(Vt(document,hr.POINTERMOVE,this.handlePointerMove_,this),Vt(document,hr.POINTERUP,this.handlePointerUp_,this),Vt(this.element_,hr.POINTERCANCEL,this.handlePointerUp_,this));if(this.element_.getRootNode&&this.element_.getRootNode()!==document){this.dragListenerKeys_.push(Vt(this.element_.getRootNode(),hr.POINTERUP,this.handlePointerUp_,this))}}};e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=true;var e=new lr(hr.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}};e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new lr(t.type,this.map_,t,e))};e.prototype.handleTouchMove_=function(t){if(!this.originalPointerMoveEvent_||this.originalPointerMoveEvent_.defaultPrevented){t.preventDefault()}};e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_};e.prototype.disposeInternal=function(){if(this.relayedListenerKey_){qt(this.relayedListenerKey_);this.relayedListenerKey_=null}this.element_.removeEventListener(Bt.TOUCHMOVE,this.boundHandleTouchMove_);if(this.pointerdownListenerKey_){qt(this.pointerdownListenerKey_);this.pointerdownListenerKey_=null}this.dragListenerKeys_.forEach(qt);this.dragListenerKeys_.length=0;this.element_=null;t.prototype.disposeInternal.call(this)};return e}(Ut);var dr={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};var vr={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var _r=Infinity;var gr=function(){function t(t,e){this.priorityFunction_=t;this.keyFunction_=e;this.elements_=[];this.priorities_=[];this.queuedElements_={}}t.prototype.clear=function(){this.elements_.length=0;this.priorities_.length=0;Xt(this.queuedElements_)};t.prototype.dequeue=function(){var t=this.elements_;var e=this.priorities_;var i=t[0];if(t.length==1){t.length=0;e.length=0}else{t[0]=t.pop();e[0]=e.pop();this.siftUp_(0)}var n=this.keyFunction_(i);delete this.queuedElements_[n];return i};t.prototype.enqueue=function(t){E(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);if(e!=_r){this.elements_.push(t);this.priorities_.push(e);this.queuedElements_[this.keyFunction_(t)]=true;this.siftDown_(0,this.elements_.length-1);return true}return false};t.prototype.getCount=function(){return this.elements_.length};t.prototype.getLeftChildIndex_=function(t){return t*2+1};t.prototype.getRightChildIndex_=function(t){return t*2+2};t.prototype.getParentIndex_=function(t){return t-1>>1};t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--){this.siftUp_(t)}};t.prototype.isEmpty=function(){return this.elements_.length===0};t.prototype.isKeyQueued=function(t){return t in this.queuedElements_};t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))};t.prototype.siftUp_=function(t){var e=this.elements_;var i=this.priorities_;var n=e.length;var r=e[t];var o=i[t];var a=t;while(t<n>>1){var s=this.getLeftChildIndex_(t);var u=this.getRightChildIndex_(t);var l=u<n&&i[u]<i[s]?u:s;e[t]=e[l];i[t]=i[l];t=l}e[t]=r;i[t]=o;this.siftDown_(a,t)};t.prototype.siftDown_=function(t,e){var i=this.elements_;var n=this.priorities_;var r=i[e];var o=n[e];while(e>t){var a=this.getParentIndex_(e);if(n[a]>o){i[e]=i[a];n[e]=n[a];e=a}else{break}}i[e]=r;n[e]=o};t.prototype.reprioritize=function(){var t=this.priorityFunction_;var e=this.elements_;var i=this.priorities_;var n=0;var r=e.length;var o,a,s;for(a=0;a<r;++a){o=e[a];s=t(o);if(s==_r){delete this.queuedElements_[this.keyFunction_(o)]}else{i[n]=s;e[n++]=o}}e.length=n;i.length=n;this.heapify_()};return t}();var yr={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var mr=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var xr=function(t){mr(e,t);function e(e,i){var n=t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()}))||this;n.boundHandleTileChange_=n.handleTileChange.bind(n);n.tileChangeCallback_=i;n.tilesLoading_=0;n.tilesLoadingKeys_={};return n}e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);if(i){var n=e[0];n.addEventListener(Bt.CHANGE,this.boundHandleTileChange_)}return i};e.prototype.getTilesLoading=function(){return this.tilesLoading_};e.prototype.handleTileChange=function(t){var e=t.target;var i=e.getState();if(e.hifi&&i===yr.LOADED||i===yr.ERROR||i===yr.EMPTY){e.removeEventListener(Bt.CHANGE,this.boundHandleTileChange_);var n=e.getKey();if(n in this.tilesLoadingKeys_){delete this.tilesLoadingKeys_[n];--this.tilesLoading_}this.tileChangeCallback_()}};e.prototype.loadMoreTiles=function(t,e){var i=0;var n,r,o;while(this.tilesLoading_<t&&i<e&&this.getCount()>0){r=this.dequeue()[0];o=r.getKey();n=r.getState();if(n===yr.IDLE&&!(o in this.tilesLoadingKeys_)){this.tilesLoadingKeys_[o]=true;++this.tilesLoading_;++i;r.load()}}};return e}(gr);function Er(t,e,i,n,r){if(!t||!(i in t.wantedTiles)){return _r}if(!t.wantedTiles[i][e.getKey()]){return _r}var o=t.viewState.center;var a=n[0]-o[0];var s=n[1]-o[1];return 65536*Math.log(r)+Math.sqrt(a*a+s*s)/r}var Tr={ANIMATING:0,INTERACTING:1};var Rr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var Or=42;var Cr=256;function Sr(t,e,i){return function(n,r,o,a){if(n){var s=e?0:o[0]*r;var u=e?0:o[1]*r;var l=t[0]+s/2;var h=t[2]-s/2;var f=t[1]+u/2;var c=t[3]-u/2;if(l>h){l=(h+l)/2;h=l}if(f>c){f=(c+f)/2;c=f}var p=yt(n[0],l,h);var d=yt(n[1],f,c);var v=30*r;if(a&&i){p+=-v*Math.log(1+Math.max(0,l-n[0])/v)+v*Math.log(1+Math.max(0,n[0]-h)/v);d+=-v*Math.log(1+Math.max(0,f-n[1])/v)+v*Math.log(1+Math.max(0,n[1]-c)/v)}return[p,d]}else{return undefined}}}function Ir(t){return t}function wr(t,e,i,n){var r=ft(e)/i[0];var o=st(e)/i[1];if(n){return Math.min(t,Math.max(r,o))}return Math.min(t,Math.min(r,o))}function Pr(t,e,i){var n=Math.min(t,e);var r=50;n*=Math.log(1+r*Math.max(0,t/e-1))/r+1;if(i){n=Math.max(n,i);n/=Math.log(1+r*Math.max(0,i/t-1))/r+1}return yt(n,i/2,e*2)}function br(t,e,i,n){return function(r,o,s,u){if(r!==undefined){var l=t[0];var h=t[t.length-1];var f=i?wr(l,i,s,n):l;if(u){var c=e!==undefined?e:true;if(!c){return yt(r,h,f)}return Pr(r,f,h)}var p=Math.min(f,r);var d=Math.floor(a(t,p,o));if(t[d]>f&&d<t.length-1){return t[d+1]}return t[d]}else{return undefined}}}function Lr(t,e,i,n,r,o){return function(a,s,u,l){if(a!==undefined){var h=r?wr(e,r,u,o):e;var f=i!==undefined?i:0;if(l){var c=n!==undefined?n:true;if(!c){return yt(a,f,h)}return Pr(a,h,f)}var p=1e-9;var d=Math.ceil(Math.log(e/h)/Math.log(t)-p);var v=-s*(.5-p)+.5;var _=Math.min(h,a);var g=Math.floor(Math.log(e/_)/Math.log(t)+v);var y=Math.max(d,g);var m=e/Math.pow(t,y);return yt(m,f,h)}else{return undefined}}}function Ar(t,e,i,n,r){return function(o,a,s,u){if(o!==undefined){var l=n?wr(t,n,s,r):t;var h=i!==undefined?i:true;if(!h||!u){return yt(o,e,l)}return Pr(o,l,e)}else{return undefined}}}function Mr(t){if(t!==undefined){return 0}else{return undefined}}function Dr(t){if(t!==undefined){return t}else{return undefined}}function Fr(t){var e=2*Math.PI/t;return function(t,i){if(i){return t}if(t!==undefined){t=Math.floor(t/e+.5)*e;return t}else{return undefined}}}function Nr(t){var e=t||Ot(5);return function(t,i){if(i){return t}if(t!==undefined){if(Math.abs(t)<=e){return 0}else{return t}}else{return undefined}}}function kr(t){return Math.pow(t,3)}function Gr(t){return 1-kr(1-t)}function jr(t){return 3*t*t-2*t*t*t}function Yr(t){return t}function zr(t,e,i,n,r,o,a){var s=t[e];var u=t[e+1];var l=t[i]-s;var h=t[i+1]-u;var f;if(l===0&&h===0){f=e}else{var c=((r-s)*l+(o-u)*h)/(l*l+h*h);if(c>1){f=i}else if(c>0){for(var p=0;p<n;++p){a[p]=St(t[e+p],t[i+p],c)}a.length=n;return}else{f=e}}for(var p=0;p<n;++p){a[p]=t[f+p]}a.length=n}function Xr(t,e,i,n,r){var o=t[e];var a=t[e+1];for(e+=n;e<i;e+=n){var s=t[e];var u=t[e+1];var l=Tt(o,a,s,u);if(l>r){r=l}o=s;a=u}return r}function Wr(t,e,i,n,r){for(var o=0,a=i.length;o<a;++o){var s=i[o];r=Xr(t,e,s,n,r);e=s}return r}function Kr(t,e,i,n,r,o,a,s,u,l,h){if(e==i){return l}var f,c;if(r===0){c=Tt(a,s,t[e],t[e+1]);if(c<l){for(f=0;f<n;++f){u[f]=t[e+f]}u.length=n;return c}else{return l}}var p=h?h:[NaN,NaN];var d=e+n;while(d<i){zr(t,d-n,d,n,a,s,p);c=Tt(a,s,p[0],p[1]);if(c<l){l=c;for(f=0;f<n;++f){u[f]=p[f]}u.length=n;d+=n}else{d+=n*Math.max((Math.sqrt(c)-Math.sqrt(l))/r|0,1)}}if(o){zr(t,i-n,e,n,a,s,p);c=Tt(a,s,p[0],p[1]);if(c<l){l=c;for(f=0;f<n;++f){u[f]=p[f]}u.length=n}}return l}function Zr(t,e,i,n,r,o,a,s,u,l,h){var f=h?h:[NaN,NaN];for(var c=0,p=i.length;c<p;++c){var d=i[c];l=Kr(t,e,d,n,r,o,a,s,u,l,f);e=d}return l}function Ur(t,e,i,n){for(var r=0,o=i.length;r<o;++r){t[e++]=i[r]}return e}function Br(t,e,i,n){for(var r=0,o=i.length;r<o;++r){var a=i[r];for(var s=0;s<n;++s){t[e++]=a[s]}}return e}function Vr(t,e,i,n,r){var o=r?r:[];var a=0;for(var s=0,u=i.length;s<u;++s){var l=Br(t,e,i[s],n);o[a++]=l;e=l}o.length=a;return o}function Hr(t,e,i,n,r,o,a){var s=(i-e)/n;if(s<3){for(;e<i;e+=n){o[a++]=t[e];o[a++]=t[e+1]}return a}var u=new Array(s);u[0]=1;u[s-1]=1;var l=[e,i-n];var h=0;while(l.length>0){var f=l.pop();var c=l.pop();var p=0;var d=t[c];var v=t[c+1];var _=t[f];var g=t[f+1];for(var y=c+n;y<f;y+=n){var m=t[y];var x=t[y+1];var E=Et(m,x,d,v,_,g);if(E>p){h=y;p=E}}if(p>r){u[(h-e)/n]=1;if(c+n<h){l.push(c,h)}if(h+n<f){l.push(h,f)}}}for(var y=0;y<s;++y){if(u[y]){o[a++]=t[e+y*n];o[a++]=t[e+y*n+1]}}return a}function qr(t,e){return e*Math.round(t/e)}function Jr(t,e,i,n,r,o,a){if(e==i){return a}var s=qr(t[e],r);var u=qr(t[e+1],r);e+=n;o[a++]=s;o[a++]=u;var l,h;do{l=qr(t[e],r);h=qr(t[e+1],r);e+=n;if(e==i){o[a++]=l;o[a++]=h;return a}}while(l==s&&h==u);while(e<i){var f=qr(t[e],r);var c=qr(t[e+1],r);e+=n;if(f==l&&c==h){continue}var p=l-s;var d=h-u;var v=f-s;var _=c-u;if(p*_==d*v&&(p<0&&v<p||p==v||p>0&&v>p)&&(d<0&&_<d||d==_||d>0&&_>d)){l=f;h=c;continue}o[a++]=l;o[a++]=h;s=l;u=h;l=f;h=c}o[a++]=l;o[a++]=h;return a}function Qr(t,e,i,n,r,o,a,s){for(var u=0,l=i.length;u<l;++u){var h=i[u];a=Jr(t,e,h,n,r,o,a);s.push(a);e=h}return a}function $r(t,e,i,n,r){var o=r!==undefined?r:[];var a=0;for(var s=e;s<i;s+=n){o[a++]=t.slice(s,s+n)}o.length=a;return o}function to(t,e,i,n,r){var o=r!==undefined?r:[];var a=0;for(var s=0,u=i.length;s<u;++s){var l=i[s];o[a++]=$r(t,e,l,n,o[a]);e=l}o.length=a;return o}function eo(t,e,i,n,r){var o=r!==undefined?r:[];var a=0;for(var s=0,u=i.length;s<u;++s){var l=i[s];o[a++]=to(t,e,l,n,o[a]);e=l[l.length-1]}o.length=a;return o}function io(t,e,i,n){var r=0;var o=t[i-n];var a=t[i-n+1];for(;e<i;e+=n){var s=t[e];var u=t[e+1];r+=a*s-o*u;o=s;a=u}return r/2}function no(t,e,i,n){var r=0;for(var o=0,a=i.length;o<a;++o){var s=i[o];r+=io(t,e,s,n);e=s}return r}var ro=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var oo=function(t){ro(e,t);function e(e,i){var n=t.call(this)||this;n.maxDelta_=-1;n.maxDeltaRevision_=-1;if(i!==undefined&&!Array.isArray(e[0])){n.setFlatCoordinates(i,e)}else{n.setCoordinates(e,i)}return n}e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)};e.prototype.closestPointXY=function(t,e,i,n){if(n<k(this.getExtent(),t,e)){return n}if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(Xr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return Kr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,true,t,e,i,n)};e.prototype.getArea=function(){return io(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};e.prototype.getCoordinates=function(){return $r(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];i.length=Hr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0);return new e(i,yn.XY)};e.prototype.getType=function(){return pe.LINEAR_RING};e.prototype.intersectsExtent=function(t){return false};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1);if(!this.flatCoordinates){this.flatCoordinates=[]}this.flatCoordinates.length=Br(this.flatCoordinates,0,t,this.stride);this.changed()};return e}(xn);var ao=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var so=function(t){ao(e,t);function e(e,i){var n=t.call(this)||this;n.setCoordinates(e,i);return n}e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t};e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates;var o=Tt(t,e,r[0],r[1]);if(o<n){var a=this.stride;for(var s=0;s<a;++s){i[s]=r[s]}i.length=a;return o}else{return n}};e.prototype.getCoordinates=function(){return!this.flatCoordinates?[]:this.flatCoordinates.slice()};e.prototype.computeExtent=function(t){return Z(this.flatCoordinates,t)};e.prototype.getType=function(){return pe.POINT};e.prototype.intersectsExtent=function(t){return Y(t,this.flatCoordinates[0],this.flatCoordinates[1])};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0);if(!this.flatCoordinates){this.flatCoordinates=[]}this.flatCoordinates.length=Ur(this.flatCoordinates,0,t);this.changed()};return e}(xn);function uo(t,e,i,n,r){var o=tt(r,(function(r){return!lo(t,e,i,n,r[0],r[1])}));return!o}function lo(t,e,i,n,r,o){var a=0;var s=t[i-n];var u=t[i-n+1];for(;e<i;e+=n){var l=t[e];var h=t[e+1];if(u<=o){if(h>o&&(l-s)*(o-u)-(r-s)*(h-u)>0){a++}}else if(h<=o&&(l-s)*(o-u)-(r-s)*(h-u)<0){a--}s=l;u=h}return a!==0}function ho(t,e,i,n,r,o){if(i.length===0){return false}if(!lo(t,e,i[0],n,r,o)){return false}for(var a=1,s=i.length;a<s;++a){if(lo(t,i[a-1],i[a],n,r,o)){return false}}return true}function fo(t,e,i,n,r,a,s){var u,l,h,f,c,p,d;var v=r[a+1];var _=[];for(var g=0,y=i.length;g<y;++g){var m=i[g];f=t[m-n];p=t[m-n+1];for(u=e;u<m;u+=n){c=t[u];d=t[u+1];if(v<=p&&d<=v||p<=v&&v<=d){h=(v-p)/(d-p)*(c-f)+f;_.push(h)}f=c;p=d}}var x=NaN;var E=-Infinity;_.sort(o);f=_[0];for(u=1,l=_.length;u<l;++u){c=_[u];var T=Math.abs(c-f);if(T>E){h=(f+c)/2;if(ho(t,e,i,n,h,v)){x=h;E=T}}f=c}if(isNaN(x)){x=r[a]}if(s){s.push(x,v,E);return s}else{return[x,v,E]}}function co(t,e,i,n,r){var o=[t[e],t[e+1]];var a=[];var s;for(;e+n<i;e+=n){a[0]=t[e+n];a[1]=t[e+n+1];s=r(o,a);if(s){return s}o[0]=a[0];o[1]=a[1]}return false}function po(t,e,i,n,r){var o=Q(X(),t,e,i,n);if(!ct(r,o)){return false}if(j(r,o)){return true}if(o[0]>=r[0]&&o[2]<=r[2]){return true}if(o[1]>=r[1]&&o[3]<=r[3]){return true}return co(t,e,i,n,(function(t,e){return _t(r,t,e)}))}function vo(t,e,i,n,r){if(po(t,e,i,n,r)){return true}if(lo(t,e,i,n,r[0],r[1])){return true}if(lo(t,e,i,n,r[0],r[3])){return true}if(lo(t,e,i,n,r[2],r[1])){return true}if(lo(t,e,i,n,r[2],r[3])){return true}return false}function _o(t,e,i,n,r){if(!vo(t,e,i[0],n,r)){return false}if(i.length===1){return true}for(var o=1,a=i.length;o<a;++o){if(uo(t,i[o-1],i[o],n,r)){if(!po(t,i[o-1],i[o],n,r)){return false}}}return true}function go(t,e,i,n){while(e<i-n){for(var r=0;r<n;++r){var o=t[e+r];t[e+r]=t[i-n+r];t[i-n+r]=o}e+=n;i-=n}}function yo(t,e,i,n){var r=true;for(var o=0;o<n;++o){if(t[e+o]!==t[i-n+o]){r=false;break}}if(r){i-=n}var a=mo(t,e,i,n);var s=a-n;if(s<e){s=i-n}var u=a+n;if(u>=i){u=e}var l=t[s];var h=t[s+1];var f=t[a];var c=t[a+1];var p=t[u];var d=t[u+1];var v=f*d+l*c+h*p-(h*f+c*p+l*d);return v<0}function mo(t,e,i,n){var r=-1;var o=Infinity;var a=Infinity;for(var s=e;s<i;s+=n){var u=t[s];var l=t[s+1];if(l>o){continue}if(l==o){if(u>=a){continue}}r=s;o=l;a=u}return r}function xo(t,e,i,n,r){var o=r!==undefined?r:false;for(var a=0,s=i.length;a<s;++a){var u=i[a];var l=yo(t,e,u,n);if(a===0){if(o&&l||!o&&!l){return false}}else{if(o&&!l||!o&&l){return false}}e=u}return true}function Eo(t,e,i,n,r){var o=r!==undefined?r:false;for(var a=0,s=i.length;a<s;++a){var u=i[a];var l=yo(t,e,u,n);var h=a===0?o&&l||!o&&!l:o&&!l||!o&&l;if(h){go(t,e,u,n)}e=u}return e}var To=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ro=function(t){To(e,t);function e(e,i,n){var r=t.call(this)||this;r.ends_=[];r.flatInteriorPointRevision_=-1;r.flatInteriorPoint_=null;r.maxDelta_=-1;r.maxDeltaRevision_=-1;r.orientedRevision_=-1;r.orientedFlatCoordinates_=null;if(i!==undefined&&n){r.setFlatCoordinates(i,e);r.ends_=n}else{r.setCoordinates(e,i)}return r}e.prototype.appendLinearRing=function(t){if(!this.flatCoordinates){this.flatCoordinates=t.getFlatCoordinates().slice()}else{u(this.flatCoordinates,t.getFlatCoordinates())}this.ends_.push(this.flatCoordinates.length);this.changed()};e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())};e.prototype.closestPointXY=function(t,e,i,n){if(n<k(this.getExtent(),t,e)){return n}if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(Wr(this.flatCoordinates,0,this.ends_,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return Zr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,true,t,e,i,n)};e.prototype.containsXY=function(t,e){return ho(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)};e.prototype.getArea=function(){return no(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)};e.prototype.getCoordinates=function(t){var e;if(t!==undefined){e=this.getOrientedFlatCoordinates().slice();Eo(e,0,this.ends_,this.stride,t)}else{e=this.flatCoordinates}return to(e,0,this.ends_,this.stride)};e.prototype.getEnds=function(){return this.ends_};e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=rt(this.getExtent());this.flatInteriorPoint_=fo(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0);this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_};e.prototype.getInteriorPoint=function(){return new so(this.getFlatInteriorPoint(),yn.XYM)};e.prototype.getLinearRingCount=function(){return this.ends_.length};e.prototype.getLinearRing=function(t){if(t<0||this.ends_.length<=t){return null}return new oo(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)};e.prototype.getLinearRings=function(){var t=this.layout;var e=this.flatCoordinates;var i=this.ends_;var n=[];var r=0;for(var o=0,a=i.length;o<a;++o){var s=i[o];var u=new oo(e.slice(r,s),t);n.push(u);r=s}return n};e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;if(xo(t,0,this.ends_,this.stride)){this.orientedFlatCoordinates_=t}else{this.orientedFlatCoordinates_=t.slice();this.orientedFlatCoordinates_.length=Eo(this.orientedFlatCoordinates_,0,this.ends_,this.stride)}this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_};e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];var n=[];i.length=Qr(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n);return new e(i,yn.XY,n)};e.prototype.getType=function(){return pe.POLYGON};e.prototype.intersectsExtent=function(t){return _o(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2);if(!this.flatCoordinates){this.flatCoordinates=[]}var i=Vr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1];this.changed()};return e}(xn);function Oo(t){var e=t[0];var i=t[1];var n=t[2];var r=t[3];var o=[e,i,e,r,n,r,n,i,e,i];return new Ro(o,yn.XY,[o.length])}var Co=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var So=0;var Io=function(t){Co(e,t);function e(e){var i=t.call(this)||this;var n=zt({},e);i.hints_=[0,0];i.animations_=[];i.projection_=en(n.projection,"EPSG:3857");i.viewportSize_=[100,100];i.targetCenter_=null;i.cancelAnchor_=undefined;if(n.center){n.center=fn(n.center)}if(n.extent){n.extent=pn(n.extent)}i.applyOptions_(n);return i}e.prototype.applyOptions_=function(t){var e={};var i=bo(t);this.maxResolution_=i.maxResolution;this.minResolution_=i.minResolution;this.zoomFactor_=i.zoomFactor;this.resolutions_=t.resolutions;this.minZoom_=i.minZoom;var n=Po(t);var r=i.constraint;var o=Lo(t);this.constraints_={center:n,resolution:r,rotation:o};this.setRotation(t.rotation!==undefined?t.rotation:0);this.setCenterInternal(t.center!==undefined?t.center:null);if(t.resolution!==undefined){this.setResolution(t.resolution)}else if(t.zoom!==undefined){this.setZoom(t.zoom)}this.setProperties(e);this.options_=t};e.prototype.getUpdatedOptions_=function(t){var e=zt({},this.options_);if(e.resolution!==undefined){e.resolution=this.getResolution()}else{e.zoom=this.getZoom()}e.center=this.getCenterInternal();e.rotation=this.getRotation();return zt({},e,t)};e.prototype.animate=function(t){if(this.isDef()&&!this.getAnimating()){this.resolveConstraints(0)}var e=new Array(arguments.length);for(var i=0;i<e.length;++i){var n=arguments[i];if(n.center){n=zt({},n);n.center=fn(n.center,this.getProjection())}if(n.anchor){n=zt({},n);n.anchor=fn(n.anchor,this.getProjection())}e[i]=n}this.animateInternal.apply(this,e)};e.prototype.animateInternal=function(t){var e=arguments.length;var i;if(e>1&&typeof arguments[e-1]==="function"){i=arguments[e-1];--e}if(!this.isDef()){var n=arguments[e-1];if(n.center){this.setCenterInternal(n.center)}if(n.zoom!==undefined){this.setZoom(n.zoom)}if(n.rotation!==undefined){this.setRotation(n.rotation)}if(i){wo(i,true)}return}var r=Date.now();var o=this.targetCenter_.slice();var a=this.targetResolution_;var s=this.targetRotation_;var u=[];for(var l=0;l<e;++l){var h=arguments[l];var f={start:r,complete:false,anchor:h.anchor,duration:h.duration!==undefined?h.duration:1e3,easing:h.easing||jr,callback:i};if(h.center){f.sourceCenter=o;f.targetCenter=h.center.slice();o=f.targetCenter}if(h.zoom!==undefined){f.sourceResolution=a;f.targetResolution=this.getResolutionForZoom(h.zoom);a=f.targetResolution}else if(h.resolution){f.sourceResolution=a;f.targetResolution=h.resolution;a=f.targetResolution}if(h.rotation!==undefined){f.sourceRotation=s;var c=Ct(h.rotation-s+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=s+c;s=f.targetRotation}if(Ao(f)){f.complete=true}else{r+=f.duration}u.push(f)}this.animations_.push(u);this.setHint(Tr.ANIMATING,1);this.updateAnimations_()};e.prototype.getAnimating=function(){return this.hints_[Tr.ANIMATING]>0};e.prototype.getInteracting=function(){return this.hints_[Tr.INTERACTING]>0};e.prototype.cancelAnimations=function(){this.setHint(Tr.ANIMATING,-this.hints_[Tr.ANIMATING]);var t;for(var e=0,i=this.animations_.length;e<i;++e){var n=this.animations_[e];if(n[0].callback){wo(n[0].callback,false)}if(!t){for(var r=0,o=n.length;r<o;++r){var a=n[r];if(!a.complete){t=a.anchor;break}}}}this.animations_.length=0;this.cancelAnchor_=t};e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==undefined){cancelAnimationFrame(this.updateAnimationKey_);this.updateAnimationKey_=undefined}if(!this.getAnimating()){return}var t=Date.now();var e=false;for(var i=this.animations_.length-1;i>=0;--i){var n=this.animations_[i];var r=true;for(var o=0,a=n.length;o<a;++o){var s=n[o];if(s.complete){continue}var u=t-s.start;var l=s.duration>0?u/s.duration:1;if(l>=1){s.complete=true;l=1}else{r=false}var h=s.easing(l);if(s.sourceCenter){var f=s.sourceCenter[0];var c=s.sourceCenter[1];var p=s.targetCenter[0];var d=s.targetCenter[1];var v=f+h*(p-f);var _=c+h*(d-c);this.targetCenter_=[v,_]}if(s.sourceResolution&&s.targetResolution){var g=h===1?s.targetResolution:s.sourceResolution+h*(s.targetResolution-s.sourceResolution);if(s.anchor){var y=this.getViewportSize_(this.getRotation());var m=this.constraints_.resolution(g,0,y,true);this.targetCenter_=this.calculateCenterZoom(m,s.anchor)}this.targetResolution_=g;this.applyTargetState_(true)}if(s.sourceRotation!==undefined&&s.targetRotation!==undefined){var x=h===1?Ct(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+h*(s.targetRotation-s.sourceRotation);if(s.anchor){var E=this.constraints_.rotation(x,true);this.targetCenter_=this.calculateCenterRotate(E,s.anchor)}this.targetRotation_=x}this.applyTargetState_(true);e=true;if(!s.complete){break}}if(r){this.animations_[i]=null;this.setHint(Tr.ANIMATING,-1);var T=n[0].callback;if(T){wo(T,true)}}}this.animations_=this.animations_.filter(Boolean);if(e&&this.updateAnimationKey_===undefined){this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this))}};e.prototype.calculateCenterRotate=function(t,e){var i;var n=this.getCenterInternal();if(n!==undefined){i=[n[0]-e[0],n[1]-e[1]];Wi(i,t-this.getRotation());zi(i,e)}return i};e.prototype.calculateCenterZoom=function(t,e){var i;var n=this.getCenterInternal();var r=this.getResolution();if(n!==undefined&&r!==undefined){var o=e[0]-t*(e[0]-n[0])/r;var a=e[1]-t*(e[1]-n[1])/r;i=[o,a]}return i};e.prototype.getViewportSize_=function(t){var e=this.viewportSize_;if(t){var i=e[0];var n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}else{return e}};e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100];if(!this.getAnimating()){this.resolveConstraints(0)}};e.prototype.getCenter=function(){var t=this.getCenterInternal();if(!t){return t}return hn(t,this.getProjection())};e.prototype.getCenterInternal=function(){return this.get(Rr.CENTER)};e.prototype.getConstraints=function(){return this.constraints_};e.prototype.getConstrainResolution=function(){return this.options_.constrainResolution};e.prototype.getHints=function(t){if(t!==undefined){t[0]=this.hints_[0];t[1]=this.hints_[1];return t}else{return this.hints_.slice()}};e.prototype.calculateExtent=function(t){var e=this.calculateExtentInternal(t);return cn(e,this.getProjection())};e.prototype.calculateExtentInternal=function(t){var e=t||this.getViewportSize_();var i=this.getCenterInternal();E(i,1);var n=this.getResolution();E(n!==undefined,2);var r=this.getRotation();E(r!==undefined,3);return at(i,n,r,e)};e.prototype.getMaxResolution=function(){return this.maxResolution_};e.prototype.getMinResolution=function(){return this.minResolution_};e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)};e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))};e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)};e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))};e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))};e.prototype.getProjection=function(){return this.projection_};e.prototype.getResolution=function(){return this.get(Rr.RESOLUTION)};e.prototype.getResolutions=function(){return this.resolutions_};e.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(pn(t,this.getProjection()),e)};e.prototype.getResolutionForExtentInternal=function(t,e){var i=e||this.getViewportSize_();var n=ft(t)/i[0];var r=st(t)/i[1];return Math.max(n,r)};e.prototype.getResolutionForValueFunction=function(t){var e=t||2;var i=this.getConstrainedResolution(this.maxResolution_);var n=this.minResolution_;var r=Math.log(i/n)/Math.log(e);return function(t){var n=i/Math.pow(e,t*r);return n}};e.prototype.getRotation=function(){return this.get(Rr.ROTATION)};e.prototype.getValueForResolutionFunction=function(t){var e=Math.log(t||2);var i=this.getConstrainedResolution(this.maxResolution_);var n=this.minResolution_;var r=Math.log(i/n)/e;return function(t){var n=Math.log(i/t)/e/r;return n}};e.prototype.getState=function(){var t=this.getCenterInternal();var e=this.getProjection();var i=this.getResolution();var n=this.getRotation();return{center:t.slice(0),projection:e!==undefined?e:null,resolution:i,rotation:n,zoom:this.getZoom()}};e.prototype.getZoom=function(){var t;var e=this.getResolution();if(e!==undefined){t=this.getZoomForResolution(e)}return t};e.prototype.getZoomForResolution=function(t){var e=this.minZoom_||0;var i,n;if(this.resolutions_){var r=a(this.resolutions_,t,1);e=r;i=this.resolutions_[r];if(r==this.resolutions_.length-1){n=2}else{n=i/this.resolutions_[r+1]}}else{i=this.maxResolution_;n=this.zoomFactor_}return e+Math.log(i/t)/Math.log(n)};e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1){return 0}var e=yt(Math.floor(t),0,this.resolutions_.length-2);var i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,yt(t-e,0,1))}else{return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}};e.prototype.fit=function(t,e){var i=zt({size:this.getViewportSize_()},e||{});var n;E(Array.isArray(t)||typeof t.getSimplifiedGeometry==="function",24);if(Array.isArray(t)){E(!pt(t),25);var r=pn(t,this.getProjection());n=Oo(r)}else if(t.getType()===pe.CIRCLE){var r=pn(t.getExtent(),this.getProjection());n=Oo(r);n.rotate(this.getRotation(),rt(r))}else{var o=ln();if(o){n=t.clone().transform(o,this.getProjection())}else{n=t}}this.fitInternal(n,i)};e.prototype.fitInternal=function(t,e){var i=e||{};var n=i.size;if(!n){n=this.getViewportSize_()}var r=i.padding!==undefined?i.padding:[0,0,0,0];var o=i.nearest!==undefined?i.nearest:false;var a;if(i.minResolution!==undefined){a=i.minResolution}else if(i.maxZoom!==undefined){a=this.getResolutionForZoom(i.maxZoom)}else{a=0}var s=t.getFlatCoordinates();var u=this.getRotation();var l=Math.cos(-u);var h=Math.sin(-u);var f=+Infinity;var c=+Infinity;var d=-Infinity;var v=-Infinity;var _=t.getStride();for(var g=0,y=s.length;g<y;g+=_){var m=s[g]*l-s[g+1]*h;var x=s[g]*h+s[g+1]*l;f=Math.min(f,m);c=Math.min(c,x);d=Math.max(d,m);v=Math.max(v,x)}var E=this.getResolutionForExtentInternal([f,c,d,v],[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);E=isNaN(E)?a:Math.max(E,a);E=this.getConstrainedResolution(E,o?0:1);h=-h;var T=(f+d)/2;var R=(c+v)/2;T+=(r[1]-r[3])/2*E;R+=(r[0]-r[2])/2*E;var O=T*l-R*h;var C=R*l+T*h;var S=[O,C];var I=i.callback?i.callback:p;if(i.duration!==undefined){this.animateInternal({resolution:E,center:this.getConstrainedCenter(S,E),duration:i.duration,easing:i.easing},I)}else{this.targetResolution_=E;this.targetCenter_=S;this.applyTargetState_(false,true);wo(I,true)}};e.prototype.centerOn=function(t,e,i){this.centerOnInternal(fn(t,this.getProjection()),e,i)};e.prototype.centerOnInternal=function(t,e,i){var n=this.getRotation();var r=Math.cos(-n);var o=Math.sin(-n);var a=t[0]*r-t[1]*o;var s=t[1]*r+t[0]*o;var u=this.getResolution();a+=(e[0]/2-i[0])*u;s+=(i[1]-e[1]/2)*u;o=-o;var l=a*r-s*o;var h=s*r+a*o;this.setCenterInternal([l,h])};e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==undefined};e.prototype.adjustCenter=function(t){var e=hn(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])};e.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])};e.prototype.adjustResolution=function(t,e){var i=e&&fn(e,this.getProjection());this.adjustResolutionInternal(t,i)};e.prototype.adjustResolutionInternal=function(t,e){var i=this.getAnimating()||this.getInteracting();var n=this.getViewportSize_(this.getRotation());var r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);if(e){this.targetCenter_=this.calculateCenterZoom(r,e)}this.targetResolution_*=t;this.applyTargetState_()};e.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)};e.prototype.adjustRotation=function(t,e){if(e){e=fn(e,this.getProjection())}this.adjustRotationInternal(t,e)};e.prototype.adjustRotationInternal=function(t,e){var i=this.getAnimating()||this.getInteracting();var n=this.constraints_.rotation(this.targetRotation_+t,i);if(e){this.targetCenter_=this.calculateCenterRotate(n,e)}this.targetRotation_+=t;this.applyTargetState_()};e.prototype.setCenter=function(t){this.setCenterInternal(fn(t,this.getProjection()))};e.prototype.setCenterInternal=function(t){this.targetCenter_=t;this.applyTargetState_()};e.prototype.setHint=function(t,e){this.hints_[t]+=e;this.changed();return this.hints_[t]};e.prototype.setResolution=function(t){this.targetResolution_=t;this.applyTargetState_()};e.prototype.setRotation=function(t){this.targetRotation_=t;this.applyTargetState_()};e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))};e.prototype.applyTargetState_=function(t,e){var i=this.getAnimating()||this.getInteracting()||e;var n=this.constraints_.rotation(this.targetRotation_,i);var r=this.getViewportSize_(n);var o=this.constraints_.resolution(this.targetResolution_,0,r,i);var a=this.constraints_.center(this.targetCenter_,o,r,i);if(this.get(Rr.ROTATION)!==n){this.set(Rr.ROTATION,n)}if(this.get(Rr.RESOLUTION)!==o){this.set(Rr.RESOLUTION,o)}if(!this.get(Rr.CENTER)||!Xi(this.get(Rr.CENTER),a)){this.set(Rr.CENTER,a)}if(this.getAnimating()&&!t){this.cancelAnimations()}this.cancelAnchor_=undefined};e.prototype.resolveConstraints=function(t,e,i){var n=t!==undefined?t:200;var r=e||0;var o=this.constraints_.rotation(this.targetRotation_);var a=this.getViewportSize_(o);var s=this.constraints_.resolution(this.targetResolution_,r,a);var u=this.constraints_.center(this.targetCenter_,s,a);if(n===0&&!this.cancelAnchor_){this.targetResolution_=s;this.targetRotation_=o;this.targetCenter_=u;this.applyTargetState_();return}var l=i||(n===0?this.cancelAnchor_:undefined);this.cancelAnchor_=undefined;if(this.getResolution()!==s||this.getRotation()!==o||!this.getCenterInternal()||!Xi(this.getCenterInternal(),u)){if(this.getAnimating()){this.cancelAnimations()}this.animateInternal({rotation:o,center:u,resolution:s,duration:n,easing:Gr,anchor:l})}};e.prototype.beginInteraction=function(){this.resolveConstraints(0);this.setHint(Tr.INTERACTING,1)};e.prototype.endInteraction=function(t,e,i){var n=i&&fn(i,this.getProjection());this.endInteractionInternal(t,e,n)};e.prototype.endInteractionInternal=function(t,e,i){this.setHint(Tr.INTERACTING,-1);this.resolveConstraints(t,e,i)};e.prototype.getConstrainedCenter=function(t,e){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)};e.prototype.getConstrainedZoom=function(t,e){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))};e.prototype.getConstrainedResolution=function(t,e){var i=e||0;var n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,n)};return e}(ie);function wo(t,e){setTimeout((function(){t(e)}),0)}function Po(t){if(t.extent!==undefined){var e=t.smoothExtentConstraint!==undefined?t.smoothExtentConstraint:true;return Sr(t.extent,t.constrainOnlyCenter,e)}var i=en(t.projection,"EPSG:3857");if(t.multiWorld!==true&&i.isGlobal()){var n=i.getExtent().slice();n[0]=-Infinity;n[2]=Infinity;return Sr(n,false,false)}return Ir}function bo(t){var e;var i;var n;var r=28;var o=2;var a=t.minZoom!==undefined?t.minZoom:So;var s=t.maxZoom!==undefined?t.maxZoom:r;var u=t.zoomFactor!==undefined?t.zoomFactor:o;var l=t.multiWorld!==undefined?t.multiWorld:false;var h=t.smoothResolutionConstraint!==undefined?t.smoothResolutionConstraint:true;var f=t.showFullExtent!==undefined?t.showFullExtent:false;var c=en(t.projection,"EPSG:3857");var p=c.getExtent();var d=t.constrainOnlyCenter;var v=t.extent;if(!l&&!v&&c.isGlobal()){d=false;v=p}if(t.resolutions!==undefined){var _=t.resolutions;i=_[a];n=_[s]!==undefined?_[s]:_[_.length-1];if(t.constrainResolution){e=br(_,h,!d&&v,f)}else{e=Ar(i,n,h,!d&&v,f)}}else{var g=!p?360*_i[vi.DEGREES]/c.getMetersPerUnit():Math.max(ft(p),st(p));var y=g/Cr/Math.pow(o,So);var m=y/Math.pow(o,r-So);i=t.maxResolution;if(i!==undefined){a=0}else{i=y/Math.pow(u,a)}n=t.minResolution;if(n===undefined){if(t.maxZoom!==undefined){if(t.maxResolution!==undefined){n=i/Math.pow(u,s)}else{n=y/Math.pow(u,s)}}else{n=m}}s=a+Math.floor(Math.log(i/n)/Math.log(u));n=i/Math.pow(u,s-a);if(t.constrainResolution){e=Lr(u,i,n,h,!d&&v,f)}else{e=Ar(i,n,h,!d&&v,f)}}return{constraint:e,maxResolution:i,minResolution:n,minZoom:a,zoomFactor:u}}function Lo(t){var e=t.enableRotation!==undefined?t.enableRotation:true;if(e){var i=t.constrainRotation;if(i===undefined||i===true){return Nr()}else if(i===false){return Dr}else if(typeof i==="number"){return Fr(i)}else{return Dr}}else{return Mr}}function Ao(t){if(t.sourceCenter&&t.targetCenter){if(!Xi(t.sourceCenter,t.targetCenter)){return false}}if(t.sourceResolution!==t.targetResolution){return false}if(t.sourceRotation!==t.targetRotation){return false}return true}function Mo(t){return t[0]>0&&t[1]>0}function Do(t,e,i){if(i===undefined){i=[0,0]}i[0]=t[0]*e+.5|0;i[1]=t[1]*e+.5|0;return i}function Fo(t,e){if(Array.isArray(t)){return t}else{if(e===undefined){e=[t,t]}else{e[0]=t;e[1]=t}return e}}var No=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ko=function(t){No(e,t);function e(e){var i=t.call(this)||this;var n=Go(e);i.boundHandleBrowserEvent_=i.handleBrowserEvent.bind(i);i.maxTilesLoading_=e.maxTilesLoading!==undefined?e.maxTilesLoading:16;i.pixelRatio_=e.pixelRatio!==undefined?e.pixelRatio:Ee;i.animationDelay_=function(){this.animationDelayKey_=undefined;this.renderFrame_(Date.now())}.bind(i);i.coordinateToPixelTransform_=R();i.pixelToCoordinateTransform_=R();i.frameIndex_=0;i.frameState_=null;i.previousExtent_=null;i.viewPropertyListenerKey_=null;i.viewChangeListenerKey_=null;i.layerGroupPropertyListenerKeys_=null;i.viewport_=document.createElement("div");i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":"");i.viewport_.style.position="relative";i.viewport_.style.overflow="hidden";i.viewport_.style.width="100%";i.viewport_.style.height="100%";i.overlayContainer_=document.createElement("div");i.overlayContainer_.style.position="absolute";i.overlayContainer_.style.zIndex="0";i.overlayContainer_.style.width="100%";i.overlayContainer_.style.height="100%";i.overlayContainer_.style.pointerEvents="none";i.overlayContainer_.className="ol-overlaycontainer";i.viewport_.appendChild(i.overlayContainer_);i.overlayContainerStopEvent_=document.createElement("div");i.overlayContainerStopEvent_.style.position="absolute";i.overlayContainerStopEvent_.style.zIndex="0";i.overlayContainerStopEvent_.style.width="100%";i.overlayContainerStopEvent_.style.height="100%";i.overlayContainerStopEvent_.style.pointerEvents="none";i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";i.viewport_.appendChild(i.overlayContainerStopEvent_);i.mapBrowserEventHandler_=null;i.moveTolerance_=e.moveTolerance;i.keyboardEventTarget_=n.keyboardEventTarget;i.keyHandlerKeys_=null;i.controls=n.controls||new ir;i.interactions=n.interactions||new ir;i.overlays_=n.overlays;i.overlayIdIndex_={};i.renderer_=null;i.postRenderFunctions_=[];i.tileQueue_=new xr(i.getTilePriority.bind(i),i.handleTileChange_.bind(i));i.addEventListener(re(vr.LAYERGROUP),i.handleLayerGroupChanged_);i.addEventListener(re(vr.VIEW),i.handleViewChanged_);i.addEventListener(re(vr.SIZE),i.handleSizeChanged_);i.addEventListener(re(vr.TARGET),i.handleTargetChanged_);i.setProperties(n.values);i.controls.forEach(function(t){t.setMap(this)}.bind(i));i.controls.addEventListener(Qn.ADD,function(t){t.element.setMap(this)}.bind(i));i.controls.addEventListener(Qn.REMOVE,function(t){t.element.setMap(null)}.bind(i));i.interactions.forEach(function(t){t.setMap(this)}.bind(i));i.interactions.addEventListener(Qn.ADD,function(t){t.element.setMap(this)}.bind(i));i.interactions.addEventListener(Qn.REMOVE,function(t){t.element.setMap(null)}.bind(i));i.overlays_.forEach(i.addOverlayInternal_.bind(i));i.overlays_.addEventListener(Qn.ADD,function(t){this.addOverlayInternal_(t.element)}.bind(i));i.overlays_.addEventListener(Qn.REMOVE,function(t){var e=t.element;var i=e.getId();if(i!==undefined){delete this.overlayIdIndex_[i.toString()]}t.element.setMap(null)}.bind(i));return i}e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")};e.prototype.addControl=function(t){this.getControls().push(t)};e.prototype.addInteraction=function(t){this.getInteractions().push(t)};e.prototype.addLayer=function(t){var e=this.getLayerGroup().getLayers();e.push(t)};e.prototype.addOverlay=function(t){this.getOverlays().push(t)};e.prototype.addOverlayInternal_=function(t){var e=t.getId();if(e!==undefined){this.overlayIdIndex_[e.toString()]=t}t.setMap(this)};e.prototype.disposeInternal=function(){this.setTarget(null);t.prototype.disposeInternal.call(this)};e.prototype.forEachFeatureAtPixel=function(t,e,i){if(!this.frameState_){return}var n=this.getCoordinateFromPixelInternal(t);i=i!==undefined?i:{};var r=i.hitTolerance!==undefined?i.hitTolerance*this.frameState_.pixelRatio:0;var o=i.layerFilter!==undefined?i.layerFilter:f;var a=i.checkWrapped!==false;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,a,e,null,o,null)};e.prototype.getFeaturesAtPixel=function(t,e){var i=[];this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e);return i};e.prototype.forEachLayerAtPixel=function(t,e,i){if(!this.frameState_){return}var n=i||{};var r=n.hitTolerance!==undefined?n.hitTolerance*this.frameState_.pixelRatio:0;var o=n.layerFilter||f;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,o)};e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_){return false}var i=this.getCoordinateFromPixelInternal(t);e=e!==undefined?e:{};var n=e.layerFilter!==undefined?e.layerFilter:f;var r=e.hitTolerance!==undefined?e.hitTolerance*this.frameState_.pixelRatio:0;var o=e.checkWrapped!==false;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,o,n,null)};e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))};e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))};e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect();var i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]};e.prototype.getTarget=function(){return this.get(vr.TARGET)};e.prototype.getTargetElement=function(){var t=this.getTarget();if(t!==undefined){return typeof t==="string"?document.getElementById(t):t}else{return null}};e.prototype.getCoordinateFromPixel=function(t){return hn(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())};e.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;if(!e){return null}else{return S(e.pixelToCoordinateTransform,t.slice())}};e.prototype.getControls=function(){return this.controls};e.prototype.getOverlays=function(){return this.overlays_};e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return e!==undefined?e:null};e.prototype.getInteractions=function(){return this.interactions};e.prototype.getLayerGroup=function(){return this.get(vr.LAYERGROUP)};e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t};e.prototype.getLoading=function(){var t=this.getLayerGroup().getLayerStatesArray();for(var e=0,i=t.length;e<i;++e){var n=t[e].layer;var r=n.getSource();if(r&&r.loading){return true}}return false};e.prototype.getPixelFromCoordinate=function(t){var e=fn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)};e.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;if(!e){return null}else{return S(e.coordinateToPixelTransform,t.slice(0,2))}};e.prototype.getRenderer=function(){return this.renderer_};e.prototype.getSize=function(){return this.get(vr.SIZE)};e.prototype.getView=function(){return this.get(vr.VIEW)};e.prototype.getViewport=function(){return this.viewport_};e.prototype.getOverlayContainer=function(){return this.overlayContainer_};e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_};e.prototype.getTilePriority=function(t,e,i,n){return Er(this.frameState_,t,e,i,n)};e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type;var n=new lr(i,this,t);this.handleMapBrowserEvent(n)};e.prototype.handleMapBrowserEvent=function(t){if(!this.frameState_){return}var e=t.originalEvent;var i=e.type;if(i===fr.POINTERDOWN||i===Bt.WHEEL||i===Bt.KEYDOWN){var n=this.viewport_.getRootNode?this.viewport_.getRootNode():document;var r=n===document?e.target:n.elementFromPoint(e.clientX,e.clientY);if(this.overlayContainerStopEvent_.contains(r)||!(n===document?document.documentElement:n).contains(r)){return}}t.frameState=this.frameState_;var o=this.getInteractions().getArray();if(this.dispatchEvent(t)!==false){for(var a=o.length-1;a>=0;a--){var s=o[a];if(!s.getActive()){continue}var u=s.handleEvent(t);if(!u){break}}}};e.prototype.handlePostRender=function(){var t=this.frameState_;var e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_;var n=i;if(t){var r=t.viewHints;if(r[Tr.ANIMATING]||r[Tr.INTERACTING]){var o=!Re&&Date.now()-t.time>8;i=o?0:8;n=o?0:2}}if(e.getTilesLoading()<i){e.reprioritize();e.loadMoreTiles(i,n)}}if(t&&this.hasListener(ue.RENDERCOMPLETE)&&!t.animate&&!this.tileQueue_.getTilesLoading()&&!this.getLoading()){this.renderer_.dispatchRenderEvent(ue.RENDERCOMPLETE,t)}var a=this.postRenderFunctions_;for(var s=0,u=a.length;s<u;++s){a[s](this,t)}a.length=0};e.prototype.handleSizeChanged_=function(){if(this.getView()&&!this.getView().getAnimating()){this.getView().resolveConstraints(0)}this.render()};e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()){t=this.getTargetElement()}if(this.mapBrowserEventHandler_){for(var e=0,i=this.keyHandlerKeys_.length;e<i;++e){qt(this.keyHandlerKeys_[e])}this.keyHandlerKeys_=null;this.viewport_.removeEventListener(Bt.CONTEXTMENU,this.boundHandleBrowserEvent_);this.viewport_.removeEventListener(Bt.WHEEL,this.boundHandleBrowserEvent_);if(this.handleResize_!==undefined){removeEventListener(Bt.RESIZE,this.handleResize_,false);this.handleResize_=undefined}this.mapBrowserEventHandler_.dispose();this.mapBrowserEventHandler_=null;Ie(this.viewport_)}if(!t){if(this.renderer_){clearTimeout(this.postRenderTimeoutHandle_);this.postRenderFunctions_.length=0;this.renderer_.dispose();this.renderer_=null}if(this.animationDelayKey_){cancelAnimationFrame(this.animationDelayKey_);this.animationDelayKey_=undefined}}else{t.appendChild(this.viewport_);if(!this.renderer_){this.renderer_=this.createRenderer()}this.mapBrowserEventHandler_=new pr(this,this.moveTolerance_);for(var n in hr){this.mapBrowserEventHandler_.addEventListener(hr[n],this.handleMapBrowserEvent.bind(this))}this.viewport_.addEventListener(Bt.CONTEXTMENU,this.boundHandleBrowserEvent_,false);this.viewport_.addEventListener(Bt.WHEEL,this.boundHandleBrowserEvent_,Oe?{passive:false}:false);var r=!this.keyboardEventTarget_?t:this.keyboardEventTarget_;this.keyHandlerKeys_=[Vt(r,Bt.KEYDOWN,this.handleBrowserEvent,this),Vt(r,Bt.KEYPRESS,this.handleBrowserEvent,this)];if(!this.handleResize_){this.handleResize_=this.updateSize.bind(this);window.addEventListener(Bt.RESIZE,this.handleResize_,false)}}this.updateSize()};e.prototype.handleTileChange_=function(){this.render()};e.prototype.handleViewPropertyChanged_=function(){this.render()};e.prototype.handleViewChanged_=function(){if(this.viewPropertyListenerKey_){qt(this.viewPropertyListenerKey_);this.viewPropertyListenerKey_=null}if(this.viewChangeListenerKey_){qt(this.viewChangeListenerKey_);this.viewChangeListenerKey_=null}var t=this.getView();if(t){this.updateViewportSize_();this.viewPropertyListenerKey_=Vt(t,Yt.PROPERTYCHANGE,this.handleViewPropertyChanged_,this);this.viewChangeListenerKey_=Vt(t,Bt.CHANGE,this.handleViewPropertyChanged_,this);t.resolveConstraints(0)}this.render()};e.prototype.handleLayerGroupChanged_=function(){if(this.layerGroupPropertyListenerKeys_){this.layerGroupPropertyListenerKeys_.forEach(qt);this.layerGroupPropertyListenerKeys_=null}var t=this.getLayerGroup();if(t){this.layerGroupPropertyListenerKeys_=[Vt(t,Yt.PROPERTYCHANGE,this.render,this),Vt(t,Bt.CHANGE,this.render,this)]}this.render()};e.prototype.isRendered=function(){return!!this.frameState_};e.prototype.renderSync=function(){if(this.animationDelayKey_){cancelAnimationFrame(this.animationDelayKey_)}this.animationDelay_()};e.prototype.redrawText=function(){var t=this.getLayerGroup().getLayerStatesArray();for(var e=0,i=t.length;e<i;++e){var n=t[e].layer;if(n.hasRenderer()){n.getRenderer().handleFontsChanged()}}};e.prototype.render=function(){if(this.renderer_&&this.animationDelayKey_===undefined){this.animationDelayKey_=requestAnimationFrame(this.animationDelay_)}};e.prototype.removeControl=function(t){return this.getControls().remove(t)};e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)};e.prototype.removeLayer=function(t){var e=this.getLayerGroup().getLayers();return e.remove(t)};e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)};e.prototype.renderFrame_=function(t){var e=this.getSize();var i=this.getView();var n=this.frameState_;var r=null;if(e!==undefined&&Mo(e)&&i&&i.isDef()){var o=i.getHints(this.frameState_?this.frameState_.viewHints:undefined);var a=i.getState();r={animate:false,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:n?n.declutterItems:[],extent:at(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{}}}this.frameState_=r;this.renderer_.renderFrame(r);if(r){if(r.animate){this.render()}Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions);if(n){var s=!this.previousExtent_||!pt(this.previousExtent_)&&!V(r.extent,this.previousExtent_);if(s){this.dispatchEvent(new sr(dr.MOVESTART,this,n));this.previousExtent_=K(this.previousExtent_)}}var u=this.previousExtent_&&!r.viewHints[Tr.ANIMATING]&&!r.viewHints[Tr.INTERACTING]&&!V(r.extent,this.previousExtent_);if(u){this.dispatchEvent(new sr(dr.MOVEEND,this,r));N(r.extent,this.previousExtent_)}}this.dispatchEvent(new sr(dr.POSTRENDER,this,r));this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)};e.prototype.setLayerGroup=function(t){this.set(vr.LAYERGROUP,t)};e.prototype.setSize=function(t){this.set(vr.SIZE,t)};e.prototype.setTarget=function(t){this.set(vr.TARGET,t)};e.prototype.setView=function(t){this.set(vr.VIEW,t)};e.prototype.updateSize=function(){var t=this.getTargetElement();if(!t){this.setSize(undefined)}else{var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e["borderLeftWidth"])-parseFloat(e["paddingLeft"])-parseFloat(e["paddingRight"])-parseFloat(e["borderRightWidth"]),t.offsetHeight-parseFloat(e["borderTopWidth"])-parseFloat(e["paddingTop"])-parseFloat(e["paddingBottom"])-parseFloat(e["borderBottomWidth"])])}this.updateViewportSize_()};e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var e=undefined;var i=getComputedStyle(this.viewport_);if(i.width&&i.height){e=[parseInt(i.width,10),parseInt(i.height,10)]}t.setViewportSize(e)}};return e}(ie);function Go(t){var e=null;if(t.keyboardEventTarget!==undefined){e=typeof t.keyboardEventTarget==="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget}var i={};var n=t.layers&&typeof t.layers.getLayers==="function"?t.layers:new or({layers:t.layers});i[vr.LAYERGROUP]=n;i[vr.TARGET]=t.target;i[vr.VIEW]=t.view!==undefined?t.view:new Io;var r;if(t.controls!==undefined){if(Array.isArray(t.controls)){r=new ir(t.controls.slice())}else{E(typeof t.controls.getArray==="function",47);r=t.controls}}var o;if(t.interactions!==undefined){if(Array.isArray(t.interactions)){o=new ir(t.interactions.slice())}else{E(typeof t.interactions.getArray==="function",48);o=t.interactions}}var a;if(t.overlays!==undefined){if(Array.isArray(t.overlays)){a=new ir(t.overlays.slice())}else{E(typeof t.overlays.getArray==="function",49);a=t.overlays}}else{a=new ir}return{controls:r,interactions:o,keyboardEventTarget:e,overlays:a,values:i}}var jo=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Yo=function(t){jo(e,t);function e(e){var i=t.call(this)||this;var n=e.element;if(n&&!e.target&&!n.style.pointerEvents){n.style.pointerEvents="auto"}i.element=n?n:null;i.target_=null;i.map_=null;i.listenerKeys=[];if(e.render){i.render=e.render}if(e.target){i.setTarget(e.target)}return i}e.prototype.disposeInternal=function(){Ie(this.element);t.prototype.disposeInternal.call(this)};e.prototype.getMap=function(){return this.map_};e.prototype.setMap=function(t){if(this.map_){Ie(this.element)}for(var e=0,i=this.listenerKeys.length;e<i;++e){qt(this.listenerKeys[e])}this.listenerKeys.length=0;this.map_=t;if(this.map_){var n=this.target_?this.target_:t.getOverlayContainerStopEvent();n.appendChild(this.element);if(this.render!==p){this.listenerKeys.push(Vt(t,dr.POSTRENDER,this.render,this))}t.render()}};e.prototype.render=function(t){};e.prototype.setTarget=function(t){this.target_=typeof t==="string"?document.getElementById(t):t};return e}(ie);var zo=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Xo=function(t){zo(e,t);function e(e){var i=this;var n=e?e:{};i=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;i.ulElement_=document.createElement("ul");i.collapsed_=n.collapsed!==undefined?n.collapsed:true;i.overrideCollapsible_=n.collapsible!==undefined;i.collapsible_=n.collapsible!==undefined?n.collapsible:true;if(!i.collapsible_){i.collapsed_=false}var r=n.className!==undefined?n.className:"ol-attribution";var o=n.tipLabel!==undefined?n.tipLabel:"Attributions";var a=n.collapseLabel!==undefined?n.collapseLabel:"»";if(typeof a==="string"){i.collapseLabel_=document.createElement("span");i.collapseLabel_.textContent=a}else{i.collapseLabel_=a}var s=n.label!==undefined?n.label:"i";if(typeof s==="string"){i.label_=document.createElement("span");i.label_.textContent=s}else{i.label_=s}var u=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_;var l=document.createElement("button");l.setAttribute("type","button");l.title=o;l.appendChild(u);l.addEventListener(Bt.CLICK,i.handleClick_.bind(i),false);var h=r+" "+Le+" "+Ae+(i.collapsed_&&i.collapsible_?" "+Me:"")+(i.collapsible_?"":" ol-uncollapsible");var f=i.element;f.className=h;f.appendChild(i.ulElement_);f.appendChild(l);i.renderedAttributions_=[];i.renderedVisible_=true;return i}e.prototype.collectSourceAttributions_=function(t){var e={};var i=[];var n=t.layerStatesArray;for(var r=0,o=n.length;r<o;++r){var a=n[r];if(!ce(a,t.viewState)){continue}var s=a.layer.getSource();if(!s){continue}var u=s.getAttributions();if(!u){continue}var l=u(t);if(!l){continue}if(!this.overrideCollapsible_&&s.getAttributionsCollapsible()===false){this.setCollapsible(false)}if(Array.isArray(l)){for(var h=0,f=l.length;h<f;++h){if(!(l[h]in e)){i.push(l[h]);e[l[h]]=true}}}else{if(!(l in e)){i.push(l);e[l]=true}}}return i};e.prototype.updateElement_=function(t){if(!t){if(this.renderedVisible_){this.element.style.display="none";this.renderedVisible_=false}return}var e=this.collectSourceAttributions_(t);var i=e.length>0;if(this.renderedVisible_!=i){this.element.style.display=i?"":"none";this.renderedVisible_=i}if(l(e,this.renderedAttributions_)){return}we(this.ulElement_);for(var n=0,r=e.length;n<r;++n){var o=document.createElement("li");o.innerHTML=e[n];this.ulElement_.appendChild(o)}this.renderedAttributions_=e};e.prototype.handleClick_=function(t){t.preventDefault();this.handleToggle_()};e.prototype.handleToggle_=function(){this.element.classList.toggle(Me);if(this.collapsed_){Se(this.collapseLabel_,this.label_)}else{Se(this.label_,this.collapseLabel_)}this.collapsed_=!this.collapsed_};e.prototype.getCollapsible=function(){return this.collapsible_};e.prototype.setCollapsible=function(t){if(this.collapsible_===t){return}this.collapsible_=t;this.element.classList.toggle("ol-uncollapsible");if(!t&&this.collapsed_){this.handleToggle_()}};e.prototype.setCollapsed=function(t){if(!this.collapsible_||this.collapsed_===t){return}this.handleToggle_()};e.prototype.getCollapsed=function(){return this.collapsed_};e.prototype.render=function(t){this.updateElement_(t.frameState)};return e}(Yo);var Wo=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ko=function(t){Wo(e,t);function e(e){var i=this;var n=e?e:{};i=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;var r=n.className!==undefined?n.className:"ol-rotate";var o=n.label!==undefined?n.label:"⇧";i.label_=null;if(typeof o==="string"){i.label_=document.createElement("span");i.label_.className="ol-compass";i.label_.textContent=o}else{i.label_=o;i.label_.classList.add("ol-compass")}var a=n.tipLabel?n.tipLabel:"Reset rotation";var s=document.createElement("button");s.className=r+"-reset";s.setAttribute("type","button");s.title=a;s.appendChild(i.label_);s.addEventListener(Bt.CLICK,i.handleClick_.bind(i),false);var u=r+" "+Le+" "+Ae;var l=i.element;l.className=u;l.appendChild(s);i.callResetNorth_=n.resetNorth?n.resetNorth:undefined;i.duration_=n.duration!==undefined?n.duration:250;i.autoHide_=n.autoHide!==undefined?n.autoHide:true;i.rotation_=undefined;if(i.autoHide_){i.element.classList.add(be)}return i}e.prototype.handleClick_=function(t){t.preventDefault();if(this.callResetNorth_!==undefined){this.callResetNorth_()}else{this.resetNorth_()}};e.prototype.resetNorth_=function(){var t=this.getMap();var e=t.getView();if(!e){return}var i=e.getRotation();if(i!==undefined){if(this.duration_>0&&i%(2*Math.PI)!==0){e.animate({rotation:0,duration:this.duration_,easing:Gr})}else{e.setRotation(0)}}};e.prototype.render=function(t){var e=t.frameState;if(!e){return}var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var r=this.element.classList.contains(be);if(!r&&i===0){this.element.classList.add(be)}else if(r&&i!==0){this.element.classList.remove(be)}}this.label_.style.transform=n}this.rotation_=i};return e}(Yo);var Zo=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Uo=function(t){Zo(e,t);function e(e){var i=this;var n=e?e:{};i=t.call(this,{element:document.createElement("div"),target:n.target})||this;var r=n.className!==undefined?n.className:"ol-zoom";var o=n.delta!==undefined?n.delta:1;var a=n.zoomInLabel!==undefined?n.zoomInLabel:"+";var s=n.zoomOutLabel!==undefined?n.zoomOutLabel:"−";var u=n.zoomInTipLabel!==undefined?n.zoomInTipLabel:"Zoom in";var l=n.zoomOutTipLabel!==undefined?n.zoomOutTipLabel:"Zoom out";var h=document.createElement("button");h.className=r+"-in";h.setAttribute("type","button");h.title=u;h.appendChild(typeof a==="string"?document.createTextNode(a):a);h.addEventListener(Bt.CLICK,i.handleClick_.bind(i,o),false);var f=document.createElement("button");f.className=r+"-out";f.setAttribute("type","button");f.title=l;f.appendChild(typeof s==="string"?document.createTextNode(s):s);f.addEventListener(Bt.CLICK,i.handleClick_.bind(i,-o),false);var c=r+" "+Le+" "+Ae;var p=i.element;p.className=c;p.appendChild(h);p.appendChild(f);i.duration_=n.duration!==undefined?n.duration:250;return i}e.prototype.handleClick_=function(t,e){e.preventDefault();this.zoomByDelta_(t)};e.prototype.zoomByDelta_=function(t){var e=this.getMap();var i=e.getView();if(!i){return}var n=i.getZoom();if(n!==undefined){var r=i.getConstrainedZoom(n+t);if(this.duration_>0){if(i.getAnimating()){i.cancelAnimations()}i.animate({zoom:r,duration:this.duration_,easing:Gr})}else{i.setZoom(r)}}};return e}(Yo);function Bo(t){var e=t?t:{};var i=new ir;var n=e.zoom!==undefined?e.zoom:true;if(n){i.push(new Uo(e.zoomOptions))}var r=e.rotate!==undefined?e.rotate:true;if(r){i.push(new Ko(e.rotateOptions))}var o=e.attribution!==undefined?e.attribution:true;if(o){i.push(new Xo(e.attributionOptions))}return i}var Vo={ACTIVE:"active"};var Ho=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var qo=function(t){Ho(e,t);function e(e){var i=t.call(this)||this;if(e&&e.handleEvent){i.handleEvent=e.handleEvent}i.map_=null;i.setActive(true);return i}e.prototype.getActive=function(){return this.get(Vo.ACTIVE)};e.prototype.getMap=function(){return this.map_};e.prototype.handleEvent=function(t){return true};e.prototype.setActive=function(t){this.set(Vo.ACTIVE,t)};e.prototype.setMap=function(t){this.map_=t};return e}(ie);function Jo(t,e,i){var n=t.getCenterInternal();if(n){var r=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:i!==undefined?i:250,easing:Yr,center:t.getConstrainedCenter(r)})}}function Qo(t,e,i,n){var r=t.getZoom();if(r===undefined){return}var o=t.getConstrainedZoom(r+e);var a=t.getResolutionForZoom(o);if(t.getAnimating()){t.cancelAnimations()}t.animate({resolution:a,anchor:i,duration:n!==undefined?n:250,easing:Gr})}var $o=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ta=function(t){$o(e,t);function e(e){var i=t.call(this)||this;var n=e?e:{};i.delta_=n.delta?n.delta:1;i.duration_=n.duration!==undefined?n.duration:250;return i}e.prototype.handleEvent=function(t){var e=false;if(t.type==hr.DBLCLICK){var i=t.originalEvent;var n=t.map;var r=t.coordinate;var o=i.shiftKey?-this.delta_:this.delta_;var a=n.getView();Qo(a,o,r,this.duration_);t.preventDefault();e=true}return!e};return e}(qo);var ea=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ia=function(t){ea(e,t);function e(e){var i=this;var n=e?e:{};i=t.call(this,n)||this;if(n.handleDownEvent){i.handleDownEvent=n.handleDownEvent}if(n.handleDragEvent){i.handleDragEvent=n.handleDragEvent}if(n.handleMoveEvent){i.handleMoveEvent=n.handleMoveEvent}if(n.handleUpEvent){i.handleUpEvent=n.handleUpEvent}if(n.stopDown){i.stopDown=n.stopDown}i.handlingDownUpSequence=false;i.trackedPointers_={};i.targetPointers=[];return i}e.prototype.getPointerCount=function(){return this.targetPointers.length};e.prototype.handleDownEvent=function(t){return false};e.prototype.handleDragEvent=function(t){};e.prototype.handleEvent=function(t){if(!t.originalEvent){return true}var e=false;this.updateTrackedPointers_(t);if(this.handlingDownUpSequence){if(t.type==hr.POINTERDRAG){this.handleDragEvent(t);t.preventDefault()}else if(t.type==hr.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else{if(t.type==hr.POINTERDOWN){var n=this.handleDownEvent(t);this.handlingDownUpSequence=n;e=this.stopDown(n)}else if(t.type==hr.POINTERMOVE){this.handleMoveEvent(t)}}return!e};e.prototype.handleMoveEvent=function(t){};e.prototype.handleUpEvent=function(t){return false};e.prototype.stopDown=function(t){return t};e.prototype.updateTrackedPointers_=function(t){if(ra(t)){var e=t.originalEvent;var i=e.pointerId.toString();if(t.type==hr.POINTERUP){delete this.trackedPointers_[i]}else if(t.type==hr.POINTERDOWN){this.trackedPointers_[i]=e}else if(i in this.trackedPointers_){this.trackedPointers_[i]=e}this.targetPointers=Wt(this.trackedPointers_)}};return e}(qo);function na(t){var e=t.length;var i=0;var n=0;for(var r=0;r<e;r++){i+=t[r].clientX;n+=t[r].clientY}return[i/e,n/e]}function ra(t){var e=t.type;return e===hr.POINTERDOWN||e===hr.POINTERDRAG||e===hr.POINTERUP}function oa(t){var e=arguments;return function(t){var i=true;for(var n=0,r=e.length;n<r;++n){i=i&&e[n](t);if(!i){break}}return i}}var aa=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey};var sa=function(t){return t.target.getTargetElement().contains(document.activeElement)};var ua=function(t){return t.map.getTargetElement().hasAttribute("tabindex")?sa(t):true};var la=f;var ha=function(t){var e=t.originalEvent;return e.button==0&&!(me&&xe&&e.ctrlKey)};var fa=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey};var ca=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey};var pa=function(t){var e=t.originalEvent;var i=e.target.tagName;return i!=="INPUT"&&i!=="SELECT"&&i!=="TEXTAREA"};var da=function(t){var e=t.originalEvent;E(e!==undefined,56);return e.pointerType=="mouse"};var va=function(t){var e=t.originalEvent;E(e!==undefined,56);return e.isPrimary&&e.button===0};var _a=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ga=function(t){_a(e,t);function e(e){var i=t.call(this,{stopDown:c})||this;var n=e?e:{};i.kinetic_=n.kinetic;i.lastCentroid=null;i.panning_=false;var r=n.condition?n.condition:oa(fa,va);i.condition_=n.onFocusOnly?oa(ua,r):r;i.noKinetic_=false;return i}e.prototype.handleDragEvent=function(t){if(!this.panning_){this.panning_=true;this.getMap().getView().beginInteraction()}var e=this.targetPointers;var i=na(e);if(e.length==this.lastPointersCount_){if(this.kinetic_){this.kinetic_.update(i[0],i[1])}if(this.lastCentroid){var n=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]];var r=t.map;var o=r.getView();Ki(n,o.getResolution());Wi(n,o.getRotation());o.adjustCenterInternal(n)}}else if(this.kinetic_){this.kinetic_.begin()}this.lastCentroid=i;this.lastPointersCount_=e.length;t.originalEvent.preventDefault()};e.prototype.handleUpEvent=function(t){var e=t.map;var i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance();var r=this.kinetic_.getAngle();var o=i.getCenterInternal();var a=e.getPixelFromCoordinateInternal(o);var s=e.getCoordinateFromPixelInternal([a[0]-n*Math.cos(r),a[1]-n*Math.sin(r)]);i.animateInternal({center:i.getConstrainedCenter(s),duration:500,easing:Gr})}if(this.panning_){this.panning_=false;i.endInteraction()}return false}else{if(this.kinetic_){this.kinetic_.begin()}this.lastCentroid=null;return true}};e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map;var i=e.getView();this.lastCentroid=null;if(i.getAnimating()){i.cancelAnimations()}if(this.kinetic_){this.kinetic_.begin()}this.noKinetic_=this.targetPointers.length>1;return true}else{return false}};return e}(ia);var ya=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ma=function(t){ya(e,t);function e(e){var i=this;var n=e?e:{};i=t.call(this,{stopDown:c})||this;i.condition_=n.condition?n.condition:aa;i.lastAngle_=undefined;i.duration_=n.duration!==undefined?n.duration:250;return i}e.prototype.handleDragEvent=function(t){if(!da(t)){return}var e=t.map;var i=e.getView();if(i.getConstraints().rotation===Mr){return}var n=e.getSize();var r=t.pixel;var o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(this.lastAngle_!==undefined){var a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o};e.prototype.handleUpEvent=function(t){if(!da(t)){return true}var e=t.map;var i=e.getView();i.endInteraction(this.duration_);return false};e.prototype.handleDownEvent=function(t){if(!da(t)){return false}if(ha(t)&&this.condition_(t)){var e=t.map;e.getView().beginInteraction();this.lastAngle_=undefined;return true}else{return false}};return e}(ia);var xa=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ea=function(t){xa(e,t);function e(e){var i=t.call(this)||this;i.geometry_=null;i.element_=document.createElement("div");i.element_.style.position="absolute";i.element_.style.pointerEvents="auto";i.element_.className="ol-box "+e;i.map_=null;i.startPixel_=null;i.endPixel_=null;return i}e.prototype.disposeInternal=function(){this.setMap(null)};e.prototype.render_=function(){var t=this.startPixel_;var e=this.endPixel_;var i="px";var n=this.element_.style;n.left=Math.min(t[0],e[0])+i;n.top=Math.min(t[1],e[1])+i;n.width=Math.abs(e[0]-t[0])+i;n.height=Math.abs(e[1]-t[1])+i};e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit";e.top="inherit";e.width="inherit";e.height="inherit"}this.map_=t;if(this.map_){this.map_.getOverlayContainer().appendChild(this.element_)}};e.prototype.setPixels=function(t,e){this.startPixel_=t;this.endPixel_=e;this.createOrUpdateGeometry();this.render_()};e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_;var e=this.endPixel_;var i=[t,[t[0],e[1]],e,[e[0],t[1]]];var n=i.map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice();if(!this.geometry_){this.geometry_=new Ro([n])}else{this.geometry_.setCoordinates([n])}};e.prototype.getGeometry=function(){return this.geometry_};return e}(r);var Ta=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ra={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"};var Oa=function(t){Ta(e,t);function e(e,i,n){var r=t.call(this,e)||this;r.coordinate=i;r.mapBrowserEvent=n;return r}return e}(jt);var Ca=function(t){Ta(e,t);function e(e){var i=t.call(this)||this;var n=e?e:{};i.box_=new Ea(n.className||"ol-dragbox");i.minArea_=n.minArea!==undefined?n.minArea:64;if(n.onBoxEnd){i.onBoxEnd=n.onBoxEnd}i.startPixel_=null;i.condition_=n.condition?n.condition:ha;i.boxEndCondition_=n.boxEndCondition?n.boxEndCondition:i.defaultBoxEndCondition;return i}e.prototype.defaultBoxEndCondition=function(t,e,i){var n=i[0]-e[0];var r=i[1]-e[1];return n*n+r*r>=this.minArea_};e.prototype.getGeometry=function(){return this.box_.getGeometry()};e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel);this.dispatchEvent(new Oa(Ra.BOXDRAG,t.coordinate,t))};e.prototype.handleUpEvent=function(t){this.box_.setMap(null);if(this.boxEndCondition_(t,this.startPixel_,t.pixel)){this.onBoxEnd(t);this.dispatchEvent(new Oa(Ra.BOXEND,t.coordinate,t))}return false};e.prototype.handleDownEvent=function(t){if(this.condition_(t)){this.startPixel_=t.pixel;this.box_.setMap(t.map);this.box_.setPixels(this.startPixel_,this.startPixel_);this.dispatchEvent(new Oa(Ra.BOXSTART,t.coordinate,t));return true}else{return false}};e.prototype.onBoxEnd=function(t){};return e}(ia);var Sa=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ia=function(t){Sa(e,t);function e(e){var i=this;var n=e?e:{};var r=n.condition?n.condition:ca;i=t.call(this,{condition:r,className:n.className||"ol-dragzoom",minArea:n.minArea})||this;i.duration_=n.duration!==undefined?n.duration:200;i.out_=n.out!==undefined?n.out:false;return i}e.prototype.onBoxEnd=function(t){var e=this.getMap();var i=e.getView();var n=e.getSize();var r=this.getGeometry().getExtent();if(this.out_){var o=i.calculateExtentInternal(n);var a=U([e.getPixelFromCoordinateInternal(it(r)),e.getPixelFromCoordinateInternal(ht(r))]);var s=i.getResolutionForExtentInternal(a,n);vt(o,1/s);r=o}var u=i.getConstrainedResolution(i.getResolutionForExtentInternal(r,n));var l=i.getConstrainedCenter(rt(r),u);i.animateInternal({resolution:u,center:l,duration:this.duration_,easing:Gr})};return e}(Ca);var wa={LEFT:37,UP:38,RIGHT:39,DOWN:40};var Pa=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ba=function(t){Pa(e,t);function e(e){var i=t.call(this)||this;var n=e||{};i.defaultCondition_=function(t){return fa(t)&&pa(t)};i.condition_=n.condition!==undefined?n.condition:i.defaultCondition_;i.duration_=n.duration!==undefined?n.duration:100;i.pixelDelta_=n.pixelDelta!==undefined?n.pixelDelta:128;return i}e.prototype.handleEvent=function(t){var e=false;if(t.type==Bt.KEYDOWN){var i=t.originalEvent;var n=i.keyCode;if(this.condition_(t)&&(n==wa.DOWN||n==wa.LEFT||n==wa.RIGHT||n==wa.UP)){var r=t.map;var o=r.getView();var a=o.getResolution()*this.pixelDelta_;var s=0,u=0;if(n==wa.DOWN){u=-a}else if(n==wa.LEFT){s=-a}else if(n==wa.RIGHT){s=a}else{u=a}var l=[s,u];Wi(l,o.getRotation());Jo(o,l,this.duration_);t.preventDefault();e=true}}return!e};return e}(qo);var La=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Aa=function(t){La(e,t);function e(e){var i=t.call(this)||this;var n=e?e:{};i.condition_=n.condition?n.condition:pa;i.delta_=n.delta?n.delta:1;i.duration_=n.duration!==undefined?n.duration:100;return i}e.prototype.handleEvent=function(t){var e=false;if(t.type==Bt.KEYDOWN||t.type==Bt.KEYPRESS){var i=t.originalEvent;var n=i.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var r=t.map;var o=n=="+".charCodeAt(0)?this.delta_:-this.delta_;var a=r.getView();Qo(a,o,undefined,this.duration_);t.preventDefault();e=true}}return!e};return e}(qo);var Ma=function(){function t(t,e,i){this.decay_=t;this.minVelocity_=e;this.delay_=i;this.points_=[];this.angle_=0;this.initialVelocity_=0}t.prototype.begin=function(){this.points_.length=0;this.angle_=0;this.initialVelocity_=0};t.prototype.update=function(t,e){this.points_.push(t,e,Date.now())};t.prototype.end=function(){if(this.points_.length<6){return false}var t=Date.now()-this.delay_;var e=this.points_.length-3;if(this.points_[e+2]<t){return false}var i=e-3;while(i>0&&this.points_[i+2]>t){i-=3}var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60){return false}var r=this.points_[e]-this.points_[i];var o=this.points_[e+1]-this.points_[i+1];this.angle_=Math.atan2(o,r);this.initialVelocity_=Math.sqrt(r*r+o*o)/n;return this.initialVelocity_>this.minVelocity_};t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_};t.prototype.getAngle=function(){return this.angle_};return t}();var Da=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Fa={TRACKPAD:"trackpad",WHEEL:"wheel"};var Na=function(t){Da(e,t);function e(e){var i=this;var n=e?e:{};i=t.call(this,n)||this;i.totalDelta_=0;i.lastDelta_=0;i.maxDelta_=n.maxDelta!==undefined?n.maxDelta:1;i.duration_=n.duration!==undefined?n.duration:250;i.timeout_=n.timeout!==undefined?n.timeout:80;i.useAnchor_=n.useAnchor!==undefined?n.useAnchor:true;i.constrainResolution_=n.constrainResolution!==undefined?n.constrainResolution:false;var r=n.condition?n.condition:la;i.condition_=n.onFocusOnly?oa(ua,r):r;i.lastAnchor_=null;i.startTime_=undefined;i.mode_=undefined;i.trackpadEventGap_=400;i.deltaPerZoom_=300;return i}e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=undefined;var t=this.getMap().getView();t.endInteraction(undefined,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)};e.prototype.handleEvent=function(t){if(!this.condition_(t)){return true}var e=t.type;if(e!==Bt.WHEEL){return true}t.preventDefault();var i=t.map;var n=t.originalEvent;if(this.useAnchor_){this.lastAnchor_=t.coordinate}var r;if(t.type==Bt.WHEEL){r=n.deltaY;if(ge&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL){r/=Ee}if(n.deltaMode===WheelEvent.DOM_DELTA_LINE){r*=40}}if(r===0){return false}else{this.lastDelta_=r}var o=Date.now();if(this.startTime_===undefined){this.startTime_=o}if(!this.mode_||o-this.startTime_>this.trackpadEventGap_){this.mode_=Math.abs(r)<4?Fa.TRACKPAD:Fa.WHEEL}var a=i.getView();if(this.mode_===Fa.TRACKPAD&&!(a.getConstrainResolution()||this.constrainResolution_)){if(this.trackpadTimeoutId_){clearTimeout(this.trackpadTimeoutId_)}else{if(a.getAnimating()){a.cancelAnimations()}a.beginInteraction()}this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_);a.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_);this.startTime_=o;return false}this.totalDelta_+=r;var s=Math.max(this.timeout_-(o-this.startTime_),0);clearTimeout(this.timeoutId_);this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),s);return false};e.prototype.handleWheelZoom_=function(t){var e=t.getView();if(e.getAnimating()){e.cancelAnimations()}var i=-yt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;if(e.getConstrainResolution()||this.constrainResolution_){i=i?i>0?1:-1:0}Qo(e,i,this.lastAnchor_,this.duration_);this.mode_=undefined;this.totalDelta_=0;this.lastAnchor_=null;this.startTime_=undefined;this.timeoutId_=undefined};e.prototype.setMouseAnchor=function(t){this.useAnchor_=t;if(!t){this.lastAnchor_=null}};return e}(qo);var ka=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ga=function(t){ka(e,t);function e(e){var i=this;var n=e?e:{};var r=n;if(!r.stopDown){r.stopDown=c}i=t.call(this,r)||this;i.anchor_=null;i.lastAngle_=undefined;i.rotating_=false;i.rotationDelta_=0;i.threshold_=n.threshold!==undefined?n.threshold:.3;i.duration_=n.duration!==undefined?n.duration:250;return i}e.prototype.handleDragEvent=function(t){var e=0;var i=this.targetPointers[0];var n=this.targetPointers[1];var r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(this.lastAngle_!==undefined){var o=r-this.lastAngle_;this.rotationDelta_+=o;if(!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_){this.rotating_=true}e=o}this.lastAngle_=r;var a=t.map;var s=a.getView();if(s.getConstraints().rotation===Mr){return}var u=a.getViewport().getBoundingClientRect();var l=na(this.targetPointers);l[0]-=u.left;l[1]-=u.top;this.anchor_=a.getCoordinateFromPixelInternal(l);if(this.rotating_){a.render();s.adjustRotationInternal(e,this.anchor_)}};e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map;var i=e.getView();i.endInteraction(this.duration_);return false}else{return true}};e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;this.anchor_=null;this.lastAngle_=undefined;this.rotating_=false;this.rotationDelta_=0;if(!this.handlingDownUpSequence){e.getView().beginInteraction()}return true}else{return false}};return e}(ia);var ja=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ya=function(t){ja(e,t);function e(e){var i=this;var n=e?e:{};var r=n;if(!r.stopDown){r.stopDown=c}i=t.call(this,r)||this;i.anchor_=null;i.duration_=n.duration!==undefined?n.duration:400;i.lastDistance_=undefined;i.lastScaleDelta_=1;return i}e.prototype.handleDragEvent=function(t){var e=1;var i=this.targetPointers[0];var n=this.targetPointers[1];var r=i.clientX-n.clientX;var o=i.clientY-n.clientY;var a=Math.sqrt(r*r+o*o);if(this.lastDistance_!==undefined){e=this.lastDistance_/a}this.lastDistance_=a;var s=t.map;var u=s.getView();if(e!=1){this.lastScaleDelta_=e}var l=s.getViewport().getBoundingClientRect();var h=na(this.targetPointers);h[0]-=l.left;h[1]-=l.top;this.anchor_=s.getCoordinateFromPixelInternal(h);s.render();u.adjustResolutionInternal(e,this.anchor_)};e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map;var i=e.getView();var n=this.lastScaleDelta_>1?1:-1;i.endInteraction(this.duration_,n);return false}else{return true}};e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;this.anchor_=null;this.lastDistance_=undefined;this.lastScaleDelta_=1;if(!this.handlingDownUpSequence){e.getView().beginInteraction()}return true}else{return false}};return e}(ia);var za=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Xa=function(t){za(e,t);function e(e){var i=t.call(this)||this;i.id_=undefined;i.geometryName_="geometry";i.style_=null;i.styleFunction_=undefined;i.geometryChangeKey_=null;i.addEventListener(re(i.geometryName_),i.handleGeometryChanged_);if(e){if(typeof e.getSimplifiedGeometry==="function"){var n=e;i.setGeometry(n)}else{var r=e;i.setProperties(r)}}return i}e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var i=this.getGeometry();if(i){t.setGeometry(i.clone())}var n=this.getStyle();if(n){t.setStyle(n)}return t};e.prototype.getGeometry=function(){return this.get(this.geometryName_)};e.prototype.getId=function(){return this.id_};e.prototype.getGeometryName=function(){return this.geometryName_};e.prototype.getStyle=function(){return this.style_};e.prototype.getStyleFunction=function(){return this.styleFunction_};e.prototype.handleGeometryChange_=function(){this.changed()};e.prototype.handleGeometryChanged_=function(){if(this.geometryChangeKey_){qt(this.geometryChangeKey_);this.geometryChangeKey_=null}var t=this.getGeometry();if(t){this.geometryChangeKey_=Vt(t,Bt.CHANGE,this.handleGeometryChange_,this)}this.changed()};e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)};e.prototype.setStyle=function(t){this.style_=t;this.styleFunction_=!t?undefined:Wa(t);this.changed()};e.prototype.setId=function(t){this.id_=t;this.changed()};e.prototype.setGeometryName=function(t){this.removeEventListener(re(this.geometryName_),this.handleGeometryChanged_);this.geometryName_=t;this.addEventListener(re(this.geometryName_),this.handleGeometryChanged_);this.handleGeometryChanged_()};return e}(ie);function Wa(t){if(typeof t==="function"){return t}else{var e;if(Array.isArray(t)){e=t}else{E(typeof t.getZIndex==="function",41);var i=t;e=[i]}return function(){return e}}}function Ka(t,e,i,n){var r=t[e];var o=t[e+1];var a=0;for(var s=e+n;s<i;s+=n){var u=t[s];var l=t[s+1];a+=Math.sqrt((u-r)*(u-r)+(l-o)*(l-o));r=u;o=l}return a}var Za=function(){function t(t){this.opacity_=t.opacity;this.rotateWithView_=t.rotateWithView;this.rotation_=t.rotation;this.scale_=t.scale;this.scaleArray_=Fo(t.scale);this.displacement_=t.displacement}t.prototype.clone=function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})};t.prototype.getOpacity=function(){return this.opacity_};t.prototype.getRotateWithView=function(){return this.rotateWithView_};t.prototype.getRotation=function(){return this.rotation_};t.prototype.getScale=function(){return this.scale_};t.prototype.getScaleArray=function(){return this.scaleArray_};t.prototype.getDisplacement=function(){return this.displacement_};t.prototype.getAnchor=function(){return v()};t.prototype.getImage=function(t){return v()};t.prototype.getHitDetectionImage=function(){return v()};t.prototype.getPixelRatio=function(t){return 1};t.prototype.getImageState=function(){return v()};t.prototype.getImageSize=function(){return v()};t.prototype.getHitDetectionImageSize=function(){return v()};t.prototype.getOrigin=function(){return v()};t.prototype.getSize=function(){return v()};t.prototype.setOpacity=function(t){this.opacity_=t};t.prototype.setRotateWithView=function(t){this.rotateWithView_=t};t.prototype.setRotation=function(t){this.rotation_=t};t.prototype.setScale=function(t){this.scale_=t;this.scaleArray_=Fo(t)};t.prototype.listenImageChange=function(t){v()};t.prototype.load=function(){v()};t.prototype.unlistenImageChange=function(t){v()};return t}();var Ua=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ba=function(t){Ua(e,t);function e(e){var i=this;var n=e.rotateWithView!==undefined?e.rotateWithView:false;i=t.call(this,{opacity:1,rotateWithView:n,rotation:e.rotation!==undefined?e.rotation:0,scale:1,displacement:e.displacement!==undefined?e.displacement:[0,0]})||this;i.canvas_={};i.hitDetectionCanvas_=null;i.fill_=e.fill!==undefined?e.fill:null;i.origin_=[0,0];i.points_=e.points;i.radius_=e.radius!==undefined?e.radius:e.radius1;i.radius2_=e.radius2;i.angle_=e.angle!==undefined?e.angle:0;i.stroke_=e.stroke!==undefined?e.stroke:null;i.anchor_=null;i.size_=null;i.imageSize_=null;i.hitDetectionImageSize_=null;i.render();return i}e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():undefined,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():undefined,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});t.setOpacity(this.getOpacity());t.setScale(this.getScale());return t};e.prototype.getAnchor=function(){return this.anchor_};e.prototype.getAngle=function(){return this.angle_};e.prototype.getFill=function(){return this.fill_};e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionCanvas_){var t=this.createRenderOptions();this.createHitDetectionCanvas_(t)}return this.hitDetectionCanvas_};e.prototype.getImage=function(t){if(!this.canvas_[t||1]){var e=this.createRenderOptions();var i=Ce(e.size*t||1,e.size*t||1);this.draw_(e,i,0,0,t||1);this.canvas_[t||1]=i.canvas}return this.canvas_[t||1]};e.prototype.getPixelRatio=function(t){return t};e.prototype.getImageSize=function(){return this.imageSize_};e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_};e.prototype.getImageState=function(){return In.LOADED};e.prototype.getOrigin=function(){return this.origin_};e.prototype.getPoints=function(){return this.points_};e.prototype.getRadius=function(){return this.radius_};e.prototype.getRadius2=function(){return this.radius2_};e.prototype.getSize=function(){return this.size_};e.prototype.getStroke=function(){return this.stroke_};e.prototype.listenImageChange=function(t){};e.prototype.load=function(){};e.prototype.unlistenImageChange=function(t){};e.prototype.createRenderOptions=function(){var t=je;var e=Xe;var i=0;var n=null;var r=0;var o;var a=0;if(this.stroke_){o=this.stroke_.getColor();if(o===null){o=Ke}o=ve(o);a=this.stroke_.getWidth();if(a===undefined){a=Ve}n=this.stroke_.getLineDash();r=this.stroke_.getLineDashOffset();e=this.stroke_.getLineJoin();if(e===undefined){e=Xe}t=this.stroke_.getLineCap();if(t===undefined){t=je}i=this.stroke_.getMiterLimit();if(i===undefined){i=We}}var s=2*(this.radius_+a)+1;return{strokeStyle:o,strokeWidth:a,size:s,lineCap:t,lineDash:n,lineDashOffset:r,lineJoin:e,miterLimit:i}};e.prototype.render=function(){var t=this.createRenderOptions();var e=Ce(t.size,t.size);this.draw_(t,e,0,0,1);this.canvas_[1]=e.canvas;var i=e.canvas.width;var n=i;var r=this.getDisplacement();this.hitDetectionImageSize_=[t.size,t.size];this.createHitDetectionCanvas_(t);this.anchor_=[i/2-r[0],i/2+r[1]];this.size_=[i,i];this.imageSize_=[n,n]};e.prototype.draw_=function(t,e,i,n,r){var o,a,s;e.setTransform(r,0,0,r,0,0);e.translate(i,n);e.beginPath();var u=this.points_;if(u===Infinity){e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,true)}else{var l=this.radius2_!==undefined?this.radius2_:this.radius_;if(l!==this.radius_){u=2*u}for(o=0;o<=u;o++){a=o*2*Math.PI/u-Math.PI/2+this.angle_;s=o%2===0?this.radius_:l;e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}}if(this.fill_){var h=this.fill_.getColor();if(h===null){h=Ge}e.fillStyle=ve(h);e.fill()}if(this.stroke_){e.strokeStyle=t.strokeStyle;e.lineWidth=t.strokeWidth;if(e.setLineDash&&t.lineDash){e.setLineDash(t.lineDash);e.lineDashOffset=t.lineDashOffset}e.lineCap=t.lineCap;e.lineJoin=t.lineJoin;e.miterLimit=t.miterLimit;e.stroke()}e.closePath()};e.prototype.createHitDetectionCanvas_=function(t){this.hitDetectionCanvas_=this.getImage(1);if(this.fill_){var e=this.fill_.getColor();var i=0;if(typeof e==="string"){e=At(e)}if(e===null){i=1}else if(Array.isArray(e)){i=e.length===4?e[3]:1}if(i===0){var n=Ce(t.size,t.size);this.hitDetectionCanvas_=n.canvas;this.drawHitDetectionCanvas_(t,n,0,0)}}};e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.translate(i,n);e.beginPath();var r=this.points_;if(r===Infinity){e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,true)}else{var o=this.radius2_!==undefined?this.radius2_:this.radius_;if(o!==this.radius_){r=2*r}var a=void 0,s=void 0,u=void 0;for(a=0;a<=r;a++){u=a*2*Math.PI/r-Math.PI/2+this.angle_;s=a%2===0?this.radius_:o;e.lineTo(t.size/2+s*Math.cos(u),t.size/2+s*Math.sin(u))}}e.fillStyle=Ge;e.fill();if(this.stroke_){e.strokeStyle=t.strokeStyle;e.lineWidth=t.strokeWidth;if(t.lineDash){e.setLineDash(t.lineDash);e.lineDashOffset=t.lineDashOffset}e.stroke()}e.closePath()};return e}(Za);var Va=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ha=function(t){Va(e,t);function e(e){var i=this;var n=e?e:{};i=t.call(this,{points:Infinity,fill:n.fill,radius:n.radius,stroke:n.stroke,displacement:n.displacement!==undefined?n.displacement:[0,0]})||this;return i}e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():undefined,stroke:this.getStroke()?this.getStroke().clone():undefined,radius:this.getRadius(),displacement:this.getDisplacement().slice()});t.setOpacity(this.getOpacity());t.setScale(this.getScale());return t};e.prototype.setRadius=function(t){this.radius_=t;this.render()};return e}(Ba);var qa=function(){function t(t){var e=t||{};this.color_=e.color!==undefined?e.color:null}t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||undefined})};t.prototype.getColor=function(){return this.color_};t.prototype.setColor=function(t){this.color_=t};return t}();var Ja=function(){function t(t){var e=t||{};this.color_=e.color!==undefined?e.color:null;this.lineCap_=e.lineCap;this.lineDash_=e.lineDash!==undefined?e.lineDash:null;this.lineDashOffset_=e.lineDashOffset;this.lineJoin_=e.lineJoin;this.miterLimit_=e.miterLimit;this.width_=e.width}t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||undefined,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():undefined,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})};t.prototype.getColor=function(){return this.color_};t.prototype.getLineCap=function(){return this.lineCap_};t.prototype.getLineDash=function(){return this.lineDash_};t.prototype.getLineDashOffset=function(){return this.lineDashOffset_};t.prototype.getLineJoin=function(){return this.lineJoin_};t.prototype.getMiterLimit=function(){return this.miterLimit_};t.prototype.getWidth=function(){return this.width_};t.prototype.setColor=function(t){this.color_=t};t.prototype.setLineCap=function(t){this.lineCap_=t};t.prototype.setLineDash=function(t){this.lineDash_=t};t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t};t.prototype.setLineJoin=function(t){this.lineJoin_=t};t.prototype.setMiterLimit=function(t){this.miterLimit_=t};t.prototype.setWidth=function(t){this.width_=t};return t}();var Qa=function(){function t(t){var e=t||{};this.geometry_=null;this.geometryFunction_=is;if(e.geometry!==undefined){this.setGeometry(e.geometry)}this.fill_=e.fill!==undefined?e.fill:null;this.image_=e.image!==undefined?e.image:null;this.renderer_=e.renderer!==undefined?e.renderer:null;this.stroke_=e.stroke!==undefined?e.stroke:null;this.text_=e.text!==undefined?e.text:null;this.zIndex_=e.zIndex}t.prototype.clone=function(){var e=this.getGeometry();if(e&&typeof e==="object"){e=e.clone()}return new t({geometry:e,fill:this.getFill()?this.getFill().clone():undefined,image:this.getImage()?this.getImage().clone():undefined,stroke:this.getStroke()?this.getStroke().clone():undefined,text:this.getText()?this.getText().clone():undefined,zIndex:this.getZIndex()})};t.prototype.getRenderer=function(){return this.renderer_};t.prototype.setRenderer=function(t){this.renderer_=t};t.prototype.getGeometry=function(){return this.geometry_};t.prototype.getGeometryFunction=function(){return this.geometryFunction_};t.prototype.getFill=function(){return this.fill_};t.prototype.setFill=function(t){this.fill_=t};t.prototype.getImage=function(){return this.image_};t.prototype.setImage=function(t){this.image_=t};t.prototype.getStroke=function(){return this.stroke_};t.prototype.setStroke=function(t){this.stroke_=t};t.prototype.getText=function(){return this.text_};t.prototype.setText=function(t){this.text_=t};t.prototype.getZIndex=function(){return this.zIndex_};t.prototype.setGeometry=function(t){if(typeof t==="function"){this.geometryFunction_=t}else if(typeof t==="string"){this.geometryFunction_=function(e){return e.get(t)}}else if(!t){this.geometryFunction_=is}else if(t!==undefined){this.geometryFunction_=function(){return t}}this.geometry_=t};t.prototype.setZIndex=function(t){this.zIndex_=t};return t}();function $a(t){var e;if(typeof t==="function"){e=t}else{var i;if(Array.isArray(t)){i=t}else{E(typeof t.getZIndex==="function",41);var n=t;i=[n]}e=function(){return i}}return e}var ts=null;function es(t,e){if(!ts){var i=new qa({color:"rgba(255,255,255,0.4)"});var n=new Ja({color:"#3399CC",width:1.25});ts=[new Qa({image:new Ha({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return ts}function is(t){return t.getGeometry()}var ns=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var rs={RENDER_ORDER:"renderOrder"};var os=function(t){ns(e,t);function e(e){var i=this;var n=e?e:{};var r=zt({},n);delete r.style;delete r.renderBuffer;delete r.updateWhileAnimating;delete r.updateWhileInteracting;i=t.call(this,r)||this;i.declutter_=n.declutter!==undefined?n.declutter:false;i.renderBuffer_=n.renderBuffer!==undefined?n.renderBuffer:100;i.style_=null;i.styleFunction_=undefined;i.setStyle(n.style);i.updateWhileAnimating_=n.updateWhileAnimating!==undefined?n.updateWhileAnimating:false;i.updateWhileInteracting_=n.updateWhileInteracting!==undefined?n.updateWhileInteracting:false;return i}e.prototype.getDeclutter=function(){return this.declutter_};e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)};e.prototype.getRenderBuffer=function(){return this.renderBuffer_};e.prototype.getRenderOrder=function(){return this.get(rs.RENDER_ORDER)};e.prototype.getStyle=function(){return this.style_};e.prototype.getStyleFunction=function(){return this.styleFunction_};e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_};e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_};e.prototype.setRenderOrder=function(t){this.set(rs.RENDER_ORDER,t)};e.prototype.setStyle=function(t){this.style_=t!==undefined?t:es;this.styleFunction_=t===null?undefined:$a(this.style_);this.changed()};return e}(fe);var as={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12};var ss=[as.FILL];var us=[as.STROKE];var ls=[as.BEGIN_PATH];var hs=[as.CLOSE_PATH];var fs=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var cs=function(t){fs(e,t);function e(e,i,n,r){var o=t.call(this)||this;o.tolerance=e;o.maxExtent=i;o.pixelRatio=r;o.maxLineWidth=0;o.resolution=n;o.beginGeometryInstruction1_=null;o.beginGeometryInstruction2_=null;o.bufferedMaxExtent_=null;o.instructions=[];o.coordinates=[];o.tmpCoordinate_=[];o.hitDetectionInstructions=[];o.state={};return o}e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return e==1?t:t.map((function(t){return t*e}))};e.prototype.appendFlatCoordinates=function(t,e,i,n,r,o){var a=this.coordinates.length;var s=this.getBufferedMaxExtent();if(o){e+=n}var u=t[e];var l=t[e+1];var h=this.tmpCoordinate_;var f=true;var c,p,d;for(c=e+n;c<i;c+=n){h[0]=t[c];h[1]=t[c+1];d=z(s,h);if(d!==p){if(f){this.coordinates[a++]=u;this.coordinates[a++]=l}this.coordinates[a++]=h[0];this.coordinates[a++]=h[1];f=false}else if(d===M.INTERSECTING){this.coordinates[a++]=h[0];this.coordinates[a++]=h[1];f=false}else{f=true}u=h[0];l=h[1];p=d}if(r&&f||c===e+n){this.coordinates[a++]=u;this.coordinates[a++]=l}return a};e.prototype.drawCustomCoordinates_=function(t,e,i,n,r){for(var o=0,a=i.length;o<a;++o){var s=i[o];var u=this.appendFlatCoordinates(t,e,s,n,false,false);r.push(u);e=s}return e};e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n=t.getType();var r=t.getStride();var o=this.coordinates.length;var a,s,u,l;var h;if(n==pe.MULTI_POLYGON){a=t.getOrientedFlatCoordinates();l=[];var f=t.getEndss();h=0;for(var c=0,p=f.length;c<p;++c){var d=[];h=this.drawCustomCoordinates_(a,h,f[c],r,d);l.push(d)}this.instructions.push([as.CUSTOM,o,l,t,i,eo])}else if(n==pe.POLYGON||n==pe.MULTI_LINE_STRING){u=[];a=n==pe.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates();h=this.drawCustomCoordinates_(a,0,t.getEnds(),r,u);this.instructions.push([as.CUSTOM,o,u,t,i,to])}else if(n==pe.LINE_STRING||n==pe.MULTI_POINT){a=t.getFlatCoordinates();s=this.appendFlatCoordinates(a,0,a.length,r,false,false);this.instructions.push([as.CUSTOM,o,s,t,i,$r])}else if(n==pe.POINT){a=t.getFlatCoordinates();this.coordinates.push(a[0],a[1]);s=this.coordinates.length;this.instructions.push([as.CUSTOM,o,s,t,i])}this.endGeometry(e)};e.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[as.BEGIN_GEOMETRY,e,0,i];this.instructions.push(this.beginGeometryInstruction1_);this.beginGeometryInstruction2_=[as.BEGIN_GEOMETRY,e,0,i];this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)};e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}};e.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var e;var i=t.length;var n;var r;var o=-1;for(e=0;e<i;++e){n=t[e];r=n[0];if(r==as.END_GEOMETRY){o=e}else if(r==as.BEGIN_GEOMETRY){n[2]=e;s(this.hitDetectionInstructions,o,e);o=-1}}};e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=ve(n?n:Ge)}else{i.fillStyle=undefined}if(e){var r=e.getColor();i.strokeStyle=ve(r?r:Ke);var o=e.getLineCap();i.lineCap=o!==undefined?o:je;var a=e.getLineDash();i.lineDash=a?a.slice():Ye;var s=e.getLineDashOffset();i.lineDashOffset=s?s:ze;var u=e.getLineJoin();i.lineJoin=u!==undefined?u:Xe;var l=e.getWidth();i.lineWidth=l!==undefined?l:Ve;var h=e.getMiterLimit();i.miterLimit=h!==undefined?h:We;if(i.lineWidth>this.maxLineWidth){this.maxLineWidth=i.lineWidth;this.bufferedMaxExtent_=null}}else{i.strokeStyle=undefined;i.lineCap=undefined;i.lineDash=null;i.lineDashOffset=undefined;i.lineJoin=undefined;i.lineWidth=undefined;i.miterLimit=undefined}};e.prototype.createFill=function(t){var e=t.fillStyle;var i=[as.SET_FILL_STYLE,e];if(typeof e!=="string"){i.push(true)}return i};e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))};e.prototype.createStroke=function(t){return[as.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]};e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;if(typeof i!=="string"||t.currentFillStyle!=i){if(i!==undefined){this.instructions.push(e.call(this,t))}t.currentFillStyle=i}};e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle;var n=t.lineCap;var r=t.lineDash;var o=t.lineDashOffset;var a=t.lineJoin;var s=t.lineWidth;var u=t.miterLimit;if(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!l(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=s||t.currentMiterLimit!=u){if(i!==undefined){e.call(this,t)}t.currentStrokeStyle=i;t.currentLineCap=n;t.currentLineDash=r;t.currentLineDashOffset=o;t.currentLineJoin=a;t.currentLineWidth=s;t.currentMiterLimit=u}};e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length;this.beginGeometryInstruction1_=null;this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length;this.beginGeometryInstruction2_=null;var e=[as.END_GEOMETRY,t];this.instructions.push(e);this.hitDetectionInstructions.push(e)};e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_){this.bufferedMaxExtent_=N(this.maxExtent);if(this.maxLineWidth>0){var t=this.resolution*(this.maxLineWidth+1)/2;F(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}}return this.bufferedMaxExtent_};return e}(de);var ps=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ds=function(t){ps(e,t);function e(e,i,n,r){var o=t.call(this,e,i,n,r)||this;o.declutterGroups_=null;o.hitDetectionImage_=null;o.image_=null;o.imagePixelRatio_=undefined;o.anchorX_=undefined;o.anchorY_=undefined;o.height_=undefined;o.opacity_=undefined;o.originX_=undefined;o.originY_=undefined;o.rotateWithView_=undefined;o.rotation_=undefined;o.scale_=undefined;o.width_=undefined;return o}e.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,false,false)};e.prototype.drawPoint=function(t,e){if(!this.image_){return}this.beginGeometry(t,e);var i=t.getFlatCoordinates();var n=t.getStride();var r=this.coordinates.length;var o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([as.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]);this.hitDetectionInstructions.push([as.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]);this.endGeometry(e)};e.prototype.drawMultiPoint=function(t,e){if(!this.image_){return}this.beginGeometry(t,e);var i=t.getFlatCoordinates();var n=t.getStride();var r=this.coordinates.length;var o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([as.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]);this.hitDetectionInstructions.push([as.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]);this.endGeometry(e)};e.prototype.finish=function(){this.reverseHitDetectionInstructions();this.anchorX_=undefined;this.anchorY_=undefined;this.hitDetectionImage_=null;this.image_=null;this.imagePixelRatio_=undefined;this.height_=undefined;this.scale_=undefined;this.opacity_=undefined;this.originX_=undefined;this.originY_=undefined;this.rotateWithView_=undefined;this.rotation_=undefined;this.width_=undefined;return t.prototype.finish.call(this)};e.prototype.setImageStyle=function(t,e){var i=t.getAnchor();var n=t.getSize();var r=t.getHitDetectionImage();var o=t.getImage(this.pixelRatio);var a=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio);this.anchorX_=i[0];this.anchorY_=i[1];this.declutterGroups_=e;this.hitDetectionImage_=r;this.image_=o;this.height_=n[1];this.opacity_=t.getOpacity();this.originX_=a[0];this.originY_=a[1];this.rotateWithView_=t.getRotateWithView();this.rotation_=t.getRotation();this.scale_=t.getScaleArray();this.width_=n[0]};return e}(cs);var vs=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var _s=function(t){vs(e,t);function e(e,i,n,r){return t.call(this,e,i,n,r)||this}e.prototype.drawFlatCoordinates_=function(t,e,i,n){var r=this.coordinates.length;var o=this.appendFlatCoordinates(t,e,i,n,false,false);var a=[as.MOVE_TO_LINE_TO,r,o];this.instructions.push(a);this.hitDetectionInstructions.push(a);return i};e.prototype.drawLineString=function(t,e){var i=this.state;var n=i.strokeStyle;var r=i.lineWidth;if(n===undefined||r===undefined){return}this.updateStrokeStyle(i,this.applyStroke);this.beginGeometry(t,e);this.hitDetectionInstructions.push([as.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],ls);var o=t.getFlatCoordinates();var a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a);this.hitDetectionInstructions.push(us);this.endGeometry(e)};e.prototype.drawMultiLineString=function(t,e){var i=this.state;var n=i.strokeStyle;var r=i.lineWidth;if(n===undefined||r===undefined){return}this.updateStrokeStyle(i,this.applyStroke);this.beginGeometry(t,e);this.hitDetectionInstructions.push([as.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],ls);var o=t.getEnds();var a=t.getFlatCoordinates();var s=t.getStride();var u=0;for(var l=0,h=o.length;l<h;++l){u=this.drawFlatCoordinates_(a,u,o[l],s)}this.hitDetectionInstructions.push(us);this.endGeometry(e)};e.prototype.finish=function(){var e=this.state;if(e.lastStroke!=undefined&&e.lastStroke!=this.coordinates.length){this.instructions.push(us)}this.reverseHitDetectionInstructions();this.state=null;return t.prototype.finish.call(this)};e.prototype.applyStroke=function(e){if(e.lastStroke!=undefined&&e.lastStroke!=this.coordinates.length){this.instructions.push(us);e.lastStroke=this.coordinates.length}e.lastStroke=0;t.prototype.applyStroke.call(this,e);this.instructions.push(ls)};return e}(cs);var gs=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var ys=function(t){gs(e,t);function e(e,i,n,r){return t.call(this,e,i,n,r)||this}e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var r=this.state;var o=r.fillStyle!==undefined;var a=r.strokeStyle!==undefined;var s=i.length;this.instructions.push(ls);this.hitDetectionInstructions.push(ls);for(var u=0;u<s;++u){var l=i[u];var h=this.coordinates.length;var f=this.appendFlatCoordinates(t,e,l,n,true,!a);var c=[as.MOVE_TO_LINE_TO,h,f];this.instructions.push(c);this.hitDetectionInstructions.push(c);if(a){this.instructions.push(hs);this.hitDetectionInstructions.push(hs)}e=l}if(o){this.instructions.push(ss);this.hitDetectionInstructions.push(ss)}if(a){this.instructions.push(us);this.hitDetectionInstructions.push(us)}return e};e.prototype.drawCircle=function(t,e){var i=this.state;var n=i.fillStyle;var r=i.strokeStyle;if(n===undefined&&r===undefined){return}this.setFillStrokeStyles_();this.beginGeometry(t,e);if(i.fillStyle!==undefined){this.hitDetectionInstructions.push([as.SET_FILL_STYLE,Ge])}if(i.strokeStyle!==undefined){this.hitDetectionInstructions.push([as.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset])}var o=t.getFlatCoordinates();var a=t.getStride();var s=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,a,false,false);var u=[as.CIRCLE,s];this.instructions.push(ls,u);this.hitDetectionInstructions.push(ls,u);if(i.fillStyle!==undefined){this.instructions.push(ss);this.hitDetectionInstructions.push(ss)}if(i.strokeStyle!==undefined){this.instructions.push(us);this.hitDetectionInstructions.push(us)}this.endGeometry(e)};e.prototype.drawPolygon=function(t,e){var i=this.state;var n=i.fillStyle;var r=i.strokeStyle;if(n===undefined&&r===undefined){return}this.setFillStrokeStyles_();this.beginGeometry(t,e);if(i.fillStyle!==undefined){this.hitDetectionInstructions.push([as.SET_FILL_STYLE,Ge])}if(i.strokeStyle!==undefined){this.hitDetectionInstructions.push([as.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset])}var o=t.getEnds();var a=t.getOrientedFlatCoordinates();var s=t.getStride();this.drawFlatCoordinatess_(a,0,o,s);this.endGeometry(e)};e.prototype.drawMultiPolygon=function(t,e){var i=this.state;var n=i.fillStyle;var r=i.strokeStyle;if(n===undefined&&r===undefined){return}this.setFillStrokeStyles_();this.beginGeometry(t,e);if(i.fillStyle!==undefined){this.hitDetectionInstructions.push([as.SET_FILL_STYLE,Ge])}if(i.strokeStyle!==undefined){this.hitDetectionInstructions.push([as.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset])}var o=t.getEndss();var a=t.getOrientedFlatCoordinates();var s=t.getStride();var u=0;for(var l=0,h=o.length;l<h;++l){u=this.drawFlatCoordinatess_(a,u,o[l],s)}this.endGeometry(e)};e.prototype.finish=function(){this.reverseHitDetectionInstructions();this.state=null;var e=this.tolerance;if(e!==0){var i=this.coordinates;for(var n=0,r=i.length;n<r;++n){i[n]=qr(i[n],e)}}return t.prototype.finish.call(this)};e.prototype.setFillStrokeStyles_=function(){var t=this.state;var e=t.fillStyle;if(e!==undefined){this.updateFillStyle(t,this.createFill)}if(t.strokeStyle!==undefined){this.updateStrokeStyle(t,this.applyStroke)}};return e}(cs);var ms={POINT:"point",LINE:"line"};function xs(t,e,i,n,r){var o=i;var a=i;var s=0;var u=0;var l=i;var h,f,c,p,d,v,_,g,y,m;for(f=i;f<n;f+=r){var x=e[f];var E=e[f+1];if(d!==undefined){y=x-d;m=E-v;p=Math.sqrt(y*y+m*m);if(_!==undefined){u+=c;h=Math.acos((_*y+g*m)/(c*p));if(h>t){if(u>s){s=u;o=l;a=f}u=0;l=f-r}}c=p;_=y;g=m}d=x;v=E}u+=p;return u>s?[l,f]:[o,a]}var Es=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ts={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};var Rs=function(t){Es(e,t);function e(e,i,n,r){var o=t.call(this,e,i,n,r)||this;o.labels_=null;o.text_="";o.textOffsetX_=0;o.textOffsetY_=0;o.textRotateWithView_=undefined;o.textRotation_=0;o.textFillState_=null;o.fillStates={};o.textStrokeState_=null;o.strokeStates={};o.textState_={};o.textStates={};o.textKey_="";o.fillKey_="";o.strokeKey_="";return o}e.prototype.finish=function(){var e=t.prototype.finish.call(this);e.textStates=this.textStates;e.fillStates=this.fillStates;e.strokeStates=this.strokeStates;return e};e.prototype.drawText=function(t,e){var i=this.textFillState_;var n=this.textStrokeState_;var r=this.textState_;if(this.text_===""||!r||!i&&!n){return}var o=this.coordinates.length;var a=t.getType();var s=null;var u=2;var l=t.getStride();var h,f;if(r.placement===ms.LINE){if(!ct(this.getBufferedMaxExtent(),t.getExtent())){return}var c=void 0;s=t.getFlatCoordinates();if(a==pe.LINE_STRING){c=[s.length]}else if(a==pe.MULTI_LINE_STRING){c=t.getEnds()}else if(a==pe.POLYGON){c=t.getEnds().slice(0,1)}else if(a==pe.MULTI_POLYGON){var p=t.getEndss();c=[];for(h=0,f=p.length;h<f;++h){c.push(p[h][0])}}this.beginGeometry(t,e);var d=r.textAlign;var v=0;var _=void 0;for(var g=0,y=c.length;g<y;++g){if(d==undefined){var m=xs(r.maxAngle,s,v,c[g],l);v=m[0];_=m[1]}else{_=c[g]}for(h=v;h<_;h+=l){this.coordinates.push(s[h],s[h+1])}u=this.coordinates.length;v=c[g];var x=this.declutterGroups_?g===0?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(o,u,x);o=u}this.endGeometry(e)}else{var E=null;if(!r.overflow){E=[]}switch(a){case pe.POINT:case pe.MULTI_POINT:s=t.getFlatCoordinates();u=s.length;break;case pe.LINE_STRING:s=t.getFlatMidpoint();break;case pe.CIRCLE:s=t.getCenter();break;case pe.MULTI_LINE_STRING:s=t.getFlatMidpoints();l=2;u=s.length;break;case pe.POLYGON:s=t.getFlatInteriorPoint();if(!r.overflow){E.push(s[2]/this.resolution)}l=3;break;case pe.MULTI_POLYGON:var T=t.getFlatInteriorPoints();s=[];for(h=0,f=T.length;h<f;h+=3){if(!r.overflow){E.push(T[h+2]/this.resolution)}s.push(T[h],T[h+1])}l=2;u=s.length;if(u==0){return}break}u=this.appendFlatCoordinates(s,0,u,l,false,false);this.saveTextStates_();if(r.backgroundFill||r.backgroundStroke){this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke);if(r.backgroundFill){this.updateFillStyle(this.state,this.createFill);this.hitDetectionInstructions.push(this.createFill(this.state))}if(r.backgroundStroke){this.updateStrokeStyle(this.state,this.applyStroke);this.hitDetectionInstructions.push(this.createStroke(this.state))}}this.beginGeometry(t,e);var R=r.padding;if(R!=Be&&(r.scale[0]<0||r.scale[1]<0)){var O=r.padding[0];var C=r.padding[1];var S=r.padding[2];var I=r.padding[3];if(r.scale[0]<0){C=-C;I=-I}if(r.scale[1]<0){O=-O;S=-S}R=[O,C,S,I]}var w=this.pixelRatio;this.instructions.push([as.DRAW_IMAGE,o,u,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,R==Be?Be:R.map((function(t){return t*w})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,E]);var P=1/w;this.hitDetectionInstructions.push([as.DRAW_IMAGE,o,u,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[P,P],NaN,R,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,E]);this.endGeometry(e)}};e.prototype.saveTextStates_=function(){var t=this.textStrokeState_;var e=this.textState_;var i=this.textFillState_;var n=this.strokeKey_;if(t){if(!(n in this.strokeStates)){this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}}}var r=this.textKey_;if(!(r in this.textStates)){this.textStates[r]={font:e.font,textAlign:e.textAlign||Ze,textBaseline:e.textBaseline||Ue,scale:e.scale}}var o=this.fillKey_;if(i){if(!(o in this.fillStates)){this.fillStates[o]={fillStyle:i.fillStyle}}}};e.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_;var r=this.textState_;var o=this.strokeKey_;var a=this.textKey_;var s=this.fillKey_;this.saveTextStates_();var u=this.pixelRatio;var l=Ts[r.textBaseline];var h=this.textOffsetY_*u;var f=this.text_;var c=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([as.DRAW_CHARS,t,e,l,i,r.overflow,s,r.maxAngle,u,h,o,c*u,f,a,1]);this.hitDetectionInstructions.push([as.DRAW_CHARS,t,e,l,i,r.overflow,s,r.maxAngle,1,h,o,c,f,a,1/u])};e.prototype.setTextStyle=function(t,e){var i,n,r;if(!t){this.text_=""}else{this.declutterGroups_=e;var o=t.getFill();if(!o){n=null;this.textFillState_=n}else{n=this.textFillState_;if(!n){n={};this.textFillState_=n}n.fillStyle=ve(o.getColor()||Ge)}var a=t.getStroke();if(!a){r=null;this.textStrokeState_=r}else{r=this.textStrokeState_;if(!r){r={};this.textStrokeState_=r}var s=a.getLineDash();var u=a.getLineDashOffset();var l=a.getWidth();var h=a.getMiterLimit();r.lineCap=a.getLineCap()||je;r.lineDash=s?s.slice():Ye;r.lineDashOffset=u===undefined?ze:u;r.lineJoin=a.getLineJoin()||Xe;r.lineWidth=l===undefined?Ve:l;r.miterLimit=h===undefined?We:h;r.strokeStyle=ve(a.getColor()||Ke)}i=this.textState_;var f=t.getFont()||ke;ti(f);var c=t.getScaleArray();i.overflow=t.getOverflow();i.font=f;i.maxAngle=t.getMaxAngle();i.placement=t.getPlacement();i.textAlign=t.getTextAlign();i.textBaseline=t.getTextBaseline()||Ue;i.backgroundFill=t.getBackgroundFill();i.backgroundStroke=t.getBackgroundStroke();i.padding=t.getPadding()||Be;i.scale=c===undefined?[1,1]:c;var p=t.getOffsetX();var d=t.getOffsetY();var v=t.getRotateWithView();var _=t.getRotation();this.text_=t.getText()||"";this.textOffsetX_=p===undefined?0:p;this.textOffsetY_=d===undefined?0:d;this.textRotateWithView_=v===undefined?false:v;this.textRotation_=_===undefined?0:_;this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:g(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"";this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?");this.fillKey_=n?typeof n.fillStyle=="string"?n.fillStyle:"|"+g(n.fillStyle):""}};return e}(cs);var Os={Circle:ys,Default:cs,Image:ds,LineString:_s,Polygon:ys,Text:Rs};var Cs=function(){function t(t,e,i,n,r){this.declutter_=r;this.declutterGroups_=null;this.tolerance_=t;this.maxExtent_=e;this.pixelRatio_=n;this.resolution_=i;this.buildersByZIndex_={}}t.prototype.addDeclutter=function(t){var e=null;if(this.declutter_){if(t){e=this.declutterGroups_;e[0][0]++}else{e=[[1]];this.declutterGroups_=e}}return e};t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var i=this.buildersByZIndex_[e];for(var n in i){var r=i[n].finish();t[e][n]=r}}return t};t.prototype.getBuilder=function(t,e){var i=t!==undefined?t.toString():"0";var n=this.buildersByZIndex_[i];if(n===undefined){n={};this.buildersByZIndex_[i]=n}var r=n[e];if(r===undefined){var o=Os[e];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_);n[e]=r}return r};return t}();var Ss=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Is=function(t){Ss(e,t);function e(e){var i=t.call(this)||this;i.boundHandleImageChange_=i.handleImageChange_.bind(i);i.layer_=e;return i}e.prototype.getFeatures=function(t){return v()};e.prototype.prepareFrame=function(t){return v()};e.prototype.renderFrame=function(t,e){return v()};e.prototype.loadedTileCallback=function(t,e,i){if(!t[e]){t[e]={}}t[e][i.tileCoord.toString()]=i;return undefined};e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,r){var o=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,r,o)}.bind(this)};e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){};e.prototype.getDataAtPixel=function(t,e,i){return v()};e.prototype.getLayer=function(){return this.layer_};e.prototype.handleFontsChanged=function(){};e.prototype.handleImageChange_=function(t){var e=t.target;if(e.getState()===In.LOADED){this.renderIfReadyAndVisible()}};e.prototype.loadImage=function(t){var e=t.getState();if(e!=In.LOADED&&e!=In.ERROR){t.addEventListener(Bt.CHANGE,this.boundHandleImageChange_)}if(e==In.IDLE){t.load();e=t.getState()}return e==In.LOADED};e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();if(t.getVisible()&&t.getSourceState()==le.READY){t.changed()}};return e}(Qt);var ws=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ps=function(t){ws(e,t);function e(e){var i=t.call(this,e)||this;i.container=null;i.tempTransform=R();i.pixelTransform=R();i.inversePixelTransform=R();i.context=null;i.containerReused=false;return i}e.prototype.useContainer=function(t,e,i){var n=this.getLayer().getClassName();var r,o;if(t&&t.style.opacity===""&&t.className===n){var a=t.firstElementChild;if(a instanceof HTMLCanvasElement){o=a.getContext("2d")}}if(o&&(o.canvas.width===0||o.canvas.style.transform===e)){this.container=t;this.context=o;this.containerReused=true}else if(this.containerReused){this.container=null;this.context=null;this.containerReused=false}if(!this.container){r=document.createElement("div");r.className=n;var s=r.style;s.position="absolute";s.width="100%";s.height="100%";o=Ce();var a=o.canvas;r.appendChild(a);s=a.style;s.position="absolute";s.left="0";s.transformOrigin="top left";this.container=r;this.context=o}};e.prototype.clip=function(t,e,i){var n=e.pixelRatio;var r=e.size[0]*n/2;var o=e.size[1]*n/2;var a=e.viewState.rotation;var s=lt(i);var u=ht(i);var l=nt(i);var h=it(i);S(e.coordinateToPixelTransform,s);S(e.coordinateToPixelTransform,u);S(e.coordinateToPixelTransform,l);S(e.coordinateToPixelTransform,h);t.save();ai(t,-a,r,o);t.beginPath();t.moveTo(s[0]*n,s[1]*n);t.lineTo(u[0]*n,u[1]*n);t.lineTo(l[0]*n,l[1]*n);t.lineTo(h[0]*n,h[1]*n);t.clip();ai(t,a,r,o)};e.prototype.clipUnrotated=function(t,e,i){var n=lt(i);var r=ht(i);var o=nt(i);var a=it(i);S(e.coordinateToPixelTransform,n);S(e.coordinateToPixelTransform,r);S(e.coordinateToPixelTransform,o);S(e.coordinateToPixelTransform,a);var s=this.inversePixelTransform;S(s,n);S(s,r);S(s,o);S(s,a);t.save();t.beginPath();t.moveTo(Math.round(n[0]),Math.round(n[1]));t.lineTo(Math.round(r[0]),Math.round(r[1]));t.lineTo(Math.round(o[0]),Math.round(o[1]));t.lineTo(Math.round(a[0]),Math.round(a[1]));t.clip()};e.prototype.dispatchRenderEvent_=function(t,e,i){var n=this.getLayer();if(n.hasListener(t)){var r=new Hn(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}};e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(ue.PRERENDER,t,e)};e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(ue.POSTRENDER,t,e)};e.prototype.getRenderTransform=function(t,e,i,n,r,o,a){var s=r/2;var u=o/2;var l=n/e;var h=-l;var f=-t[0]+a;var c=-t[1];return w(this.tempTransform,s,u,l,h,-i,f,c)};e.prototype.getDataAtPixel=function(t,e,i){var n=S(this.inversePixelTransform,t.slice());var r=this.context;var o;try{var a=Math.round(n[0]);var s=Math.round(n[1]);var u=document.createElement("canvas");var l=u.getContext("2d");u.width=1;u.height=1;l.clearRect(0,0,1,1);l.drawImage(r.canvas,a,s,1,1,0,0,1,1);o=l.getImageData(0,0,1,1).data}catch(h){if(h.name==="SecurityError"){return new Uint8Array}return o}if(o[3]===0){return null}return o};return e}(Is);var bs=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function Ls(t,e,i){return i={path:e,exports:{},require:function(t,e){return As()}},t(i,i.exports),i.exports}function As(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Ms=Ls((function(t,e){(function(e,i){t.exports=i()})(bs,(function(){function t(t,i,r,o,a){e(t,i,r||0,o||t.length-1,a||n)}function e(t,n,r,o,a){while(o>r){if(o-r>600){var s=o-r+1;var u=n-r+1;var l=Math.log(s);var h=.5*Math.exp(2*l/3);var f=.5*Math.sqrt(l*h*(s-h)/s)*(u-s/2<0?-1:1);var c=Math.max(r,Math.floor(n-u*h/s+f));var p=Math.min(o,Math.floor(n+(s-u)*h/s+f));e(t,n,c,p,a)}var d=t[n];var v=r;var _=o;i(t,r,n);if(a(t[o],d)>0){i(t,r,o)}while(v<_){i(t,v,_);v++;_--;while(a(t[v],d)<0){v++}while(a(t[_],d)>0){_--}}if(a(t[r],d)===0){i(t,r,_)}else{_++;i(t,_,o)}if(_<=n){r=_+1}if(n<=_){o=_-1}}}function i(t,e,i){var n=t[e];t[e]=t[i];t[i]=n}function n(t,e){return t<e?-1:t>e?1:0}var r=function t(e){if(e===void 0)e=9;this._maxEntries=Math.max(4,e);this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4));this.clear()};r.prototype.all=function t(){return this._all(this.data,[])};r.prototype.search=function t(e){var i=this.data;var n=[];if(!_(e,i)){return n}var r=this.toBBox;var o=[];while(i){for(var a=0;a<i.children.length;a++){var s=i.children[a];var u=i.leaf?r(s):s;if(_(e,u)){if(i.leaf){n.push(s)}else if(v(e,u)){this._all(s,n)}else{o.push(s)}}}i=o.pop()}return n};r.prototype.collides=function t(e){var i=this.data;if(!_(e,i)){return false}var n=[];while(i){for(var r=0;r<i.children.length;r++){var o=i.children[r];var a=i.leaf?this.toBBox(o):o;if(_(e,a)){if(i.leaf||v(e,a)){return true}n.push(o)}}i=n.pop()}return false};r.prototype.load=function t(e){if(!(e&&e.length)){return this}if(e.length<this._minEntries){for(var i=0;i<e.length;i++){this.insert(e[i])}return this}var n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length){this.data=n}else if(this.data.height===n.height){this._splitRoot(this.data,n)}else{if(this.data.height<n.height){var r=this.data;this.data=n;n=r}this._insert(n,this.data.height-n.height-1,true)}return this};r.prototype.insert=function t(e){if(e){this._insert(e,this.data.height-1)}return this};r.prototype.clear=function t(){this.data=g([]);return this};r.prototype.remove=function t(e,i){if(!e){return this}var n=this.data;var r=this.toBBox(e);var a=[];var s=[];var u,l,h;while(n||a.length){if(!n){n=a.pop();l=a[a.length-1];u=s.pop();h=true}if(n.leaf){var f=o(e,n.children,i);if(f!==-1){n.children.splice(f,1);a.push(n);this._condense(a);return this}}if(!h&&!n.leaf&&v(n,r)){a.push(n);s.push(u);u=0;l=n;n=n.children[0]}else if(l){u++;n=l.children[u];h=false}else{n=null}}return this};r.prototype.toBBox=function t(e){return e};r.prototype.compareMinX=function t(e,i){return e.minX-i.minX};r.prototype.compareMinY=function t(e,i){return e.minY-i.minY};r.prototype.toJSON=function t(){return this.data};r.prototype.fromJSON=function t(e){this.data=e;return this};r.prototype._all=function t(e,i){var n=[];while(e){if(e.leaf){i.push.apply(i,e.children)}else{n.push.apply(n,e.children)}e=n.pop()}return i};r.prototype._build=function t(e,i,n,r){var o=n-i+1;var s=this._maxEntries;var u;if(o<=s){u=g(e.slice(i,n+1));a(u,this.toBBox);return u}if(!r){r=Math.ceil(Math.log(o)/Math.log(s));s=Math.ceil(o/Math.pow(s,r-1))}u=g([]);u.leaf=false;u.height=r;var l=Math.ceil(o/s);var h=l*Math.ceil(Math.sqrt(s));y(e,i,n,h,this.compareMinX);for(var f=i;f<=n;f+=h){var c=Math.min(f+h-1,n);y(e,f,c,l,this.compareMinY);for(var p=f;p<=c;p+=l){var d=Math.min(p+l-1,c);u.children.push(this._build(e,p,d,r-1))}}a(u,this.toBBox);return u};r.prototype._chooseSubtree=function t(e,i,n,r){while(true){r.push(i);if(i.leaf||r.length-1===n){break}var o=Infinity;var a=Infinity;var s=void 0;for(var u=0;u<i.children.length;u++){var l=i.children[u];var h=f(l);var c=p(e,l)-h;if(c<a){a=c;o=h<o?h:o;s=l}else if(c===a){if(h<o){o=h;s=l}}}i=s||i.children[0]}return i};r.prototype._insert=function t(e,i,n){var r=n?e:this.toBBox(e);var o=[];var a=this._chooseSubtree(r,this.data,i,o);a.children.push(e);u(a,r);while(i>=0){if(o[i].children.length>this._maxEntries){this._split(o,i);i--}else{break}}this._adjustParentBBoxes(r,o,i)};r.prototype._split=function t(e,i){var n=e[i];var r=n.children.length;var o=this._minEntries;this._chooseSplitAxis(n,o,r);var s=this._chooseSplitIndex(n,o,r);var u=g(n.children.splice(s,n.children.length-s));u.height=n.height;u.leaf=n.leaf;a(n,this.toBBox);a(u,this.toBBox);if(i){e[i-1].children.push(u)}else{this._splitRoot(n,u)}};r.prototype._splitRoot=function t(e,i){this.data=g([e,i]);this.data.height=e.height+1;this.data.leaf=false;a(this.data,this.toBBox)};r.prototype._chooseSplitIndex=function t(e,i,n){var r;var o=Infinity;var a=Infinity;for(var u=i;u<=n-i;u++){var l=s(e,0,u,this.toBBox);var h=s(e,u,n,this.toBBox);var c=d(l,h);var p=f(l)+f(h);if(c<o){o=c;r=u;a=p<a?p:a}else if(c===o){if(p<a){a=p;r=u}}}return r||n-i};r.prototype._chooseSplitAxis=function t(e,i,n){var r=e.leaf?this.compareMinX:l;var o=e.leaf?this.compareMinY:h;var a=this._allDistMargin(e,i,n,r);var s=this._allDistMargin(e,i,n,o);if(a<s){e.children.sort(r)}};r.prototype._allDistMargin=function t(e,i,n,r){e.children.sort(r);var o=this.toBBox;var a=s(e,0,i,o);var l=s(e,n-i,n,o);var h=c(a)+c(l);for(var f=i;f<n-i;f++){var p=e.children[f];u(a,e.leaf?o(p):p);h+=c(a)}for(var d=n-i-1;d>=i;d--){var v=e.children[d];u(l,e.leaf?o(v):v);h+=c(l)}return h};r.prototype._adjustParentBBoxes=function t(e,i,n){for(var r=n;r>=0;r--){u(i[r],e)}};r.prototype._condense=function t(e){for(var i=e.length-1,n=void 0;i>=0;i--){if(e[i].children.length===0){if(i>0){n=e[i-1].children;n.splice(n.indexOf(e[i]),1)}else{this.clear()}}else{a(e[i],this.toBBox)}}};function o(t,e,i){if(!i){return e.indexOf(t)}for(var n=0;n<e.length;n++){if(i(t,e[n])){return n}}return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,r){if(!r){r=g(null)}r.minX=Infinity;r.minY=Infinity;r.maxX=-Infinity;r.maxY=-Infinity;for(var o=e;o<i;o++){var a=t.children[o];u(r,t.leaf?n(a):a)}return r}function u(t,e){t.minX=Math.min(t.minX,e.minX);t.minY=Math.min(t.minY,e.minY);t.maxX=Math.max(t.maxX,e.maxX);t.maxY=Math.max(t.maxY,e.maxY);return t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d(t,e){var i=Math.max(t.minX,e.minX);var n=Math.max(t.minY,e.minY);var r=Math.min(t.maxX,e.maxX);var o=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,o-n)}function v(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function _(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:true,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function y(e,i,n,r,o){var a=[i,n];while(a.length){n=a.pop();i=a.pop();if(n-i<=r){continue}var s=i+Math.ceil((n-i)/r/2)*r;t(e,s,i,n,o);a.push(i,s,s,n)}}return r}))}));function Ds(t,e,i,n,r,o,a,s,u,l,h,f){var c=[];var p;if(f){var d=ci(t,e,i,n,f,[t[e],t[e+1]]);p=d[0]>d[d.length-n]}else{p=t[e]>t[i-n]}var v=r.length;var _=t[e];var g=t[e+1];e+=n;var y=t[e];var m=t[e+1];var x=0;var E=Math.sqrt(Math.pow(y-_,2)+Math.pow(m-g,2));var T=false;var R,O;for(var C=0;C<v;++C){R=p?v-C-1:C;var S=r[R];var I=s*u(l,S,h);var w=o+I/2;while(e<i-n&&x+E<w){_=y;g=m;e+=n;y=t[e];m=t[e+1];x+=E;E=Math.sqrt(Math.pow(y-_,2)+Math.pow(m-g,2))}var P=w-x;var b=Math.atan2(m-g,y-_);if(p){b+=b>0?-Math.PI:Math.PI}if(O!==undefined){var L=b-O;T=T||L!==0;L+=L>Math.PI?-2*Math.PI:L<-Math.PI?2*Math.PI:0;if(Math.abs(L)>a){return null}}O=b;var A=P/E;var M=St(_,y,A);var D=St(g,m,A);c[R]=[M,D,I/2,b,S];o+=I}return T?c:[[c[0][0],c[0][1],c[0][2],c[0][3],r]]}var Fs=X();var Ns=R();var ks=[];var Gs=[];var js=[];var Ys=[];var zs=function(){function t(t,e,i,n,r){this.overlaps=i;this.pixelRatio=e;this.resolution=t;this.declutterItems=[];this.instructions=n.instructions;this.coordinates=n.coordinates;this.coordinateCache_={};this.renderBuffer_=r;this.renderedTransform_=R();this.hitDetectionInstructions=n.hitDetectionInstructions;this.pixelCoordinates_=null;this.viewRotation_=0;this.fillStates=n.fillStates||{};this.strokeStates=n.strokeStates||{};this.textStates=n.textStates||{};this.widths_={};this.labels_={}}t.prototype.createLabel=function(t,e,i,n){var r=t+e+i+n;if(this.labels_[r]){return this.labels_[r]}var o=n?this.strokeStates[n]:null;var a=i?this.fillStates[i]:null;var s=this.textStates[e];var u=this.pixelRatio;var l=[s.scale[0]*u,s.scale[1]*u];var h=Ts[s.textAlign||Ze];var f=n&&o.lineWidth?o.lineWidth:0;var c=t.split("\n");var p=c.length;var d=[];var v=oi(s.font,c,d);var _=ei(s.font);var g=_*p;var y=v+f;var m=[];var x=(y+2)*l[0];var E=(g+f)*l[1];var T={width:x<0?Math.floor(x):Math.ceil(x),height:E<0?Math.floor(E):Math.ceil(E),contextInstructions:m};if(l[0]!=1||l[1]!=1){m.push("scale",l)}m.push("font",s.font);if(n){m.push("strokeStyle",o.strokeStyle);m.push("lineWidth",f);m.push("lineCap",o.lineCap);m.push("lineJoin",o.lineJoin);m.push("miterLimit",o.miterLimit);var R=Te?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;if(R.prototype.setLineDash){m.push("setLineDash",[o.lineDash]);m.push("lineDashOffset",o.lineDashOffset)}}if(i){m.push("fillStyle",a.fillStyle)}m.push("textBaseline","middle");m.push("textAlign","center");var O=.5-h;var C=h*y+O*f;var S;if(n){for(S=0;S<p;++S){m.push("strokeText",[c[S],C+O*d[S],.5*(f+_)+S*_])}}if(i){for(S=0;S<p;++S){m.push("fillText",[c[S],C+O*d[S],.5*(f+_)+S*_])}}this.labels_[r]=T;return T};t.prototype.replayTextBackground_=function(t,e,i,n,r,o,a,s){t.beginPath();t.moveTo.apply(t,e);t.lineTo.apply(t,i);t.lineTo.apply(t,n);t.lineTo.apply(t,r);t.lineTo.apply(t,e);if(o){this.alignFill_=o[2];if(s){t.fillStyle=o[1]}this.fill_(t)}if(a){this.setStrokeStyle_(t,a);t.stroke()}};t.prototype.replayImageOrLabel_=function(t,e,i,n,r,o,a,s,u,l,h,f,c,p,d,v,_,g,y){var m=g||y;o*=p[0];a*=p[1];i-=o;n-=a;var x=v+h>r.width?r.width-h:v;var E=u+f>r.height?r.height-f:u;var T=_[3]+x*p[0]+_[1];var R=_[0]+E*p[1]+_[2];var O=i-_[3];var C=n-_[0];if(m||c!==0){ks[0]=O;Ys[0]=O;ks[1]=C;Gs[1]=C;Gs[0]=O+T;js[0]=Gs[0];js[1]=C+R;Ys[1]=js[1]}var I=null;if(c!==0){var P=i+o;var b=n+a;I=w(Ns,P,b,1,1,c,-P,-b);S(Ns,ks);S(Ns,Gs);S(Ns,js);S(Ns,Ys);W(Math.min(ks[0],Gs[0],js[0],Ys[0]),Math.min(ks[1],Gs[1],js[1],Ys[1]),Math.max(ks[0],Gs[0],js[0],Ys[0]),Math.max(ks[1],Gs[1],js[1],Ys[1]),Fs)}else{W(O,C,O+T,C+R,Fs)}var L=0;var A=0;if(s){var M=this.renderBuffer_;M[0]=Math.max(M[0],ft(Fs));L=M[0];M[1]=Math.max(M[1],st(Fs));A=M[1]}var D=t.canvas;var F=y?y[2]*p[0]/2:0;var N=Fs[0]-F<=(D.width+L)/e&&Fs[2]+F>=-L/e&&Fs[1]-F<=(D.height+A)/e&&Fs[3]+F>=-A/e;if(d){i=Math.round(i);n=Math.round(n)}if(s){if(!N&&s[0]==1){return false}var k=N?[t,I?I.slice(0):null,l,r,h,f,x,E,i,n,p,Fs.slice()]:null;if(k){if(m){k.push(g,y,ks.slice(0),Gs.slice(0),js.slice(0),Ys.slice(0))}s.push(k)}}else if(N){if(m){this.replayTextBackground_(t,ks,Gs,js,Ys,g,y,false)}si(t,I,l,r,h,f,x,E,i,n,p)}return true};t.prototype.fill_=function(t){if(this.alignFill_){var e=S(this.renderedTransform_,[0,0]);var i=512*this.pixelRatio;t.save();t.translate(e[0]%i,e[1]%i);t.rotate(this.viewRotation_)}t.fill();if(this.alignFill_){t.restore()}};t.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1];t.lineWidth=e[2];t.lineCap=e[3];t.lineJoin=e[4];t.miterLimit=e[5];if(t.setLineDash){t.lineDashOffset=e[7];t.setLineDash(e[6])}};t.prototype.renderDeclutter=function(t,e,i,n){var r=[];for(var o=1,a=t.length;o<a;++o){var s=t[o];var u=s[11];r.push({minX:u[0],minY:u[1],maxX:u[2],maxY:u[3],value:e})}if(!n){n=new Ms(9)}var l=false;for(var o=0,a=r.length;o<a;++o){if(n.collides(r[o])){l=true;break}}if(!l){n.load(r);for(var h=1,f=t.length;h<f;++h){var s=t[h];var c=s[0];var p=c.globalAlpha;if(p!==i){c.globalAlpha=i}if(s.length>12){this.replayTextBackground_(s[0],s[14],s[15],s[16],s[17],s[12],s[13],true)}si.apply(undefined,s);if(p!==i){c.globalAlpha=p}}}t.length=1;return n};t.prototype.drawLabelWithPointPlacement_=function(t,e,i,n){var r=this.textStates[e];var o=this.createLabel(t,e,n,i);var a=this.strokeStates[i];var s=this.pixelRatio;var u=Ts[r.textAlign||Ze];var l=Ts[r.textBaseline||Ue];var h=a&&a.lineWidth?a.lineWidth:0;var f=o.width/s-2*r.scale[0];var c=u*f+2*(.5-u)*h;var p=l*o.height/s+2*(.5-l)*h;return{label:o,anchorX:c,anchorY:p}};t.prototype.execute_=function(t,e,i,n,r,o,a){this.declutterItems.length=0;var s;if(this.pixelCoordinates_&&l(i,this.renderedTransform_)){s=this.pixelCoordinates_}else{if(!this.pixelCoordinates_){this.pixelCoordinates_=[]}s=fi(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_);C(this.renderedTransform_,i)}var u=0;var h=n.length;var f=0;var c;var p,d,v,_,g,y,m,x,E,T,R;var O,S;var I=0;var w=0;var P=null;var b=null;var L=this.coordinateCache_;var A=this.viewRotation_;var M=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12;var D={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:A};var F=this.instructions!=n||this.overlaps?0:200;var N;var k,G;while(u<h){var j=n[u];var Y=j[0];switch(Y){case as.BEGIN_GEOMETRY:N=j[1];if(!N.getGeometry()){u=j[2]}else if(a!==undefined&&!ct(a,j[3])){u=j[2]+1}else{++u}break;case as.BEGIN_PATH:if(I>F){this.fill_(t);I=0}if(w>F){t.stroke();w=0}if(!I&&!w){t.beginPath();v=NaN;_=NaN}++u;break;case as.CIRCLE:f=j[1];var z=s[f];var X=s[f+1];var W=s[f+2];var K=s[f+3];var Z=W-z;var U=K-X;var B=Math.sqrt(Z*Z+U*U);t.moveTo(z+B,X);t.arc(z,X,B,0,2*Math.PI,true);++u;break;case as.CLOSE_PATH:t.closePath();++u;break;case as.CUSTOM:f=j[1];c=j[2];var V=j[3];var H=j[4];var q=j.length==6?j[5]:undefined;D.geometry=V;D.feature=N;if(!(u in L)){L[u]=[]}var J=L[u];if(q){q(s,f,c,2,J)}else{J[0]=s[f];J[1]=s[f+1];J.length=2}H(J,D);++u;break;case as.DRAW_IMAGE:f=j[1];c=j[2];E=j[3];p=j[4];d=j[5];x=o?null:j[6];var Q=j[7];var $=j[8];var tt=j[9];var et=j[10];var it=j[11];var nt=j[12];var rt=j[13];var ot=j[14];if(!E&&j.length>=19){T=j[18];R=j[19];O=j[20];S=j[21];var at=this.drawLabelWithPointPlacement_(T,R,O,S);E=at.label;j[3]=E;var st=j[22];p=(at.anchorX-st)*this.pixelRatio;j[4]=p;var ut=j[23];d=(at.anchorY-ut)*this.pixelRatio;j[5]=d;Q=E.height;j[7]=Q;ot=E.width;j[14]=ot}var lt=void 0;if(j.length>24){lt=j[24]}var ht=void 0,ft=void 0,pt=void 0;if(j.length>16){ht=j[15];ft=j[16];pt=j[17]}else{ht=Be;ft=false;pt=false}if(it&&M){nt+=A}else if(!it&&!M){nt-=A}var dt=0;var vt=0;for(;f<c;f+=2){if(lt&&lt[dt++]<ot/this.pixelRatio){continue}if(x){var _t=Math.floor(vt);m=x.length<_t+1?[x[0][0]]:x[_t]}var gt=this.replayImageOrLabel_(t,e,s[f],s[f+1],E,p,d,m,Q,$,tt,et,nt,rt,r,ot,ht,ft?P:null,pt?b:null);if(gt&&m&&x[x.length-1]!==m){x.push(m)}if(m){if(m.length-1===m[0]){this.declutterItems.push(this,m,N)}vt+=1/m[0]}}++u;break;case as.DRAW_CHARS:var yt=j[1];var mt=j[2];var xt=j[3];m=o?null:j[4];var Et=j[5];S=j[6];var Tt=j[7];var Rt=j[8];var Ot=j[9];O=j[10];var Ct=j[11];T=j[12];R=j[13];var St=[j[14],j[14]];var It=this.textStates[R];var wt=It.font;var Pt=[It.scale[0]*Rt,It.scale[1]*Rt];var bt=void 0;if(wt in this.widths_){bt=this.widths_[wt]}else{bt={};this.widths_[wt]=bt}var Lt=Ka(s,yt,mt,2);var At=Math.abs(Pt[0])*ri(wt,T,bt);if(Et||At<=Lt){var Mt=this.textStates[R].textAlign;var Dt=(Lt-At)*Ts[Mt];var Ft=Ds(s,yt,mt,2,T,Dt,Tt,Math.abs(Pt[0]),ri,wt,bt,M?0:this.viewRotation_);if(Ft){var gt=false;var Nt=void 0,kt=void 0,Gt=void 0,jt=void 0,Yt=void 0;if(O){for(Nt=0,kt=Ft.length;Nt<kt;++Nt){Yt=Ft[Nt];Gt=Yt[4];jt=this.createLabel(Gt,R,"",O);p=Yt[2]+Ct;d=xt*jt.height+(.5-xt)*2*Ct*Pt[1]/Pt[0]-Ot;gt=this.replayImageOrLabel_(t,e,Yt[0],Yt[1],jt,p,d,m,jt.height,1,0,0,Yt[3],St,false,jt.width,Be,null,null)||gt}}if(S){for(Nt=0,kt=Ft.length;Nt<kt;++Nt){Yt=Ft[Nt];Gt=Yt[4];jt=this.createLabel(Gt,R,S,"");p=Yt[2];d=xt*jt.height-Ot;gt=this.replayImageOrLabel_(t,e,Yt[0],Yt[1],jt,p,d,m,jt.height,1,0,0,Yt[3],St,false,jt.width,Be,null,null)||gt}}if(gt){this.declutterItems.push(this,m,N)}}}++u;break;case as.END_GEOMETRY:if(o!==undefined){N=j[1];var zt=o(N);if(zt){return zt}}++u;break;case as.FILL:if(F){I++}else{this.fill_(t)}++u;break;case as.MOVE_TO_LINE_TO:f=j[1];c=j[2];k=s[f];G=s[f+1];g=k+.5|0;y=G+.5|0;if(g!==v||y!==_){t.moveTo(k,G);v=g;_=y}for(f+=2;f<c;f+=2){k=s[f];G=s[f+1];g=k+.5|0;y=G+.5|0;if(f==c-2||g!==v||y!==_){t.lineTo(k,G);v=g;_=y}}++u;break;case as.SET_FILL_STYLE:P=j;this.alignFill_=j[2];if(I){this.fill_(t);I=0;if(w){t.stroke();w=0}}t.fillStyle=j[1];++u;break;case as.SET_STROKE_STYLE:b=j;if(w){t.stroke();w=0}this.setStrokeStyle_(t,j);++u;break;case as.STROKE:if(F){w++}else{t.stroke()}++u;break;default:++u;break}}if(I){this.fill_(t)}if(w){t.stroke()}return undefined};t.prototype.execute=function(t,e,i,n,r){this.viewRotation_=n;this.execute_(t,e,i,this.instructions,r,undefined,undefined)};t.prototype.executeHitDetection=function(t,e,i,n,r){this.viewRotation_=i;return this.execute_(t,1,e,this.hitDetectionInstructions,true,n,r)};return t}();var Xs=[Sn.POLYGON,Sn.CIRCLE,Sn.LINE_STRING,Sn.IMAGE,Sn.TEXT,Sn.DEFAULT];var Ws=function(){function t(t,e,i,n,r,o){this.maxExtent_=t;this.overlaps_=n;this.pixelRatio_=i;this.resolution_=e;this.renderBuffer_=o;this.executorsByZIndex_={};this.hitDetectionContext_=null;this.hitDetectionTransform_=R();this.createExecutors_(r)}t.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath();t.moveTo(i[0],i[1]);t.lineTo(i[2],i[3]);t.lineTo(i[4],i[5]);t.lineTo(i[6],i[7]);t.clip()};t.prototype.createExecutors_=function(t){for(var e in t){var i=this.executorsByZIndex_[e];if(i===undefined){i={};this.executorsByZIndex_[e]=i}var n=t[e];var r=[this.renderBuffer_||0,this.renderBuffer_||0];for(var o in n){var a=n[o];i[o]=new zs(this.resolution_,this.pixelRatio_,this.overlaps_,a,r)}}};t.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_){var i=this.executorsByZIndex_[e];for(var n=0,r=t.length;n<r;++n){if(t[n]in i){return true}}}return false};t.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,a){n=Math.round(n);var s=n*2+1;var u=w(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]);if(!this.hitDetectionContext_){this.hitDetectionContext_=Ce(s,s)}var l=this.hitDetectionContext_;if(l.canvas.width!==s||l.canvas.height!==s){l.canvas.width=s;l.canvas.height=s}else{l.clearRect(0,0,s,s)}var h;if(this.renderBuffer_!==undefined){h=X();q(h,t);F(h,e*(this.renderBuffer_+n),h)}var f=Us(n);var c;function p(t){var e=l.getImageData(0,0,s,s).data;for(var i=0;i<s;i++){for(var n=0;n<s;n++){if(f[i][n]){if(e[(n*s+i)*4+3]>0){var o=void 0;if(!(a&&(c==Sn.IMAGE||c==Sn.TEXT))||a.indexOf(t)!==-1){o=r(t)}if(o){return o}else{l.clearRect(0,0,s,s);return undefined}}}}}}var d=Object.keys(this.executorsByZIndex_).map(Number);d.sort(o);var v,_,g,y,m;for(v=d.length-1;v>=0;--v){var x=d[v].toString();g=this.executorsByZIndex_[x];for(_=Xs.length-1;_>=0;--_){c=Xs[_];y=g[c];if(y!==undefined){m=y.executeHitDetection(l,u,i,p,h);if(m){return m}}}}return undefined};t.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e){return null}var i=e[0];var n=e[1];var r=e[2];var o=e[3];var a=[i,n,i,o,r,o,r,n];fi(a,0,8,2,t,a);return a};t.prototype.isEmpty=function(){return Kt(this.executorsByZIndex_)};t.prototype.execute=function(t,e,i,n,r,a,s){var u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(o);if(this.maxExtent_){t.save();this.clip(t,i)}var l=a?a:Xs;var h,f,c,p,d,v;for(h=0,f=u.length;h<f;++h){var _=u[h].toString();d=this.executorsByZIndex_[_];for(c=0,p=l.length;c<p;++c){var g=l[c];v=d[g];if(v!==undefined){if(s&&(g==Sn.IMAGE||g==Sn.TEXT)){var y=s[_];if(!y){s[_]=[v,i.slice(0)]}else{y.push(v,i.slice(0))}}else{v.execute(t,e,i,n,r)}}}}if(this.maxExtent_){t.restore()}};return t}();var Ks={0:[[true]]};function Zs(t,e,i){var n;var r=Math.floor(t.length/2);if(e>=r){for(n=r;n<e;n++){t[n][i]=true}}else if(e<r){for(n=e+1;n<r;n++){t[n][i]=true}}}function Us(t){if(Ks[t]!==undefined){return Ks[t]}var e=t*2+1;var i=new Array(e);for(var n=0;n<e;n++){i[n]=new Array(e)}var r=t;var o=0;var a=0;while(r>=o){Zs(i,t+r,t+o);Zs(i,t+o,t+r);Zs(i,t-o,t+r);Zs(i,t-r,t+o);Zs(i,t-r,t-o);Zs(i,t-o,t-r);Zs(i,t+o,t-r);Zs(i,t+r,t-o);o++;a+=1+2*o;if(2*(a-r)+1>0){r-=1;a+=1-2*r}}Ks[t]=i;return i}function Bs(t,e,i,n,r,a){var s=Object.keys(t).map(Number).sort(o);for(var u=0,l=s.length;u<l;++u){var h=t[s[u].toString()];var f=void 0;for(var c=0,p=h.length;c<p;){var d=h[c++];var v=h[c++];d.execute(e,1,v,i,r);if(d!==f&&d.declutterItems.length>0){f=d;a.push({items:d.declutterItems,opacity:n})}}}}var Vs={FRACTION:"fraction",PIXELS:"pixels"};var Hs={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};var qs=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Js=function(t){qs(e,t);function e(e,i,n,r){var o=t.call(this)||this;o.extent=e;o.pixelRatio_=n;o.resolution=i;o.state=r;return o}e.prototype.changed=function(){this.dispatchEvent(Bt.CHANGE)};e.prototype.getExtent=function(){return this.extent};e.prototype.getImage=function(){return v()};e.prototype.getPixelRatio=function(){return this.pixelRatio_};e.prototype.getResolution=function(){return this.resolution};e.prototype.getState=function(){return this.state};e.prototype.load=function(){v()};return e}(Ut);var Qs=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var $s=function(t){Qs(e,t);function e(e,i,n,r,o,a){var s=t.call(this,e,i,n,In.IDLE)||this;s.src_=r;s.image_=new Image;if(o!==null){s.image_.crossOrigin=o}s.unlisten_=null;s.state=In.IDLE;s.imageLoadFunction_=a;return s}e.prototype.getImage=function(){return this.image_};e.prototype.handleImageError_=function(){this.state=In.ERROR;this.unlistenImage_();this.changed()};e.prototype.handleImageLoad_=function(){if(this.resolution===undefined){this.resolution=st(this.extent)/this.image_.height}this.state=In.LOADED;this.unlistenImage_();this.changed()};e.prototype.load=function(){if(this.state==In.IDLE||this.state==In.ERROR){this.state=In.LOADING;this.changed();this.imageLoadFunction_(this,this.src_);this.unlisten_=tu(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}};e.prototype.setImage=function(t){this.image_=t};e.prototype.unlistenImage_=function(){if(this.unlisten_){this.unlisten_();this.unlisten_=null}};return e}(Js);function tu(t,e,i){var n=t;if(n.src&&Re){var r=n.decode();var o=true;var a=function(){o=false};r.then((function(){if(o){e()}})).catch((function(t){if(o){if(t.name==="EncodingError"&&t.message==="Invalid image type."){e()}else{i()}}}));return a}var s=[Ht(n,Bt.LOAD,e),Ht(n,Bt.ERROR,i)];return function t(){s.forEach(qt)}}var eu=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var iu=null;var nu=function(t){eu(e,t);function e(e,i,n,r,o,a){var s=t.call(this)||this;s.hitDetectionImage_=null;s.image_=!e?new Image:e;if(r!==null){s.image_.crossOrigin=r}s.canvas_={};s.color_=a;s.unlisten_=null;s.imageState_=o;s.size_=n;s.src_=i;return s}e.prototype.isTainted_=function(){if(this.tainted_===undefined&&this.imageState_===In.LOADED){if(!iu){iu=Ce(1,1)}iu.drawImage(this.image_,0,0);try{iu.getImageData(0,0,1,1);this.tainted_=false}catch(t){iu=null;this.tainted_=true}}return this.tainted_===true};e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(Bt.CHANGE)};e.prototype.handleImageError_=function(){this.imageState_=In.ERROR;this.unlistenImage_();this.dispatchChangeEvent_()};e.prototype.handleImageLoad_=function(){this.imageState_=In.LOADED;if(this.size_){this.image_.width=this.size_[0];this.image_.height=this.size_[1]}else{this.size_=[this.image_.width,this.image_.height]}this.unlistenImage_();this.dispatchChangeEvent_()};e.prototype.getImage=function(t){this.replaceColor_(t);return this.canvas_[t]?this.canvas_[t]:this.image_};e.prototype.getPixelRatio=function(t){this.replaceColor_(t);return this.canvas_[t]?t:1};e.prototype.getImageState=function(){return this.imageState_};e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_){if(this.isTainted_()){var t=this.size_[0];var e=this.size_[1];var i=Ce(t,e);i.fillRect(0,0,t,e);this.hitDetectionImage_=i.canvas}else{this.hitDetectionImage_=this.image_}}return this.hitDetectionImage_};e.prototype.getSize=function(){return this.size_};e.prototype.getSrc=function(){return this.src_};e.prototype.load=function(){if(this.imageState_==In.IDLE){this.imageState_=In.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=tu(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}};e.prototype.replaceColor_=function(t){if(!this.color_||this.canvas_[t]){return}var e=document.createElement("canvas");this.canvas_[t]=e;e.width=Math.ceil(this.image_.width*t);e.height=Math.ceil(this.image_.height*t);var i=e.getContext("2d");i.scale(t,t);i.drawImage(this.image_,0,0);if(this.isTainted_()){var n=this.color_;i.globalCompositeOperation="multiply";i.fillStyle="rgb("+n[0]+","+n[1]+","+n[2]+")";i.fillRect(0,0,e.width,e.height);i.globalCompositeOperation="destination-in";i.drawImage(this.image_,0,0);return}var r=i.getImageData(0,0,e.width,e.height);var o=r.data;var a=this.color_[0]/255;var s=this.color_[1]/255;var u=this.color_[2]/255;for(var l=0,h=o.length;l<h;l+=4){o[l]*=a;o[l+1]*=s;o[l+2]*=u}i.putImageData(r,0,0)};e.prototype.unlistenImage_=function(){if(this.unlisten_){this.unlisten_();this.unlisten_=null}};return e}(Ut);function ru(t,e,i,n,r,o){var a=Gt.get(e,n,o);if(!a){a=new nu(t,e,i,n,r,o);Gt.set(e,n,o,a)}return a}var ou=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var au=function(t){ou(e,t);function e(e){var i=this;var n=e||{};var r=n.opacity!==undefined?n.opacity:1;var o=n.rotation!==undefined?n.rotation:0;var a=n.scale!==undefined?n.scale:1;var s=n.rotateWithView!==undefined?n.rotateWithView:false;i=t.call(this,{opacity:r,rotation:o,scale:a,displacement:n.displacement!==undefined?n.displacement:[0,0],rotateWithView:s})||this;i.anchor_=n.anchor!==undefined?n.anchor:[.5,.5];i.normalizedAnchor_=null;i.anchorOrigin_=n.anchorOrigin!==undefined?n.anchorOrigin:Hs.TOP_LEFT;i.anchorXUnits_=n.anchorXUnits!==undefined?n.anchorXUnits:Vs.FRACTION;i.anchorYUnits_=n.anchorYUnits!==undefined?n.anchorYUnits:Vs.FRACTION;i.crossOrigin_=n.crossOrigin!==undefined?n.crossOrigin:null;var u=n.img!==undefined?n.img:null;var l=n.imgSize!==undefined?n.imgSize:null;var h=n.src;E(!(h!==undefined&&u),4);E(!u||u&&l,5);if((h===undefined||h.length===0)&&u){h=u.src||g(u)}E(h!==undefined&&h.length>0,6);var f=n.src!==undefined?In.IDLE:In.LOADED;i.color_=n.color!==undefined?At(n.color):null;i.iconImage_=ru(u,h,l,i.crossOrigin_,f,i.color_);i.offset_=n.offset!==undefined?n.offset:[0,0];i.offsetOrigin_=n.offsetOrigin!==undefined?n.offsetOrigin:Hs.TOP_LEFT;i.origin_=null;i.size_=n.size!==undefined?n.size:null;return i}e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||undefined,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:this.size_!==null?this.size_.slice():undefined,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})};e.prototype.getAnchor=function(){if(this.normalizedAnchor_){return this.normalizedAnchor_}var t=this.anchor_;var e=this.getSize();if(this.anchorXUnits_==Vs.FRACTION||this.anchorYUnits_==Vs.FRACTION){if(!e){return null}t=this.anchor_.slice();if(this.anchorXUnits_==Vs.FRACTION){t[0]*=e[0]}if(this.anchorYUnits_==Vs.FRACTION){t[1]*=e[1]}}if(this.anchorOrigin_!=Hs.TOP_LEFT){if(!e){return null}if(t===this.anchor_){t=this.anchor_.slice()}if(this.anchorOrigin_==Hs.TOP_RIGHT||this.anchorOrigin_==Hs.BOTTOM_RIGHT){t[0]=-t[0]+e[0]}if(this.anchorOrigin_==Hs.BOTTOM_LEFT||this.anchorOrigin_==Hs.BOTTOM_RIGHT){t[1]=-t[1]+e[1]}}this.normalizedAnchor_=t;return this.normalizedAnchor_};e.prototype.setAnchor=function(t){this.anchor_=t;this.normalizedAnchor_=null};e.prototype.getColor=function(){return this.color_};e.prototype.getImage=function(t){return this.iconImage_.getImage(t)};e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)};e.prototype.getImageSize=function(){return this.iconImage_.getSize()};e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()};e.prototype.getImageState=function(){return this.iconImage_.getImageState()};e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()};e.prototype.getOrigin=function(){if(this.origin_){return this.origin_}var t=this.offset_;var e=this.getDisplacement();if(this.offsetOrigin_!=Hs.TOP_LEFT){var i=this.getSize();var n=this.iconImage_.getSize();if(!i||!n){return null}t=t.slice();if(this.offsetOrigin_==Hs.TOP_RIGHT||this.offsetOrigin_==Hs.BOTTOM_RIGHT){t[0]=n[0]-i[0]-t[0]}if(this.offsetOrigin_==Hs.BOTTOM_LEFT||this.offsetOrigin_==Hs.BOTTOM_RIGHT){t[1]=n[1]-i[1]-t[1]}}t[0]+=e[0];t[1]+=e[1];this.origin_=t;return this.origin_};e.prototype.getSrc=function(){return this.iconImage_.getSrc()};e.prototype.getSize=function(){return!this.size_?this.iconImage_.getSize():this.size_};e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(Bt.CHANGE,t)};e.prototype.load=function(){this.iconImage_.load()};e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(Bt.CHANGE,t)};return e}(Za);function su(t,e,i,n,r,a,s){var u=t[0]/2;var l=t[1]/2;var h=Ce(u,l);h.imageSmoothingEnabled=false;var f=h.canvas;var c=new Cn(h,.5,r,null,s);var p=i.length;var d=Math.floor((256*256*256-1)/p);var v={};for(var _=1;_<=p;++_){var g=i[_-1];var y=g.getStyleFunction()||n;if(!n){continue}var m=y(g,a);if(!m){continue}if(!Array.isArray(m)){m=[m]}var x=_*d;var E="#"+("000000"+x.toString(16)).slice(-6);for(var T=0,R=m.length;T<R;++T){var O=m[T];var C=O.clone();var S=C.getFill();if(S){S.setColor(E)}var I=C.getStroke();if(I){I.setColor(E)}C.setText(undefined);var w=O.getImage();if(w){var P=w.getImageSize();if(!P){continue}var b=document.createElement("canvas");b.width=P[0];b.height=P[1];var L=b.getContext("2d",{alpha:false});L.fillStyle=E;var A=L.canvas;L.fillRect(0,0,A.width,A.height);var M=P?P[0]:A.width;var D=P?P[1]:A.height;var F=Ce(M,D);F.drawImage(A,0,0);C.setImage(new au({img:A,imgSize:P,anchor:w.getAnchor(),anchorXUnits:Vs.PIXELS,anchorYUnits:Vs.PIXELS,offset:w.getOrigin(),size:w.getSize(),opacity:w.getOpacity(),scale:w.getScale(),rotation:w.getRotation(),rotateWithView:w.getRotateWithView()}))}var N=Number(C.getZIndex());var k=v[N];if(!k){k={};v[N]=k;k[pe.POLYGON]=[];k[pe.CIRCLE]=[];k[pe.LINE_STRING]=[];k[pe.POINT]=[]}var G=C.getGeometryFunction()(g);if(G&&ct(r,G.getExtent())){k[G.getType().replace("Multi","")].push(G,C)}}}var j=Object.keys(v).map(Number).sort(o);for(var _=0,Y=j.length;_<Y;++_){var k=v[j[_]];for(var z in k){var X=k[z];for(var T=0,R=X.length;T<R;T+=2){c.setStyle(X[T+1]);for(var W=0,K=e.length;W<K;++W){c.setTransform(e[W]);c.drawGeometry(X[T])}}}}return h.getImageData(0,0,f.width,f.height)}function uu(t,e,i){var n=[];if(i){var r=(Math.round(t[0]/2)+Math.round(t[1]/2)*i.width)*4;var o=i.data[r];var a=i.data[r+1];var s=i.data[r+2];var u=s+256*(a+256*o);var l=Math.floor((256*256*256-1)/e.length);if(u&&u%l===0){n.push(e[u/l-1])}}return n}var lu=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var hu=function(t){lu(e,t);function e(e){var i=t.call(this,e)||this;i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i);i.dirty_=false;i.hitDetectionImageData_=null;i.renderedFeatures_=null;i.renderedRevision_=-1;i.renderedResolution_=NaN;i.renderedExtent_=X();i.renderedCenter_=null;i.renderedProjection_=null;i.renderedRenderOrder_=null;i.replayGroup_=null;i.replayGroupChanged=true;i.clipping=true;return i}e.prototype.useContainer=function(e,i,n){if(n<1){e=null}t.prototype.useContainer.call(this,e,i,n)};e.prototype.renderFrame=function(t,e){var i=t.pixelRatio;var n=t.layerStatesArray[t.layerIndex];I(this.pixelTransform,1/i,1/i);P(this.inversePixelTransform,this.pixelTransform);var r=L(this.pixelTransform);this.useContainer(e,r,n.opacity);var o=this.context;var a=o.canvas;var s=this.replayGroup_;if(!s||s.isEmpty()){if(!this.containerReused&&a.width>0){a.width=0}return this.container}var u=Math.round(t.size[0]*i);var l=Math.round(t.size[1]*i);if(a.width!=u||a.height!=l){a.width=u;a.height=l;if(a.style.transform!==r){a.style.transform=r}}else if(!this.containerReused){o.clearRect(0,0,u,l)}this.preRender(o,t);var h=t.extent;var f=t.viewState;var c=f.center;var p=f.resolution;var d=f.projection;var v=f.rotation;var _=d.getExtent();var g=this.getLayer().getSource();var y=false;if(n.extent&&this.clipping){var m=pn(n.extent);y=!j(m,t.extent)&&ct(m,t.extent);if(y){this.clipUnrotated(o,t,m)}}var x=t.viewHints;var E=!(x[Tr.ANIMATING]||x[Tr.INTERACTING]);var T=this.getRenderTransform(c,p,v,i,u,l,0);var R=this.getLayer().getDeclutter()?{}:null;s.execute(o,1,T,v,E,undefined,R);if(g.getWrapX()&&d.canWrapX()&&!j(_,h)){var O=h[0];var C=ft(_);var S=0;var w=void 0;while(O<_[0]){--S;w=C*S;var b=this.getRenderTransform(c,p,v,i,u,l,w);s.execute(o,1,b,v,E,undefined,R);O+=C}S=0;O=h[2];while(O>_[2]){++S;w=C*S;var A=this.getRenderTransform(c,p,v,i,u,l,w);s.execute(o,1,A,v,E,undefined,R);O-=C}}if(R){var M=t.viewHints;var D=!(M[Tr.ANIMATING]||M[Tr.INTERACTING]);Bs(R,o,v,1,D,t.declutterItems)}if(y){o.restore()}this.postRender(o,t);var F=n.opacity;var N=this.container;if(F!==parseFloat(N.style.opacity)){N.style.opacity=F===1?"":String(F)}if(this.renderedRotation_!==f.rotation){this.renderedRotation_=f.rotation;this.hitDetectionImageData_=null}return this.container};e.prototype.getFeatures=function(t){return new Promise(function(e,i){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var n=[this.context.canvas.width,this.context.canvas.height];S(this.pixelTransform,n);var r=this.renderedCenter_;var o=this.renderedResolution_;var a=this.renderedRotation_;var s=this.renderedProjection_;var u=this.renderedExtent_;var l=this.getLayer();var h=[];var f=n[0]/2;var c=n[1]/2;h.push(this.getRenderTransform(r,o,a,.5,f,c,0).slice());var p=l.getSource();var d=s.getExtent();if(p.getWrapX()&&s.canWrapX()&&!j(d,u)){var v=u[0];var _=ft(d);var g=0;var y=void 0;while(v<d[0]){--g;y=_*g;h.push(this.getRenderTransform(r,o,a,.5,f,c,y).slice());v+=_}g=0;v=u[2];while(v>d[2]){++g;y=_*g;h.push(this.getRenderTransform(r,o,a,.5,f,c,y).slice());v-=_}}this.hitDetectionImageData_=su(n,h,this.renderedFeatures_,l.getStyleFunction(),u,o,a)}e(uu(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))};e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){if(!this.replayGroup_){return undefined}else{var o=e.viewState.resolution;var a=e.viewState.rotation;var s=this.getLayer();var u={};var l=this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,i,(function(t){var e=g(t);if(!(e in u)){u[e]=true;return n(t,s)}}),s.getDeclutter()?r:null);return l}};e.prototype.handleFontsChanged=function(){var t=this.getLayer();if(t.getVisible()&&this.replayGroup_){t.changed()}};e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()};e.prototype.prepareFrame=function(t){var e=this.getLayer();var i=e.getSource();if(!i){return false}var n=t.viewHints[Tr.ANIMATING];var r=t.viewHints[Tr.INTERACTING];var o=e.getUpdateWhileAnimating();var a=e.getUpdateWhileInteracting();if(!this.dirty_&&!o&&n||!a&&r){this.animatingOrInteracting_=true;return true}this.animatingOrInteracting_=false;var s=t.extent;var u=t.viewState;var l=u.projection;var h=u.resolution;var f=t.pixelRatio;var c=e.getRevision();var p=e.getRenderBuffer();var d=e.getRenderOrder();if(d===undefined){d=bn}var v=u.center.slice();var _=F(s,p*h);var g=[_.slice()];var y=l.getExtent();if(i.getWrapX()&&l.canWrapX()&&!j(y,t.extent)){var m=ft(y);var x=Math.max(ft(_)/2,m);_[0]=y[0]-x;_[2]=y[2]+x;Zi(v,l);var E=gt(g[0],l);if(E[0]<y[0]&&E[2]<y[2]){g.push([E[0]+m,E[1],E[2]+m,E[3]])}else if(E[0]>y[0]&&E[2]>y[2]){g.push([E[0]-m,E[1],E[2]-m,E[3]])}}if(!this.dirty_&&this.renderedResolution_==h&&this.renderedRevision_==c&&this.renderedRenderOrder_==d&&j(this.renderedExtent_,_)){this.replayGroupChanged=false;return true}this.replayGroup_=null;this.dirty_=false;var T=new Cs(An(h,f),_,h,f,e.getDeclutter());var R;var O,C;{for(var O=0,C=g.length;O<C;++O){i.loadFeatures(g[O],h,l)}}var S=Ln(h,f);var I=function(t){var i;var n=t.getStyleFunction()||e.getStyleFunction();if(n){i=n(t,h)}if(i){var r=this.renderFeature(t,S,i,T,R);this.dirty_=this.dirty_||r}}.bind(this);var w=cn(_);var P=i.getFeaturesInExtent(w);if(d){P.sort(d)}for(var O=0,C=P.length;O<C;++O){I(P[O])}this.renderedFeatures_=P;var b=T.finish();var L=new Ws(_,h,f,i.getOverlaps(),b,e.getRenderBuffer());this.renderedResolution_=h;this.renderedRevision_=c;this.renderedRenderOrder_=d;this.renderedExtent_=_;this.renderedCenter_=v;this.renderedProjection_=l;this.replayGroup_=L;this.hitDetectionImageData_=null;this.replayGroupChanged=true;return true};e.prototype.renderFeature=function(t,e,i,n,r){if(!i){return false}var o=false;if(Array.isArray(i)){for(var a=0,s=i.length;a<s;++a){o=Dn(n,t,i[a],e,this.boundHandleStyleImageChange_,r)||o}}else{o=Dn(n,t,i,e,this.boundHandleStyleImageChange_,r)}return o};return e}(Ps);var fu=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var cu=function(t){fu(e,t);function e(e){return t.call(this,e)||this}e.prototype.createRenderer=function(){return new hu(this)};return e}(os);var pu=function(){function t(t){this.rbush_=new Ms(t);this.items_={}}t.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i);this.items_[g(e)]=i};t.prototype.load=function(t,e){var i=new Array(e.length);for(var n=0,r=e.length;n<r;n++){var o=t[n];var a=e[n];var s={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[n]=s;this.items_[g(a)]=s}this.rbush_.load(i)};t.prototype.remove=function(t){var e=g(t);var i=this.items_[e];delete this.items_[e];return this.rbush_.remove(i)!==null};t.prototype.update=function(t,e){var i=this.items_[g(e)];var n=[i.minX,i.minY,i.maxX,i.maxY];if(!V(n,t)){this.remove(e);this.insert(t,e)}};t.prototype.getAll=function(){var t=this.rbush_.all();return t.map((function(t){return t.value}))};t.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};var i=this.rbush_.search(e);return i.map((function(t){return t.value}))};t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)};t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)};t.prototype.forEach_=function(t,e){var i;for(var n=0,r=t.length;n<r;n++){i=e(t[n]);if(i){return i}}return i};t.prototype.isEmpty=function(){return Kt(this.items_)};t.prototype.clear=function(){this.rbush_.clear();this.items_={}};t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return W(e.minX,e.minY,e.maxX,e.maxY,t)};t.prototype.concat=function(t){this.rbush_.load(t.rbush_.all());for(var e in t.items_){this.items_[e]=t.items_[e]}};return t}();var du=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var vu=function(t){du(e,t);function e(e){var i=t.call(this)||this;i.projection_=Ji(e.projection);i.attributions_=_u(e.attributions);i.attributionsCollapsible_=e.attributionsCollapsible!==undefined?e.attributionsCollapsible:true;i.loading=false;i.state_=e.state!==undefined?e.state:le.READY;i.wrapX_=e.wrapX!==undefined?e.wrapX:false;return i}e.prototype.getAttributions=function(){return this.attributions_};e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_};e.prototype.getProjection=function(){return this.projection_};e.prototype.getResolutions=function(){return v()};e.prototype.getState=function(){return this.state_};e.prototype.getWrapX=function(){return this.wrapX_};e.prototype.getContextOptions=function(){return undefined};e.prototype.refresh=function(){this.changed()};e.prototype.setAttributions=function(t){this.attributions_=_u(t);this.changed()};e.prototype.setState=function(t){this.state_=t;this.changed()};return e}(ie);function _u(t){if(!t){return null}if(Array.isArray(t)){return function(e){return t}}if(typeof t==="function"){return t}return function(e){return[t]}}var gu={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};function yu(t,e){return[[-Infinity,-Infinity,Infinity,Infinity]]}var mu={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};var xu=false;function Eu(t,e,i,n){return function(r,o,a){var s=new XMLHttpRequest;s.open("GET",typeof t==="function"?t(r,o,a):t,true);if(e.getType()==mu.ARRAY_BUFFER){s.responseType="arraybuffer"}s.withCredentials=xu;s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var o=e.getType();var u=void 0;if(o==mu.JSON||o==mu.TEXT){u=s.responseText}else if(o==mu.XML){u=s.responseXML;if(!u){u=(new DOMParser).parseFromString(s.responseText,"application/xml")}}else if(o==mu.ARRAY_BUFFER){u=s.response}if(u){i.call(this,e.readFeatures(u,{extent:r,featureProjection:a}),e.readProjection(u))}else{n.call(this)}}else{n.call(this)}}.bind(this);s.onerror=function(){n.call(this)}.bind(this);s.send()}}function Tu(t,e){return Eu(t,e,(function(t,e){var i=this;if(typeof i.addFeatures==="function"){i.addFeatures(t)}}),p)}var Ru=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ou=function(t){Ru(e,t);function e(e,i){var n=t.call(this,e)||this;n.feature=i;return n}return e}(jt);var Cu=function(t){Ru(e,t);function e(e){var i=this;var n=e||{};i=t.call(this,{attributions:n.attributions,projection:undefined,state:le.READY,wrapX:n.wrapX!==undefined?n.wrapX:true})||this;i.loader_=p;i.format_=n.format;i.overlaps_=n.overlaps===undefined?true:n.overlaps;i.url_=n.url;if(n.loader!==undefined){i.loader_=n.loader}else if(i.url_!==undefined){E(i.format_,7);i.loader_=Tu(i.url_,i.format_)}i.strategy_=n.strategy!==undefined?n.strategy:yu;var r=n.useSpatialIndex!==undefined?n.useSpatialIndex:true;i.featuresRtree_=r?new pu:null;i.loadedExtentsRtree_=new pu;i.nullGeometryFeatures_={};i.idIndex_={};i.uidIndex_={};i.featureChangeKeys_={};i.featuresCollection_=null;var o,a;if(Array.isArray(n.features)){a=n.features}else if(n.features){o=n.features;a=o.getArray()}if(!r&&o===undefined){o=new ir(a)}if(a!==undefined){i.addFeaturesInternal(a)}if(o!==undefined){i.bindFeaturesCollection_(o)}return i}e.prototype.addFeature=function(t){this.addFeatureInternal(t);this.changed()};e.prototype.addFeatureInternal=function(t){var e=g(t);if(!this.addToIndex_(e,t)){if(this.featuresCollection_){this.featuresCollection_.remove(t)}return}this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();if(this.featuresRtree_){this.featuresRtree_.insert(n,t)}}else{this.nullGeometryFeatures_[e]=t}this.dispatchEvent(new Ou(gu.ADDFEATURE,t))};e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Vt(e,Bt.CHANGE,this.handleFeatureChange_,this),Vt(e,Yt.PROPERTYCHANGE,this.handleFeatureChange_,this)]};e.prototype.addToIndex_=function(t,e){var i=true;var n=e.getId();if(n!==undefined){if(!(n.toString()in this.idIndex_)){this.idIndex_[n.toString()]=e}else{i=false}}if(i){E(!(t in this.uidIndex_),30);this.uidIndex_[t]=e}return i};e.prototype.addFeatures=function(t){this.addFeaturesInternal(t);this.changed()};e.prototype.addFeaturesInternal=function(t){var e=[];var i=[];var n=[];for(var r=0,o=t.length;r<o;r++){var a=t[r];var s=g(a);if(this.addToIndex_(s,a)){i.push(a)}}for(var r=0,u=i.length;r<u;r++){var a=i[r];var s=g(a);this.setupChangeEvents_(s,a);var l=a.getGeometry();if(l){var h=l.getExtent();e.push(h);n.push(a)}else{this.nullGeometryFeatures_[s]=a}}if(this.featuresRtree_){this.featuresRtree_.load(e,n)}for(var r=0,f=i.length;r<f;r++){this.dispatchEvent(new Ou(gu.ADDFEATURE,i[r]))}};e.prototype.bindFeaturesCollection_=function(t){var e=false;this.addEventListener(gu.ADDFEATURE,(function(i){if(!e){e=true;t.push(i.feature);e=false}}));this.addEventListener(gu.REMOVEFEATURE,(function(i){if(!e){e=true;t.remove(i.feature);e=false}}));t.addEventListener(Qn.ADD,function(t){if(!e){e=true;this.addFeature(t.element);e=false}}.bind(this));t.addEventListener(Qn.REMOVE,function(t){if(!e){e=true;this.removeFeature(t.element);e=false}}.bind(this));this.featuresCollection_=t};e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){var i=this.featureChangeKeys_[e];i.forEach(qt)}if(!this.featuresCollection_){this.featureChangeKeys_={};this.idIndex_={};this.uidIndex_={}}}else{if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this));for(var n in this.nullGeometryFeatures_){this.removeFeatureInternal(this.nullGeometryFeatures_[n])}}}if(this.featuresCollection_){this.featuresCollection_.clear()}if(this.featuresRtree_){this.featuresRtree_.clear()}this.nullGeometryFeatures_={};var r=new Ou(gu.CLEAR);this.dispatchEvent(r);this.changed()};e.prototype.forEachFeature=function(t){if(this.featuresRtree_){return this.featuresRtree_.forEach(t)}else if(this.featuresCollection_){this.featuresCollection_.forEach(t)}};e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){var n=i.getGeometry();if(n.intersectsCoordinate(t)){return e(i)}else{return undefined}}))};e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_){return this.featuresRtree_.forEachInExtent(t,e)}else if(this.featuresCollection_){this.featuresCollection_.forEach(e)}};e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){var n=i.getGeometry();if(n.intersectsExtent(t)){var r=e(i);if(r){return r}}}))};e.prototype.getFeaturesCollection=function(){return this.featuresCollection_};e.prototype.getFeatures=function(){var t;if(this.featuresCollection_){t=this.featuresCollection_.getArray()}else if(this.featuresRtree_){t=this.featuresRtree_.getAll();if(!Kt(this.nullGeometryFeatures_)){u(t,Wt(this.nullGeometryFeatures_))}}return t};e.prototype.getFeaturesAtCoordinate=function(t){var e=[];this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)}));return e};e.prototype.getFeaturesInExtent=function(t){if(this.featuresRtree_){return this.featuresRtree_.getInExtent(t)}else if(this.featuresCollection_){return this.featuresCollection_.getArray()}else{return[]}};e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0];var n=t[1];var r=null;var o=[NaN,NaN];var a=Infinity;var s=[-Infinity,-Infinity,Infinity,Infinity];var u=e?e:f;this.featuresRtree_.forEachInExtent(s,(function(t){if(u(t)){var e=t.getGeometry();var l=a;a=e.closestPointXY(i,n,o,a);if(a<l){r=t;var h=Math.sqrt(a);s[0]=i-h;s[1]=n-h;s[2]=i+h;s[3]=n+h}}}));return r};e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)};e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return e!==undefined?e:null};e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return e!==undefined?e:null};e.prototype.getFormat=function(){return this.format_};e.prototype.getOverlaps=function(){return this.overlaps_};e.prototype.getUrl=function(){return this.url_};e.prototype.handleFeatureChange_=function(t){var e=t.target;var i=g(e);var n=e.getGeometry();if(!n){if(!(i in this.nullGeometryFeatures_)){if(this.featuresRtree_){this.featuresRtree_.remove(e)}this.nullGeometryFeatures_[i]=e}}else{var r=n.getExtent();if(i in this.nullGeometryFeatures_){delete this.nullGeometryFeatures_[i];if(this.featuresRtree_){this.featuresRtree_.insert(r,e)}}else{if(this.featuresRtree_){this.featuresRtree_.update(r,e)}}}var o=e.getId();if(o!==undefined){var a=o.toString();if(this.idIndex_[a]!==e){this.removeFromIdIndex_(e);this.idIndex_[a]=e}}else{this.removeFromIdIndex_(e);this.uidIndex_[i]=e}this.changed();this.dispatchEvent(new Ou(gu.CHANGEFEATURE,e))};e.prototype.hasFeature=function(t){var e=t.getId();if(e!==undefined){return e in this.idIndex_}else{return g(t)in this.uidIndex_}};e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Kt(this.nullGeometryFeatures_)};e.prototype.loadFeatures=function(t,e,i){var n=this.loadedExtentsRtree_;var r=this.strategy_(t,e);this.loading=false;var o=function(t,o){var s=r[t];var u=n.forEachInExtent(s,(function(t){return j(t.extent,s)}));if(!u){a.loader_.call(a,s,e,i);n.insert(s,{extent:s.slice()});a.loading=a.loader_!==p}};var a=this;for(var s=0,u=r.length;s<u;++s){o(s)}};e.prototype.refresh=function(){this.clear(true);this.loadedExtentsRtree_.clear();t.prototype.refresh.call(this)};e.prototype.removeLoadedExtent=function(t){var e=this.loadedExtentsRtree_;var i;e.forEachInExtent(t,(function(e){if(V(e.extent,t)){i=e;return true}}));if(i){e.remove(i)}};e.prototype.removeFeature=function(t){var e=g(t);if(e in this.nullGeometryFeatures_){delete this.nullGeometryFeatures_[e]}else{if(this.featuresRtree_){this.featuresRtree_.remove(t)}}this.removeFeatureInternal(t);this.changed()};e.prototype.removeFeatureInternal=function(t){var e=g(t);this.featureChangeKeys_[e].forEach(qt);delete this.featureChangeKeys_[e];var i=t.getId();if(i!==undefined){delete this.idIndex_[i.toString()]}delete this.uidIndex_[e];this.dispatchEvent(new Ou(gu.REMOVEFEATURE,t))};e.prototype.removeFromIdIndex_=function(t){var e=false;for(var i in this.idIndex_){if(this.idIndex_[i]===t){delete this.idIndex_[i];e=true;break}}return e};e.prototype.setLoader=function(t){this.loader_=t};e.prototype.setUrl=function(t){E(this.format_,7);this.setLoader(Tu(t,this.format_))};return e}(vu);function Su(t){var e=t?t:{};var i=new ir;var n=new Ma(-.005,.05,100);var r=e.altShiftDragRotate!==undefined?e.altShiftDragRotate:true;if(r){i.push(new ma)}var o=e.doubleClickZoom!==undefined?e.doubleClickZoom:true;if(o){i.push(new ta({delta:e.zoomDelta,duration:e.zoomDuration}))}var a=e.dragPan!==undefined?e.dragPan:true;if(a){i.push(new ga({onFocusOnly:e.onFocusOnly,kinetic:n}))}var s=e.pinchRotate!==undefined?e.pinchRotate:true;if(s){i.push(new Ga)}var u=e.pinchZoom!==undefined?e.pinchZoom:true;if(u){i.push(new Ya({duration:e.zoomDuration}))}var l=e.keyboard!==undefined?e.keyboard:true;if(l){i.push(new ba);i.push(new Aa({delta:e.zoomDelta,duration:e.zoomDuration}))}var h=e.mouseWheelZoom!==undefined?e.mouseWheelZoom:true;if(h){i.push(new Na({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}))}var f=e.shiftDragZoom!==undefined?e.shiftDragZoom:true;if(f){i.push(new Ia({duration:e.zoomDuration}))}return i}var Iu=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var wu=function(t){Iu(e,t);function e(e){var i=this;e=zt({},e);if(!e.controls){e.controls=Bo()}if(!e.interactions){e.interactions=Su({onFocusOnly:true})}i=t.call(this,e)||this;return i}e.prototype.createRenderer=function(){return new Jn(this)};return e}(ko);var Pu=.5;var bu=function(){function t(t,e,i,n){this.minX=t;this.maxX=e;this.minY=i;this.maxY=n}t.prototype.contains=function(t){return this.containsXY(t[1],t[2])};t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY};t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY};t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY};t.prototype.extend=function(t){if(t.minX<this.minX){this.minX=t.minX}if(t.maxX>this.maxX){this.maxX=t.maxX}if(t.minY<this.minY){this.minY=t.minY}if(t.maxY>this.maxY){this.maxY=t.maxY}};t.prototype.getHeight=function(){return this.maxY-this.minY+1};t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]};t.prototype.getWidth=function(){return this.maxX-this.minX+1};t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY};return t}();function Lu(t,e,i,n,r){if(r!==undefined){r.minX=t;r.maxX=e;r.minY=i;r.maxY=n;return r}else{return new bu(t,e,i,n)}}var Au=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Mu=function(t){Au(e,t);function e(e){var i=t.call(this,e)||this;i.extentChanged=true;i.renderedExtent_=null;i.renderedProjection=null;i.renderedTiles=[];i.newTiles_=false;i.tmpExtent=X();i.tmpTileRange_=new bu(0,0,0,0);return i}e.prototype.isDrawableTile=function(t){var e=this.getLayer();var i=t.getState();var n=e.getUseInterimTilesOnError();return i==yr.LOADED||i==yr.EMPTY||i==yr.ERROR&&!n};e.prototype.getTile=function(t,e,i,n){var r=n.pixelRatio;var o=n.viewState.projection;var a=this.getLayer();var s=a.getSource();var u=s.getTile(t,e,i,r,o);if(u.getState()==yr.ERROR){if(!a.getUseInterimTilesOnError()){u.setState(yr.LOADED)}else if(a.getPreload()>0){this.newTiles_=true}}if(!this.isDrawableTile(u)){u=u.getInterimTile()}return u};e.prototype.loadedTileCallback=function(e,i,n){if(this.isDrawableTile(n)){return t.prototype.loadedTileCallback.call(this,e,i,n)}return false};e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()};e.prototype.renderFrame=function(t,e){var i=t.layerStatesArray[t.layerIndex];var n=t.viewState;var r=n.projection;var a=n.resolution;var s=n.center;var u=n.rotation;var l=t.pixelRatio;var h=this.getLayer();var f=h.getSource();var c=f.getRevision();var p=f.getTileGridForProjection(r);var d=p.getZForResolution(a,f.zDirection);var v=p.getResolution(d);var _=t.extent;var y=i.extent&&pn(i.extent);if(y){_=ut(_,pn(i.extent))}var m=f.getTilePixelRatio(l);var x=Math.round(t.size[0]*m);var E=Math.round(t.size[1]*m);if(u){var T=Math.round(Math.sqrt(x*x+E*E));x=T;E=T}var R=v*x/2/m;var O=v*E/2/m;var C=[s[0]-R,s[1]-O,s[0]+R,s[1]+O];var I=p.getTileRangeForExtentAndZ(_,d);var b={};b[d]={};var L=this.createLoadedTileFinder(f,r,b);var A=this.tmpExtent;var M=this.tmpTileRange_;this.newTiles_=false;for(var D=I.minX;D<=I.maxX;++D){for(var F=I.minY;F<=I.maxY;++F){var N=this.getTile(d,D,F,t);if(this.isDrawableTile(N)){var k=g(this);if(N.getState()==yr.LOADED){b[d][N.tileCoord.toString()]=N;var G=N.inTransition(k);if(!this.newTiles_&&(G||this.renderedTiles.indexOf(N)===-1)){this.newTiles_=true}}if(N.getAlpha(k,t.time)===1){continue}}var j=p.getTileCoordChildTileRange(N.tileCoord,M,A);var Y=false;if(j){Y=L(d+1,j)}if(!Y){p.forEachTileCoordParentTileRange(N.tileCoord,L,M,A)}}}var z=v/a;w(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/m,1/m,u,-x/2,-E/2);var X=hi(this.pixelTransform);this.useContainer(e,X,i.opacity);var W=this.context;var K=W.canvas;P(this.inversePixelTransform,this.pixelTransform);w(this.tempTransform,x/2,E/2,z,z,0,-x/2,-E/2);if(K.width!=x||K.height!=E){K.width=x;K.height=E}else if(!this.containerReused){W.clearRect(0,0,x,E)}if(y){this.clipUnrotated(W,t,y)}zt(W,f.getContextOptions());this.preRender(W,t);this.renderedTiles.length=0;var Z=Object.keys(b).map(Number);Z.sort(o);var U,B,H;if(i.opacity===1&&(!this.containerReused||f.getOpaque(t.viewState.projection))){Z=Z.reverse()}else{U=[];B=[]}for(var q=Z.length-1;q>=0;--q){var J=Z[q];var Q=f.getTilePixelSize(J,l,r);var $=p.getResolution(J);var tt=$/v;var et=Q[0]*tt*z;var it=Q[1]*tt*z;var nt=p.getTileCoordForCoordAndZ(lt(C),J);var rt=p.getTileCoordExtent(nt);var ot=S(this.tempTransform,[m*(rt[0]-C[0])/v,m*(C[3]-rt[3])/v]);var at=m*f.getGutterForProjection(r);var st=b[J];for(var ht in st){var N=st[ht];var ft=N.tileCoord;var ct=ot[0]-(nt[1]-ft[1])*et;var pt=Math.round(ct+et);var dt=ot[1]-(nt[2]-ft[2])*it;var vt=Math.round(dt+it);var D=Math.round(ct);var F=Math.round(dt);var _t=pt-D;var gt=vt-F;var yt=d===J;var G=yt&&N.getAlpha(g(this),t.time)!==1;if(!G){if(U){W.save();H=[D,F,D+_t,F,D+_t,F+gt,D,F+gt];for(var mt=0,xt=U.length;mt<xt;++mt){if(d!==J&&J<B[mt]){var Et=U[mt];W.beginPath();W.moveTo(H[0],H[1]);W.lineTo(H[2],H[3]);W.lineTo(H[4],H[5]);W.lineTo(H[6],H[7]);W.moveTo(Et[6],Et[7]);W.lineTo(Et[4],Et[5]);W.lineTo(Et[2],Et[3]);W.lineTo(Et[0],Et[1]);W.clip()}}U.push(H);B.push(J)}else{W.clearRect(D,F,_t,gt)}}this.drawTileImage(N,t,D,F,_t,gt,at,yt,i.opacity);if(U&&!G){W.restore()}this.renderedTiles.push(N);this.updateUsedTiles(t.usedTiles,f,N)}}this.renderedRevision=c;this.renderedResolution=v;this.extentChanged=!this.renderedExtent_||!V(this.renderedExtent_,C);this.renderedExtent_=C;this.renderedPixelRatio=l;this.renderedProjection=r;this.manageTilePyramid(t,f,p,l,r,_,d,h.getPreload());this.scheduleExpireCache(t,f);this.postRender(W,t);if(i.extent){W.restore()}if(X!==K.style.transform){K.style.transform=X}return this.container};e.prototype.drawTileImage=function(t,e,i,n,r,o,a,s,u){var l=this.getTileImage(t);if(!l){return}var h=g(this);var f=s?t.getAlpha(h,e.time):1;var c=u*f;var p=c!==this.context.globalAlpha;if(p){this.context.save();this.context.globalAlpha=c}this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,i,n,r,o);if(p){this.context.restore()}if(f!==1){e.animate=true}else if(s){t.endTransition(h)}};e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null};e.prototype.getTileImage=function(t){return t.getImage()};e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var n=g(t);if(n in i.usedTiles){t.expireCache(i.viewState.projection,i.usedTiles[n])}}.bind(null,e);t.postRenderFunctions.push(i)}};e.prototype.updateUsedTiles=function(t,e,i){var n=g(e);if(!(n in t)){t[n]={}}t[n][i.getKey()]=true};e.prototype.manageTilePyramid=function(t,e,i,n,r,o,a,s,u){var l=g(e);if(!(l in t.wantedTiles)){t.wantedTiles[l]={}}var h=t.wantedTiles[l];var f=t.tileQueue;var c=i.getMinZoom();var p=0;var d,v,_,y,m,x;for(x=c;x<=a;++x){v=i.getTileRangeForExtentAndZ(o,x,v);_=i.getResolution(x);for(y=v.minX;y<=v.maxX;++y){for(m=v.minY;m<=v.maxY;++m){if(a-x<=s){++p;d=e.getTile(x,y,m,n,r);if(d.getState()==yr.IDLE){h[d.getKey()]=true;if(!f.isKeyQueued(d.getKey())){f.enqueue([d,l,i.getTileCoordCenter(d.tileCoord),_])}}if(u!==undefined){u(d)}}else{e.useTile(x,y,m,r)}}}}e.updateCacheSize(p,r)};return e}(Ps);var Du={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var Fu=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Nu=function(t){Fu(e,t);function e(e,i,n){var r=t.call(this)||this;var o=n?n:{};r.tileCoord=e;r.state=i;r.interimTile=null;r.hifi=true;r.key="";r.transition_=o.transition===undefined?250:o.transition;r.transitionStarts_={};return r}e.prototype.changed=function(){this.dispatchEvent(Bt.CHANGE)};e.prototype.release=function(){};e.prototype.getKey=function(){return this.key+"/"+this.tileCoord};e.prototype.getInterimTile=function(){if(!this.interimTile){return this}var t=this.interimTile;do{if(t.getState()==yr.LOADED){this.transition_=0;return t}t=t.interimTile}while(t);return this};e.prototype.refreshInterimChain=function(){if(!this.interimTile){return}var t=this.interimTile;var e=this;do{if(t.getState()==yr.LOADED){t.interimTile=null;break}else if(t.getState()==yr.LOADING){e=t}else if(t.getState()==yr.IDLE){e.interimTile=t.interimTile}else{e=t}t=e.interimTile}while(t)};e.prototype.getTileCoord=function(){return this.tileCoord};e.prototype.getState=function(){return this.state};e.prototype.setState=function(t){if(this.state!==yr.ERROR&&this.state>t){throw new Error("Tile load sequence violation")}this.state=t;this.changed()};e.prototype.load=function(){v()};e.prototype.getAlpha=function(t,e){if(!this.transition_){return 1}var i=this.transitionStarts_[t];if(!i){i=e;this.transitionStarts_[t]=i}else if(i===-1){return 1}var n=e-i+1e3/60;if(n>=this.transition_){return 1}return kr(n/this.transition_)};e.prototype.inTransition=function(t){if(!this.transition_){return false}return this.transitionStarts_[t]!==-1};e.prototype.endTransition=function(t){if(this.transition_){this.transitionStarts_[t]=-1}};return e}(Ut);var ku=function(){function t(t){this.highWaterMark=t!==undefined?t:2048;this.count_=0;this.entries_={};this.oldest_=null;this.newest_=null}t.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark};t.prototype.clear=function(){this.count_=0;this.entries_={};this.oldest_=null;this.newest_=null};t.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)};t.prototype.forEach=function(t){var e=this.oldest_;while(e){t(e.value_,e.key_,this);e=e.newer}};t.prototype.get=function(t,e){var i=this.entries_[t];E(i!==undefined,15);if(i===this.newest_){return i.value_}else if(i===this.oldest_){this.oldest_=this.oldest_.newer;this.oldest_.older=null}else{i.newer.older=i.older;i.older.newer=i.newer}i.newer=null;i.older=this.newest_;this.newest_.newer=i;this.newest_=i;return i.value_};t.prototype.remove=function(t){var e=this.entries_[t];E(e!==undefined,15);if(e===this.newest_){this.newest_=e.older;if(this.newest_){this.newest_.newer=null}}else if(e===this.oldest_){this.oldest_=e.newer;if(this.oldest_){this.oldest_.older=null}}else{e.newer.older=e.older;e.older.newer=e.newer}delete this.entries_[t];--this.count_;return e.value_};t.prototype.getCount=function(){return this.count_};t.prototype.getKeys=function(){var t=new Array(this.count_);var e=0;var i;for(i=this.newest_;i;i=i.older){t[e++]=i.key_}return t};t.prototype.getValues=function(){var t=new Array(this.count_);var e=0;var i;for(i=this.newest_;i;i=i.older){t[e++]=i.value_}return t};t.prototype.peekLast=function(){return this.oldest_.value_};t.prototype.peekLastKey=function(){return this.oldest_.key_};t.prototype.peekFirstKey=function(){return this.newest_.key_};t.prototype.pop=function(){var t=this.oldest_;delete this.entries_[t.key_];if(t.newer){t.newer.older=null}this.oldest_=t.newer;if(!this.oldest_){this.newest_=null}--this.count_;return t.value_};t.prototype.replace=function(t,e){this.get(t);this.entries_[t].value_=e};t.prototype.set=function(t,e){E(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};if(!this.newest_){this.oldest_=i}else{this.newest_.newer=i}this.newest_=i;this.entries_[t]=i;++this.count_};t.prototype.setSize=function(t){this.highWaterMark=t};return t}();function Gu(t,e,i,n){if(n!==undefined){n[0]=t;n[1]=e;n[2]=i;return n}else{return[t,e,i]}}function ju(t,e,i){return t+"/"+e+"/"+i}function Yu(t){return ju(t[0],t[1],t[2])}function zu(t){return t.split("/").map(Number)}function Xu(t){return(t[1]<<t[0])+t[2]}function Wu(t,e){var i=t[0];var n=t[1];var r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom()){return false}var o=e.getExtent();var a;if(!o){a=e.getFullTileRange(i)}else{a=e.getTileRangeForExtentAndZ(o,i)}if(!a){return true}else{return a.containsXY(n,r)}}var Ku=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Zu=function(t){Ku(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.expireCache=function(t){while(this.canExpireCache()){var e=this.peekLast();if(e.getKey()in t){break}else{this.pop().release()}}};e.prototype.pruneExceptNewestZ=function(){if(this.getCount()===0){return}var t=this.peekFirstKey();var e=zu(t);var i=e[0];this.forEach(function(t){if(t.tileCoord[0]!==i){this.remove(Yu(t.tileCoord));t.release()}}.bind(this))};return e}(ku);var Uu={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var Bu=[0,0,0];var Vu=function(){function t(t){this.minZoom=t.minZoom!==undefined?t.minZoom:0;this.resolutions_=t.resolutions;E(h(this.resolutions_,(function(t,e){return e-t}),true),17);var e;if(!t.origins){for(var i=0,n=this.resolutions_.length-1;i<n;++i){if(!e){e=this.resolutions_[i]/this.resolutions_[i+1]}else{if(this.resolutions_[i]/this.resolutions_[i+1]!==e){e=undefined;break}}}}this.zoomFactor_=e;this.maxZoom=this.resolutions_.length-1;this.origin_=t.origin!==undefined?t.origin:null;this.origins_=null;if(t.origins!==undefined){this.origins_=t.origins;E(this.origins_.length==this.resolutions_.length,20)}var r=t.extent;if(r!==undefined&&!this.origin_&&!this.origins_){this.origin_=lt(r)}E(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18);this.tileSizes_=null;if(t.tileSizes!==undefined){this.tileSizes_=t.tileSizes;E(this.tileSizes_.length==this.resolutions_.length,19)}this.tileSize_=t.tileSize!==undefined?t.tileSize:!this.tileSizes_?Cr:null;E(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22);this.extent_=r!==undefined?r:null;this.fullTileRanges_=null;this.tmpSize_=[0,0];if(t.sizes!==undefined){this.fullTileRanges_=t.sizes.map((function(t,e){var i=new bu(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));return i}),this)}else if(r){this.calculateTileRanges_(r)}}t.prototype.forEachTileCoord=function(t,e,i){var n=this.getTileRangeForExtentAndZ(t,e);for(var r=n.minX,o=n.maxX;r<=o;++r){for(var a=n.minY,s=n.maxY;a<=s;++a){i([e,r,a])}}};t.prototype.forEachTileCoordParentTileRange=function(t,e,i,n){var r,o,a;var s=null;var u=t[0]-1;if(this.zoomFactor_===2){o=t[1];a=t[2]}else{s=this.getTileCoordExtent(t,n)}while(u>=this.minZoom){if(this.zoomFactor_===2){o=Math.floor(o/2);a=Math.floor(a/2);r=Lu(o,o,a,a,i)}else{r=this.getTileRangeForExtentAndZ(s,u,i)}if(e(u,r)){return true}--u}return false};t.prototype.getExtent=function(){return this.extent_};t.prototype.getMaxZoom=function(){return this.maxZoom};t.prototype.getMinZoom=function(){return this.minZoom};t.prototype.getOrigin=function(t){if(this.origin_){return this.origin_}else{return this.origins_[t]}};t.prototype.getResolution=function(t){return this.resolutions_[t]};t.prototype.getResolutions=function(){return this.resolutions_};t.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){var n=t[1]*2;var r=t[2]*2;return Lu(n,n+1,r,r+1,e)}var o=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null};t.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t);var r=this.getResolution(t);var o=Fo(this.getTileSize(t),this.tmpSize_);var a=n[0]+e.minX*o[0]*r;var s=n[0]+(e.maxX+1)*o[0]*r;var u=n[1]+e.minY*o[1]*r;var l=n[1]+(e.maxY+1)*o[1]*r;return W(a,u,s,l,i)};t.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=Bu;this.getTileCoordForXYAndZ_(t[0],t[3],e,false,n);var r=n[1];var o=n[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,true,n);return Lu(r,n[1],o,n[2],i)};t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]);var i=this.getResolution(t[0]);var n=Fo(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]};t.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]);var n=this.getResolution(t[0]);var r=Fo(this.getTileSize(t[0]),this.tmpSize_);var o=i[0]+t[1]*r[0]*n;var a=i[1]-(t[2]+1)*r[1]*n;var s=o+r[0]*n;var u=a+r[1]*n;return W(o,a,s,u,e)};t.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,false,i)};t.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,r){var o=this.getZForResolution(i);var a=i/this.getResolution(o);var s=this.getOrigin(o);var u=Fo(this.getTileSize(o),this.tmpSize_);var l=n?.5:0;var h=n?.5:0;var f=Math.floor((t-s[0])/i+l);var c=Math.floor((s[1]-e)/i+h);var p=a*f/u[0];var d=a*c/u[1];if(n){p=Math.ceil(p)-1;d=Math.ceil(d)-1}else{p=Math.floor(p);d=Math.floor(d)}return Gu(o,p,d,r)};t.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,r){var o=this.getOrigin(i);var a=this.getResolution(i);var s=Fo(this.getTileSize(i),this.tmpSize_);var u=n?.5:0;var l=n?.5:0;var h=Math.floor((t-o[0])/a+u);var f=Math.floor((o[1]-e)/a+l);var c=h/s[0];var p=f/s[1];if(n){c=Math.ceil(c)-1;p=Math.ceil(p)-1}else{c=Math.floor(c);p=Math.floor(p)}return Gu(i,c,p,r)};t.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,false,i)};t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]};t.prototype.getTileSize=function(t){if(this.tileSize_){return this.tileSize_}else{return this.tileSizes_[t]}};t.prototype.getFullTileRange=function(t){if(!this.fullTileRanges_){return null}else{return this.fullTileRanges_[t]}};t.prototype.getZForResolution=function(t,e){var i=a(this.resolutions_,t,e||0);return yt(i,this.minZoom,this.maxZoom)};t.prototype.calculateTileRanges_=function(t){var e=this.resolutions_.length;var i=new Array(e);for(var n=this.minZoom;n<e;++n){i[n]=this.getTileRangeForExtentAndZ(t,n)}this.fullTileRanges_=i};return t}();function Hu(t){var e=t.getDefaultTileGrid();if(!e){e=tl(t);t.setDefaultTileGrid(e)}return e}function qu(t,e,i){var n=e[0];var r=t.getTileCoordCenter(e);var o=el(i);if(!G(o,r)){var a=ft(o);var s=Math.ceil((o[0]-r[0])/a);r[0]+=a*s;return t.getTileCoordForCoordAndZ(r,n)}else{return e}}function Ju(t,e,i,n){var r=n!==undefined?n:A.TOP_LEFT;var o=$u(t,e,i);return new Vu({extent:t,origin:ot(t,r),resolutions:o,tileSize:i})}function Qu(t){var e=t||{};var i=e.extent||Ji("EPSG:3857").getExtent();var n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:$u(i,e.maxZoom,e.tileSize,e.maxResolution)};return new Vu(n)}function $u(t,e,i,n){var r=e!==undefined?e:Or;var o=st(t);var a=ft(t);var s=Fo(i!==undefined?i:Cr);var u=n>0?n:Math.max(a/s[0],o/s[1]);var l=r+1;var h=new Array(l);for(var f=0;f<l;++f){h[f]=u/Math.pow(2,f)}return h}function tl(t,e,i,n){var r=el(t);return Ju(r,e,i,n)}function el(t){t=Ji(t);var e=t.getExtent();if(!e){var i=180*_i[vi.DEGREES]/t.getMetersPerUnit();e=W(-i,-i,i,i)}return e}var il=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var nl=function(t){il(e,t);function e(e){var i=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX})||this;i.opaque_=e.opaque!==undefined?e.opaque:false;i.tilePixelRatio_=e.tilePixelRatio!==undefined?e.tilePixelRatio:1;i.tileGrid=e.tileGrid!==undefined?e.tileGrid:null;var n=[256,256];var r=e.tileGrid;if(r){Fo(r.getTileSize(r.getMinZoom()),n)}i.tileCache=new Zu(e.cacheSize||0);i.tmpSize=[0,0];i.key_=e.key||"";i.tileOptions={transition:e.transition};i.zDirection=e.zDirection?e.zDirection:0;return i}e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()};e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);if(i){i.expireCache(e)}};e.prototype.forEachLoadedTile=function(t,e,i,n){var r=this.getTileCacheForProjection(t);if(!r){return false}var o=true;var a,s,u;for(var l=i.minX;l<=i.maxX;++l){for(var h=i.minY;h<=i.maxY;++h){s=ju(e,l,h);u=false;if(r.containsKey(s)){a=r.get(s);u=a.getState()===yr.LOADED;if(u){u=n(a)!==false}}if(!u){o=false}}}return o};e.prototype.getGutterForProjection=function(t){return 0};e.prototype.getKey=function(){return this.key_};e.prototype.setKey=function(t){if(this.key_!==t){this.key_=t;this.changed()}};e.prototype.getOpaque=function(t){return this.opaque_};e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()};e.prototype.getTile=function(t,e,i,n,r){return v()};e.prototype.getTileGrid=function(){return this.tileGrid};e.prototype.getTileGridForProjection=function(t){if(!this.tileGrid){return Hu(t)}else{return this.tileGrid}};e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(e&&!rn(e,t)){return null}else{return this.tileCache}};e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_};e.prototype.getTilePixelSize=function(t,e,i){var n=this.getTileGridForProjection(i);var r=this.getTilePixelRatio(e);var o=Fo(n.getTileSize(t),this.tmpSize);if(r==1){return o}else{return Do(o,r,this.tmpSize)}};e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=e!==undefined?e:this.getProjection();var n=this.getTileGridForProjection(i);if(this.getWrapX()&&i.isGlobal()){t=qu(n,t,i)}return Wu(t,n)?t:null};e.prototype.clear=function(){this.tileCache.clear()};e.prototype.refresh=function(){this.clear();t.prototype.refresh.call(this)};e.prototype.updateCacheSize=function(t,e){var i=this.getTileCacheForProjection(e);if(t>i.highWaterMark){i.highWaterMark=t}};e.prototype.useTile=function(t,e,i,n){};return e}(vu);var rl=function(t){il(e,t);function e(e,i){var n=t.call(this,e)||this;n.tile=i;return n}return e}(jt);function ol(t,e){var i=/\{z\}/g;var n=/\{x\}/g;var r=/\{y\}/g;var o=/\{-y\}/g;return function(a,s,u){if(!a){return undefined}else{return t.replace(i,a[0].toString()).replace(n,a[1].toString()).replace(r,a[2].toString()).replace(o,(function(){var t=a[0];var i=e.getFullTileRange(t);E(i,55);var n=i.getHeight()-a[2]-1;return n.toString()}))}}}function al(t,e){var i=t.length;var n=new Array(i);for(var r=0;r<i;++r){n[r]=ol(t[r],e)}return sl(n)}function sl(t){if(t.length===1){return t[0]}return function(e,i,n){if(!e){return undefined}else{var r=Xu(e);var o=Ct(r,t.length);return t[o](e,i,n)}}}function ul(t){var e=[];var i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n=i[1].charCodeAt(0);var r=i[2].charCodeAt(0);var o=void 0;for(o=n;o<=r;++o){e.push(t.replace(i[0],String.fromCharCode(o)))}return e}i=/\{(\d+)-(\d+)\}/.exec(t);if(i){var a=parseInt(i[2],10);for(var s=parseInt(i[1],10);s<=a;s++){e.push(t.replace(i[0],s.toString()))}return e}e.push(t);return e}var ll=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var hl=function(t){ll(e,t);function e(i){var n=t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,opaque:i.opaque,projection:i.projection,state:i.state,tileGrid:i.tileGrid,tilePixelRatio:i.tilePixelRatio,wrapX:i.wrapX,transition:i.transition,key:i.key,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this;n.generateTileUrlFunction_=n.tileUrlFunction===e.prototype.tileUrlFunction;n.tileLoadFunction=i.tileLoadFunction;if(i.tileUrlFunction){n.tileUrlFunction=i.tileUrlFunction.bind(n)}n.urls=null;if(i.urls){n.setUrls(i.urls)}else if(i.url){n.setUrl(i.url)}n.tileLoadingKeys_={};return n}e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction};e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction};e.prototype.getUrls=function(){return this.urls};e.prototype.handleTileChange=function(t){var e=t.target;var i=g(e);var n=e.getState();var r;if(n==yr.LOADING){this.tileLoadingKeys_[i]=true;r=Uu.TILELOADSTART}else if(i in this.tileLoadingKeys_){delete this.tileLoadingKeys_[i];r=n==yr.ERROR?Uu.TILELOADERROR:n==yr.LOADED?Uu.TILELOADEND:undefined}if(r!=undefined){this.dispatchEvent(new rl(r,e))}};e.prototype.setTileLoadFunction=function(t){this.tileCache.clear();this.tileLoadFunction=t;this.changed()};e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t;this.tileCache.pruneExceptNewestZ();if(typeof e!=="undefined"){this.setKey(e)}else{this.changed()}};e.prototype.setUrl=function(t){var e=ul(t);this.urls=e;this.setUrls(e)};e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");if(this.generateTileUrlFunction_){this.setTileUrlFunction(al(t,this.tileGrid),e)}else{this.setKey(e)}};e.prototype.tileUrlFunction=function(t,e,i){return undefined};e.prototype.useTile=function(t,e,i){var n=ju(t,e,i);if(this.tileCache.containsKey(n)){this.tileCache.get(n)}};return e}(nl);var fl=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var cl=function(t){fl(e,t);function e(e){var i=this;var n=e?e:{};var r=zt({},n);delete r.preload;delete r.useInterimTilesOnError;i=t.call(this,r)||this;i.setPreload(n.preload!==undefined?n.preload:0);i.setUseInterimTilesOnError(n.useInterimTilesOnError!==undefined?n.useInterimTilesOnError:true);return i}e.prototype.getPreload=function(){return this.get(Du.PRELOAD)};e.prototype.setPreload=function(t){this.set(Du.PRELOAD,t)};e.prototype.getUseInterimTilesOnError=function(){return this.get(Du.USE_INTERIM_TILES_ON_ERROR)};e.prototype.setUseInterimTilesOnError=function(t){this.set(Du.USE_INTERIM_TILES_ON_ERROR,t)};return e}(fe);var pl=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var dl=function(t){pl(e,t);function e(e){return t.call(this,e)||this}e.prototype.createRenderer=function(){return new Mu(this)};return e}(cl);var vl=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var _l=function(t){vl(e,t);function e(e,i,n,r,o,a){var s=t.call(this,e,i,a)||this;s.crossOrigin_=r;s.src_=n;s.image_=new Image;if(r!==null){s.image_.crossOrigin=r}s.unlisten_=null;s.tileLoadFunction_=o;return s}e.prototype.getImage=function(){return this.image_};e.prototype.getKey=function(){return this.src_};e.prototype.handleImageError_=function(){this.state=yr.ERROR;this.unlistenImage_();this.image_=gl();this.changed()};e.prototype.handleImageLoad_=function(){var t=this.image_;if(t.naturalWidth&&t.naturalHeight){this.state=yr.LOADED}else{this.state=yr.EMPTY}this.unlistenImage_();this.changed()};e.prototype.load=function(){if(this.state==yr.ERROR){this.state=yr.IDLE;this.image_=new Image;if(this.crossOrigin_!==null){this.image_.crossOrigin=this.crossOrigin_}}if(this.state==yr.IDLE){this.state=yr.LOADING;this.changed();this.tileLoadFunction_(this,this.src_);this.unlisten_=tu(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}};e.prototype.unlistenImage_=function(){if(this.unlisten_){this.unlisten_();this.unlisten_=null}};return e}(Nu);function gl(){var t=Ce(1,1);t.fillStyle="rgba(0,0,0,0)";t.fillRect(0,0,1,1);return t.canvas}var yl=10;var ml=.25;var xl=function(){function t(t,e,i,n,r,o){this.sourceProj_=t;this.targetProj_=e;var a={};var s=an(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];if(!a[e]){a[e]=s(t)}return a[e]};this.maxSourceExtent_=n;this.errorThresholdSquared_=r*r;this.triangles_=[];this.wrapsXInSource_=false;this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&ft(n)==ft(this.sourceProj_.getExtent());this.sourceWorldWidth_=this.sourceProj_.getExtent()?ft(this.sourceProj_.getExtent()):null;this.targetWorldWidth_=this.targetProj_.getExtent()?ft(this.targetProj_.getExtent()):null;var u=lt(i);var l=ht(i);var h=nt(i);var f=it(i);var c=this.transformInv_(u);var p=this.transformInv_(l);var d=this.transformInv_(h);var v=this.transformInv_(f);var _=yl+(o?Math.max(0,Math.ceil(xt(et(i)/(o*o*256*256)))):0);this.addQuad_(u,l,h,f,c,p,d,v,_);if(this.wrapsXInSource_){var g=Infinity;this.triangles_.forEach((function(t,e,i){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])}));this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];if(e[0][0]-g>this.sourceWorldWidth_/2){e[0][0]-=this.sourceWorldWidth_}if(e[1][0]-g>this.sourceWorldWidth_/2){e[1][0]-=this.sourceWorldWidth_}if(e[2][0]-g>this.sourceWorldWidth_/2){e[2][0]-=this.sourceWorldWidth_}var i=Math.min(e[0][0],e[1][0],e[2][0]);var n=Math.max(e[0][0],e[1][0],e[2][0]);if(n-i<this.sourceWorldWidth_/2){t.source=e}}}.bind(this))}a={}}t.prototype.addTriangle_=function(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})};t.prototype.addQuad_=function(t,e,i,n,r,o,a,s,u){var l=D([r,o,a,s]);var h=this.sourceWorldWidth_?ft(l)/this.sourceWorldWidth_:null;var f=this.sourceWorldWidth_;var c=this.sourceProj_.canWrapX()&&h>.5&&h<1;var p=false;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var d=D([t,e,i,n]);var v=ft(d)/this.targetWorldWidth_;p=v>ml||p}if(!c&&this.sourceProj_.isGlobal()&&h){p=h>ml||p}}if(!p&&this.maxSourceExtent_){if(isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])){if(!ct(l,this.maxSourceExtent_)){return}}}var _=0;if(!p){if(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(s[0])||!isFinite(s[1])){if(u>0){p=true}else{_=(!isFinite(r[0])||!isFinite(r[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(s[0])||!isFinite(s[1])?1:0);if(_!=1&&_!=2&&_!=4&&_!=8){return}}}}if(u>0){if(!p){var g=[(t[0]+i[0])/2,(t[1]+i[1])/2];var y=this.transformInv_(g);var m=void 0;if(c){var x=(Ct(r[0],f)+Ct(a[0],f))/2;m=x-Ct(y[0],f)}else{m=(r[0]+a[0])/2-y[0]}var E=(r[1]+a[1])/2-y[1];var T=m*m+E*E;p=T>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var R=[(e[0]+i[0])/2,(e[1]+i[1])/2];var O=this.transformInv_(R);var C=[(n[0]+t[0])/2,(n[1]+t[1])/2];var S=this.transformInv_(C);this.addQuad_(t,e,R,C,r,o,O,S,u-1);this.addQuad_(C,R,i,n,S,O,a,s,u-1)}else{var I=[(t[0]+e[0])/2,(t[1]+e[1])/2];var w=this.transformInv_(I);var P=[(i[0]+n[0])/2,(i[1]+n[1])/2];var b=this.transformInv_(P);this.addQuad_(t,I,P,n,r,w,b,s,u-1);this.addQuad_(I,e,i,P,w,o,a,b,u-1)}return}}if(c){if(!this.canWrapXInSource_){return}this.wrapsXInSource_=true}if((_&11)==0){this.addTriangle_(t,i,n,r,a,s)}if((_&14)==0){this.addTriangle_(t,i,e,r,a,o)}if(_){if((_&13)==0){this.addTriangle_(e,n,t,o,s,r)}if((_&7)==0){this.addTriangle_(e,n,i,o,s,a)}}};t.prototype.calculateSourceExtent=function(){var t=X();this.triangles_.forEach((function(e,i,n){var r=e.source;q(t,r[0]);q(t,r[1]);q(t,r[2])}));return t};t.prototype.getTriangles=function(){return this.triangles_};return t}();var El={imageSmoothingEnabled:false,msImageSmoothingEnabled:false};var Tl;function Rl(t,e,i,n,r){t.beginPath();t.moveTo(0,0);t.lineTo(e,i);t.lineTo(n,r);t.closePath();t.save();t.clip();t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,r));t.restore()}function Ol(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function Cl(){if(Tl===undefined){var t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter";t.fillStyle="rgba(210, 0, 0, 0.75)";Rl(t,4,5,4,0);Rl(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;Tl=Ol(e,0)||Ol(e,4)||Ol(e,8)}return Tl}function Sl(t,e,i,n){var r=sn(i,e,t);var o=Qi(e,n,i);var a=e.getMetersPerUnit();if(a!==undefined){o*=a}var s=t.getMetersPerUnit();if(s!==undefined){o/=s}var u=t.getExtent();if(!u||G(u,r)){var l=Qi(t,o,r)/o;if(isFinite(l)&&l>0){o/=l}}return o}function Il(t,e,i,n){var r=rt(i);var o=Sl(t,e,r,n);if(!isFinite(o)||o<=0){tt(i,(function(i){o=Sl(t,e,i,n);return isFinite(o)&&o>0}))}return o}function wl(t,e,i,n,r,o,a,s,u,l,h,f){var c=Ce(Math.round(i*t),Math.round(i*e));zt(c,f);if(u.length===0){return c.canvas}c.scale(i,i);function p(t){return Math.round(t*i)/i}c.globalCompositeOperation="lighter";var d=X();u.forEach((function(t,e,i){H(d,t.extent)}));var v=ft(d);var _=st(d);var g=Ce(Math.round(i*v/n),Math.round(i*_/n));zt(g,f);var y=i/n;u.forEach((function(t,e,i){var n=t.extent[0]-d[0];var r=-(t.extent[3]-d[3]);var o=ft(t.extent);var a=st(t.extent);if(t.image.width>0&&t.image.height>0){g.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,n*y,r*y,o*y,a*y)}}));var m=lt(a);s.getTriangles().forEach((function(t,e,r){var a=t.source;var s=t.target;var u=a[0][0],l=a[0][1];var h=a[1][0],v=a[1][1];var _=a[2][0],y=a[2][1];var x=p((s[0][0]-m[0])/o);var E=p(-(s[0][1]-m[1])/o);var T=p((s[1][0]-m[0])/o);var R=p(-(s[1][1]-m[1])/o);var O=p((s[2][0]-m[0])/o);var C=p(-(s[2][1]-m[1])/o);var S=u;var I=l;u=0;l=0;h-=S;v-=I;_-=S;y-=I;var w=[[h,v,0,0,T-x],[_,y,0,0,O-x],[0,0,h,v,R-E],[0,0,_,y,C-E]];var P=Rt(w);if(!P){return}c.save();c.beginPath();if(Cl()||f===El){c.moveTo(T,R);var b=4;var L=x-T;var A=E-R;for(var M=0;M<b;M++){c.lineTo(T+p((M+1)*L/b),R+p(M*A/(b-1)));if(M!=b-1){c.lineTo(T+p((M+1)*L/b),R+p((M+1)*A/(b-1)))}}c.lineTo(O,C)}else{c.moveTo(T,R);c.lineTo(x,E);c.lineTo(O,C)}c.clip();c.transform(P[0],P[2],P[1],P[3],x,E);c.translate(d[0]-S,d[3]-I);c.scale(n/i,-n/i);c.drawImage(g.canvas,0,0);c.restore()}));if(h){c.save();c.globalCompositeOperation="source-over";c.strokeStyle="black";c.lineWidth=1;s.getTriangles().forEach((function(t,e,i){var n=t.target;var r=(n[0][0]-m[0])/o;var a=-(n[0][1]-m[1])/o;var s=(n[1][0]-m[0])/o;var u=-(n[1][1]-m[1])/o;var l=(n[2][0]-m[0])/o;var h=-(n[2][1]-m[1])/o;c.beginPath();c.moveTo(s,u);c.lineTo(r,a);c.lineTo(l,h);c.closePath();c.stroke()}));c.restore()}return c.canvas}var Pl=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var bl=function(t){Pl(e,t);function e(e,i,n,r,o,a,s,u,l,h,f,c){var p=t.call(this,o,yr.IDLE)||this;p.renderEdges_=f!==undefined?f:false;p.contextOptions_=c;p.pixelRatio_=s;p.gutter_=u;p.canvas_=null;p.sourceTileGrid_=i;p.targetTileGrid_=r;p.wrappedTileCoord_=a?a:o;p.sourceTiles_=[];p.sourcesListenerKeys_=null;p.sourceZ_=0;var d=r.getTileCoordExtent(p.wrappedTileCoord_);var v=p.targetTileGrid_.getExtent();var _=p.sourceTileGrid_.getExtent();var g=v?ut(d,v):d;if(et(g)===0){p.state=yr.EMPTY;return p}var y=e.getExtent();if(y){if(!_){_=y}else{_=ut(_,y)}}var m=r.getResolution(p.wrappedTileCoord_[0]);var x=Il(e,n,g,m);if(!isFinite(x)||x<=0){p.state=yr.EMPTY;return p}var E=h!==undefined?h:Pu;p.triangulation_=new xl(e,n,g,_,x*E,m);if(p.triangulation_.getTriangles().length===0){p.state=yr.EMPTY;return p}p.sourceZ_=i.getZForResolution(x);var T=p.triangulation_.calculateSourceExtent();if(_){if(e.canWrapX()){T[1]=yt(T[1],_[1],_[3]);T[3]=yt(T[3],_[1],_[3])}else{T=ut(T,_)}}if(!et(T)){p.state=yr.EMPTY}else{var R=i.getTileRangeForExtentAndZ(T,p.sourceZ_);for(var O=R.minX;O<=R.maxX;O++){for(var C=R.minY;C<=R.maxY;C++){var S=l(p.sourceZ_,O,C,s);if(S){p.sourceTiles_.push(S)}}}if(p.sourceTiles_.length===0){p.state=yr.EMPTY}}return p}e.prototype.getImage=function(){return this.canvas_};e.prototype.reproject_=function(){var t=[];this.sourceTiles_.forEach(function(e,i,n){if(e&&e.getState()==yr.LOADED){t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}}.bind(this));this.sourceTiles_.length=0;if(t.length===0){this.state=yr.ERROR}else{var e=this.wrappedTileCoord_[0];var i=this.targetTileGrid_.getTileSize(e);var n=typeof i==="number"?i:i[0];var r=typeof i==="number"?i:i[1];var o=this.targetTileGrid_.getResolution(e);var a=this.sourceTileGrid_.getResolution(this.sourceZ_);var s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=wl(n,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,s,this.triangulation_,t,this.gutter_,this.renderEdges_,this.contextOptions_);this.state=yr.LOADED}this.changed()};e.prototype.load=function(){if(this.state==yr.IDLE){this.state=yr.LOADING;this.changed();var t=0;this.sourcesListenerKeys_=[];this.sourceTiles_.forEach(function(e,i,n){var r=e.getState();if(r==yr.IDLE||r==yr.LOADING){t++;var o=Vt(e,Bt.CHANGE,(function(i){var n=e.getState();if(n==yr.LOADED||n==yr.ERROR||n==yr.EMPTY){qt(o);t--;if(t===0){this.unlistenSources_();this.reproject_()}}}),this);this.sourcesListenerKeys_.push(o)}}.bind(this));this.sourceTiles_.forEach((function(t,e,i){var n=t.getState();if(n==yr.IDLE){t.load()}}));if(t===0){setTimeout(this.reproject_.bind(this),0)}}};e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(qt);this.sourcesListenerKeys_=null};return e}(Nu);var Ll=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Al=function(t){Ll(e,t);function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Ml,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;i.crossOrigin=e.crossOrigin!==undefined?e.crossOrigin:null;i.tileClass=e.tileClass!==undefined?e.tileClass:_l;i.tileCacheForProjection={};i.tileGridForProjection={};i.reprojectionErrorThreshold_=e.reprojectionErrorThreshold;i.contextOptions_=e.imageSmoothing===false?El:undefined;i.renderReprojectionEdges_=false;return i}e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache()){return true}else{for(var t in this.tileCacheForProjection){if(this.tileCacheForProjection[t].canExpireCache()){return true}}}return false};e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(var n in this.tileCacheForProjection){var r=this.tileCacheForProjection[n];r.expireCache(r==i?e:{})}};e.prototype.getContextOptions=function(){return this.contextOptions_};e.prototype.getGutterForProjection=function(t){if(this.getProjection()&&t&&!rn(this.getProjection(),t)){return 0}else{return this.getGutter()}};e.prototype.getGutter=function(){return 0};e.prototype.getKey=function(){return t.prototype.getKey.call(this)+(this.contextOptions_?"\n"+JSON.stringify(this.contextOptions_):"")};e.prototype.getOpaque=function(e){if(this.getProjection()&&e&&!rn(this.getProjection(),e)){return false}else{return t.prototype.getOpaque.call(this,e)}};e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(this.tileGrid&&(!e||rn(e,t))){return this.tileGrid}else{var i=g(t);if(!(i in this.tileGridForProjection)){this.tileGridForProjection[i]=Hu(t)}return this.tileGridForProjection[i]}};e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||rn(e,t)){return this.tileCache}else{var i=g(t);if(!(i in this.tileCacheForProjection)){this.tileCacheForProjection[i]=new Zu(this.tileCache.highWaterMark)}return this.tileCacheForProjection[i]}};e.prototype.createTile_=function(t,e,i,n,r,o){var a=[t,e,i];var s=this.getTileCoordForTileUrlFunction(a,r);var u=s?this.tileUrlFunction(s,n,r):undefined;var l=new this.tileClass(a,u!==undefined?yr.IDLE:yr.EMPTY,u!==undefined?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);l.key=o;l.addEventListener(Bt.CHANGE,this.handleTileChange.bind(this));return l};e.prototype.getTile=function(t,e,i,n,r){var o=this.getProjection();if(!o||!r||rn(o,r)){return this.getTileInternal(t,e,i,n,o||r)}else{var a=this.getTileCacheForProjection(r);var s=[t,e,i];var u=void 0;var l=Yu(s);if(a.containsKey(l)){u=a.get(l)}var h=this.getKey();if(u&&u.key==h){return u}else{var f=this.getTileGridForProjection(o);var c=this.getTileGridForProjection(r);var p=this.getTileCoordForTileUrlFunction(s,r);var d=new bl(o,f,r,c,s,p,this.getTilePixelRatio(n),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.contextOptions_);d.key=h;if(u){d.interimTile=u;d.refreshInterimChain();a.replace(l,d)}else{a.set(l,d)}return d}}};e.prototype.getTileInternal=function(t,e,i,n,r){var o=null;var a=ju(t,e,i);var s=this.getKey();if(!this.tileCache.containsKey(a)){o=this.createTile_(t,e,i,n,r,s);this.tileCache.set(a,o)}else{o=this.tileCache.get(a);if(o.key!=s){var u=o;o=this.createTile_(t,e,i,n,r,s);if(u.getState()==yr.IDLE){o.interimTile=u.interimTile}else{o.interimTile=u}o.refreshInterimChain();this.tileCache.replace(a,o)}}return o};e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_==t){return}this.renderReprojectionEdges_=t;for(var e in this.tileCacheForProjection){this.tileCacheForProjection[e].clear()}this.changed()};e.prototype.setTileGridForProjection=function(t,e){{var i=Ji(t);if(i){var n=g(i);if(!(n in this.tileGridForProjection)){this.tileGridForProjection[n]=e}}}};return e}(hl);function Ml(t,e){t.getImage().src=e}var Dl=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var Fl=function(t){Dl(e,t);function e(e){var i=this;var n=e||{};var r=n.projection!==undefined?n.projection:"EPSG:3857";var o=n.tileGrid!==undefined?n.tileGrid:Qu({extent:el(r),maxResolution:n.maxResolution,maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});i=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,imageSmoothing:n.imageSmoothing,opaque:n.opaque,projection:r,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:n.wrapX!==undefined?n.wrapX:true,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this;return i}return e}(Al);var Nl=undefined&&undefined.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var kl="&#169; "+'<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> '+"contributors.";var Gl=function(t){Nl(e,t);function e(e){var i=this;var n=e||{};var r;if(n.attributions!==undefined){r=n.attributions}else{r=[kl]}var o=n.crossOrigin!==undefined?n.crossOrigin:"anonymous";var a=n.url!==undefined?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";i=t.call(this,{attributions:r,cacheSize:n.cacheSize,crossOrigin:o,imageSmoothing:n.imageSmoothing,opaque:n.opaque!==undefined?n.opaque:true,maxZoom:n.maxZoom!==undefined?n.maxZoom:19,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,url:a,wrapX:n.wrapX,attributionsCollapsible:false})||this;return i}return e}(Fl);var jl=".geo-location__wrapper.sc-gtx-geo-location{font-family:Verdana, Geneva, Tahoma, sans-serif;border:solid 1px #000;padding:0.5rem 1rem;font-size:0.75rem;max-width:300px}.geo-location__title-wrapper.sc-gtx-geo-location{margin-bottom:0.5rem;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-align:center;align-items:center;-ms-flex-pack:start;justify-content:flex-start}.geo-location__icon-wrapper.sc-gtx-geo-location,.geo-location__error-icon.sc-gtx-geo-location{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.geo-location__icon-wrapper.sc-gtx-geo-location img.sc-gtx-geo-location,.geo-location__error-icon.sc-gtx-geo-location img.sc-gtx-geo-location{width:1.5rem;height:auto;margin:0;margin-right:0.5rem;display:block}.geo-location__error-icon.sc-gtx-geo-location img.sc-gtx-geo-location{height:2.5rem;width:auto}.geo-location__title-text.sc-gtx-geo-location{padding:0.25rem 0}.geo-location__footer.sc-gtx-geo-location{margin-top:0.5rem;text-align:justify}.geo-location__information-wrapper.sc-gtx-geo-location{margin-bottom:0.5rem}.geo-location__information-wrapper.sc-gtx-geo-location p.sc-gtx-geo-location{margin:0.5rem 0 0 0}.geo-location__map-wrapper.sc-gtx-geo-location{height:100px;width:100%}.geo-location__error-wrapper.sc-gtx-geo-location{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:start;justify-content:flex-start}";var Yl=t("gtx_geo_location",function(){function t(t){e(this,t);this.error=false;this.target="mapa"}t.prototype.componentWillLoad=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i;return __generator(this,(function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,fetch("https://get.geojs.io/v1/ip/geo.json")];case 1:t=n.sent();if(!t.ok){throw new Error}return[4,t.json()];case 2:e=n.sent();this.getLocationDataFromRequested(e);return[3,4];case 3:i=n.sent();this.error=true;return[3,4];case 4:return[2]}}))}))};t.prototype.componentDidLoad=function(){if(!this.error){this.removeMapWrapperChilds();this.map=new wu({controls:[],target:this.target,layers:[new dl({source:new Gl}),new cu({source:this.getSourceForMarker(),style:this.getStyleForMarker()})],view:new Io({center:nn([this.lon,this.lat]),zoom:14})})}};t.prototype.getSourceForMarker=function(){return new Cu({features:[new Xa({geometry:new so(nn([this.lon,this.lat]))})]})};t.prototype.getStyleForMarker=function(){return new Qa({image:new au({anchor:[0,.75],anchorXUnits:"fraction",anchorYUnits:"fraction",src:this.getResourcePath("15304585081556274015-20.png")})})};t.prototype.showError=function(){if(!this.error){return null}return i("div",{class:"geo-location__error-wrapper"},i("div",{class:"geo-location__error-icon"},i("img",{src:this.getResourcePath("14764845711548336260.svg")})),i("div",null,"Se ha producido un error al obtener los datos de localización."))};t.prototype.showLocationInfo=function(){if(this.error){return null}return[i("div",{class:"geo-location__information-wrapper"},i("p",null,"IP: ",this.ip),i("p",null,"Desde: ",this.fromLocation)),i("div",{class:"geo-location__map-wrapper",id:this.target})]};t.prototype.showFooter=function(){return i("div",{class:"geo-location__footer"},"Iconos de ",i("a",{href:"https://freeicons.io/profile/730",target:"_blank"},"Anu Rocks"),", ",i("a",{href:"https://freeicons.io/profile/3",target:"_blank"},"icon king1")," y ",i("a",{href:"https://freeicons.io/profile/714",target:"_blank"},"Raj Dev")," desde ",i("a",{href:"https://freeicons.io",target:"_blank"},"freeicons.io"))};t.prototype.render=function(){return i("div",{class:"geo-location__wrapper"},i("div",{class:"geo-location__title-wrapper"},i("div",{class:"geo-location__icon-wrapper"},i("img",{src:this.getResourcePath("19872325951553771550.svg")})),i("div",{class:"geo-location__title-text"},"Geo Localización")),this.showLocationInfo(),this.showError(),this.showFooter())};t.prototype.getResourcePath=function(t){return n("./assets/"+t)};t.prototype.removeMapWrapperChilds=function(){var t=document.getElementById(this.target);while(t.firstChild){t.removeChild(t.firstChild)}};t.prototype.getLocationDataFromRequested=function(t){this.ip=t.ip;this.lon=+t.longitude;this.lat=+t.latitude;var e=t.city?t.city:"Sin datos";var i=t.region?t.region:"Sin datos";this.fromLocation=e+" ("+i+") - "+t.country};Object.defineProperty(t,"assetsDirs",{get:function(){return["./assets"]},enumerable:false,configurable:true});return t}());Yl.style=jl}}}));